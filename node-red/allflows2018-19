[{"id":"cee0583a.5d0b6","type":"tab","label":"Play#1"},{"id":"cce2ce51.a5c9b","type":"tab","label":"Pay#2","disabled":false,"info":""},{"id":"3e1bffeb.8b3528","type":"tab","label":"Play#3","disabled":false,"info":""},{"id":"4b61f53d.4e7d24","type":"tab","label":"Play#4","disabled":false,"info":""},{"id":"62270d87.6a8a3c","type":"tab","label":"Events","disabled":false,"info":""},{"id":"d92bc279.83ec4","type":"tab","label":"PlaySol#4","disabled":false,"info":""},{"id":"b0b7c84e.ce8c88","type":"tab","label":"AdminDashBaord2","disabled":false,"info":""},{"id":"2ec3ffd6.4082f8","type":"tab","label":"Extra"},{"id":"27e6f3b6.413ff4","type":"tab","label":"02-01 Variables","disabled":false,"info":""},{"id":"7ebfd059.b4fe1","type":"tab","label":"Weather01","disabled":false,"info":""},{"id":"6934ef1.e47ca1","type":"tab","label":"Weather2","disabled":false,"info":""},{"id":"848e1832.066718","type":"tab","label":"WeatherAlt","disabled":false,"info":""},{"id":"5654962e.5c5de","type":"tab","label":"Iss","disabled":false,"info":""},{"id":"3c563f6a.498c58","type":"tab","label":"BlowOutCanldes","disabled":false,"info":""},{"id":"5977a607.3e7eb","type":"tab","label":"IssArea","disabled":false,"info":""},{"id":"9549a969.6b4c68","type":"tab","label":"XMassTree","disabled":false,"info":""},{"id":"fe2e5987.8efef8","type":"tab","label":"Blinky00","disabled":false,"info":""},{"id":"2b716753.e93b38","type":"tab","label":"Blinky01","disabled":false,"info":""},{"id":"a7f9b688.8e0ae8","type":"tab","label":"Blinky02","disabled":false,"info":""},{"id":"40fc550d.ce2a0c","type":"tab","label":"Blinky03","disabled":false,"info":""},{"id":"cbc03fe6.8c474","type":"tab","label":"Blinky04","disabled":false,"info":""},{"id":"8b8e23ad.69ebc","type":"tab","label":"BLe+GPIO","disabled":false,"info":""},{"id":"917b94f0.16e6a8","type":"tab","label":"7SedLED","disabled":false,"info":""},{"id":"1843e116.02acff","type":"tab","label":"Bugalar","disabled":false,"info":""},{"id":"c5708596.6622b8","type":"tab","label":"Counter","disabled":false,"info":""},{"id":"9ed094d3.78c7f","type":"tab","label":"Ramp","disabled":false,"info":""},{"id":"35de9dbd.00d22a","type":"tab","label":"Racing Dashboard","disabled":false,"info":""},{"id":"45875fc0.f9d9d8","type":"tab","label":"IoTPhone","disabled":false,"info":""},{"id":"1cc1a934.f301e7","type":"tab","label":"MCDButton","disabled":false,"info":""},{"id":"7b535247.aa729c","type":"tab","label":"PICamWatson","disabled":false,"info":""},{"id":"22b120e9.55fad","type":"tab","label":"Weather Station","disabled":false,"info":""},{"id":"2dec3743.9f7fd8","type":"tab","label":"LoraWAN decoding","disabled":false,"info":""},{"id":"4ef99cc2.56e3b4","type":"ui_group","z":"","name":"Infos","tab":"eb6b931f.5f76c8","order":1,"disp":true,"width":"8"},{"id":"83027edb.305e9","type":"ui_group","z":"","name":"Blue","tab":"36e021cb.1a2c2e","disp":true,"width":"6"},{"id":"6acbe198.8601b","type":"ui_group","z":"","name":"ColorGauges","tab":"36e021cb.1a2c2e","disp":false,"width":"6"},{"id":"5896db5e.0d3d94","type":"ui_group","z":"","name":"Info","tab":"36e021cb.1a2c2e","disp":true,"width":"6"},{"id":"36e021cb.1a2c2e","type":"ui_tab","z":"","name":"PlayBulb","icon":"dashboard"},{"id":"d04d6e0c.85466","type":"ui_base","theme":{"name":"theme-dark","lightTheme":{"default":"#0094CE","baseColor":"#0094ce","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"Arial,Arial,Helvetica,sans-serif","edited":true,"reset":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#681015","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","reset":false},"themeState":{"base-color":{"default":"#097479","value":"#097479","edited":false},"page-titlebar-backgroundColor":{"value":"#097479","edited":false},"page-backgroundColor":{"value":"#111111","edited":false},"page-sidebar-backgroundColor":{"value":"#000000","edited":false},"group-textColor":{"value":"#0eb8c0","edited":true},"group-borderColor":{"value":"#555555","edited":false},"group-backgroundColor":{"value":"#333333","edited":false},"widget-textColor":{"value":"#eeeeee","edited":false},"widget-backgroundColor":{"value":"#097479","edited":false},"widget-borderColor":{"value":"#333333","edited":false},"base-font":{"value":"Arial,Arial,Helvetica,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"40c7040c.a9b91c","type":"ui_group","z":"","name":"Action","tab":"f36123d.a3ea1e","disp":true,"width":"6"},{"id":"b885a0a0.d7472","type":"ui_group","z":"","name":"Blue","tab":"f36123d.a3ea1e","disp":true,"width":"6"},{"id":"8cbb8a23.fa6eb8","type":"ui_group","z":"","name":"ColorGauges","tab":"f36123d.a3ea1e","disp":false,"width":"6"},{"id":"6fbb24c9.0d885c","type":"ui_group","z":"","name":"Info","tab":"f36123d.a3ea1e","disp":true,"width":"6"},{"id":"f36123d.a3ea1e","type":"ui_tab","z":"","name":"PlayBulb","icon":"dashboard"},{"id":"383fea54.b93626","type":"ui_group","z":"","name":"AllCandles","tab":"f36123d.a3ea1e","disp":true,"width":"6"},{"id":"d5fa8c45.273dc8","type":"ibmiot","z":"","name":"","keepalive":"60","cleansession":true,"appId":"","shared":false},{"id":"22c613b7.59203c","type":"ibmiot","z":"","name":"fromMouseTrap","keepalive":"60","cleansession":true,"appId":"","shared":false},{"id":"6fcd31e5.60f0f8","type":"ui_tab","z":"","name":"PlayBulb","icon":"dashboard"},{"id":"7007ebc2.6f3054","type":"ui_group","z":"","name":"Blue","tab":"6fcd31e5.60f0f8","disp":true,"width":"6"},{"id":"9dfcb174.f30ec8","type":"ui_group","z":"","name":"Red","tab":"6fcd31e5.60f0f8","disp":true,"width":"6"},{"id":"7821f09.5f4e61","type":"ui_group","z":"","name":"Info","tab":"6fcd31e5.60f0f8","disp":true,"width":"6"},{"id":"b3750629.6d5008","type":"ui_group","z":"","name":"Action","tab":"6fcd31e5.60f0f8","disp":true,"width":"6"},{"id":"2afb1ee5.085fa2","type":"ui_group","z":"","name":"Action","tab":"e8a86fce.b0de3","disp":true,"width":"6"},{"id":"508ba1c8.456648","type":"ui_group","z":"","name":"Info","tab":"e8a86fce.b0de3","disp":true,"width":"6"},{"id":"92ceb0f6.1a527","type":"ui_group","z":"","name":"ColorGauges","tab":"e8a86fce.b0de3","disp":false,"width":"6"},{"id":"282dabdd.920ff4","type":"ui_group","z":"","name":"AllCandles","tab":"e8a86fce.b0de3","disp":true,"width":"6"},{"id":"e8a86fce.b0de3","type":"ui_tab","z":"","name":"Admin","icon":"dashboard"},{"id":"8ec91dd6.4b378","type":"ui_group","z":"","name":"Action","tab":"d65b83ae.28d38","disp":true,"width":"6"},{"id":"9df9a21e.38337","type":"ui_group","z":"","name":"Info","tab":"d65b83ae.28d38","disp":true,"width":"6"},{"id":"e3372912.858d08","type":"ui_group","z":"","name":"ColorGauges","tab":"d65b83ae.28d38","disp":false,"width":"6"},{"id":"33b32fcb.b76e78","type":"ui_group","z":"","name":"AllCandles","tab":"d65b83ae.28d38","disp":true,"width":"6"},{"id":"d65b83ae.28d38","type":"ui_tab","z":"","name":"PlayBulb","icon":"dashboard"},{"id":"beb9f71b.54e748","type":"ui_group","z":"","name":"Action","tab":"e8fbf326.60dab","disp":true,"width":"6"},{"id":"9d06616d.48b6","type":"ui_group","z":"","name":"Info","tab":"e8fbf326.60dab","disp":true,"width":"6"},{"id":"691b038e.0f25cc","type":"ui_group","z":"","name":"ColorGauges","tab":"e8fbf326.60dab","disp":false,"width":"6"},{"id":"e8fbf326.60dab","type":"ui_tab","z":"","name":"PlayBulbSolutions","icon":"dashboard"},{"id":"7403572f.6947f","type":"ui_group","z":"","name":"Action","tab":"2e607aa2.ad9e16","disp":true,"width":"6"},{"id":"7b96dd88.919304","type":"ui_group","z":"","name":"Info","tab":"2e607aa2.ad9e16","disp":true,"width":"6"},{"id":"6f7fb2b3.bc0454","type":"ui_group","z":"","name":"ColorGauges","tab":"2e607aa2.ad9e16","disp":false,"width":"6"},{"id":"2e607aa2.ad9e16","type":"ui_tab","z":"","name":"PlayBulbStudent","icon":"dashboard"},{"id":"69fb3eb5.9ba54","type":"ui_group","z":"","name":"Weather","tab":"8ac02e54.4e935","order":1,"disp":true,"width":"6"},{"id":"eb6b931f.5f76c8","type":"ui_tab","z":"","name":"ISSI","icon":"dashboard"},{"id":"7fc35eba.8805d8","type":"ui_group","z":"","name":"ISSI","tab":"eb6b931f.5f76c8","order":2,"disp":true,"width":"17"},{"id":"bfee26b9.e889c","type":"ui_tab","z":"","name":"Home","icon":"dashboard"},{"id":"c547182d.4aa528","type":"ui_tab","z":"","name":"Map","icon":"dashboard"},{"id":"8ac02e54.4e935","type":"ui_tab","z":"","name":"Weather","icon":"dashboard"},{"id":"4c6c3038.24319","type":"ibmiot","z":"","name":"","keepalive":"60","cleansession":true,"appId":"","shared":false},{"id":"1134ac4c.7d089c","type":"ui_group","z":"","name":"Group23","tab":"76bac390.ab04bc","disp":true,"width":"6"},{"id":"52c0a6d5.07b2c8","type":"ui_group","z":"","name":"FromPI","tab":"","disp":true,"width":"6"},{"id":"be62fc1b.d9319","type":"ui_group","z":"","name":"ISSI Infos","tab":"","disp":true,"width":"6"},{"id":"e52c86a9.f9d8c8","type":"ui_group","z":"","name":"IssiArea","tab":"","disp":true,"width":"12"},{"id":"dbbd8eb8.3ed478","type":"ui_group","z":"","name":"ISSI Infos","tab":"","disp":true,"width":"6"},{"id":"ec56780.9988688","type":"ui_group","z":"","name":"FromPI","tab":"","disp":true,"width":"6"},{"id":"2181eb99.ab0e6c","type":"ui_group","z":"","name":"IssiArea","tab":"","disp":true,"width":"12"},{"id":"6c3bb3ee.8c9b2c","type":"ui_group","z":"","name":"ISSI Infos","tab":"","disp":true,"width":"6"},{"id":"1be68020.bb96f8","type":"ui_group","z":"","name":"FromPI","tab":"","disp":true,"width":"6"},{"id":"20ebc68c.325cf2","type":"ui_group","z":"","name":"IssiArea","tab":"","disp":true,"width":"12"},{"id":"42e15bfb.313cac","type":"ui_group","z":"","name":"ISSI Infos","tab":"","disp":true,"width":"6"},{"id":"59d9433e.130dac","type":"ui_group","z":"","name":"FromPI","tab":"","disp":true,"width":"6"},{"id":"1ff3d8f1.46976f","type":"ui_group","z":"","name":"IssiArea","tab":"","disp":true,"width":"12"},{"id":"8385ac65.402438","type":"ui_group","z":"","name":"ISSI Infos","tab":"","disp":true,"width":"6"},{"id":"e108f91f.d0486","type":"ui_group","z":"","name":"FromPI","tab":"","disp":true,"width":"6"},{"id":"d26ced6e.7c9c9","type":"ui_group","z":"","name":"ISS Area","tab":"5c11d200.e9e4e4","order":1,"disp":true,"width":"12"},{"id":"20bfbb42.404ad4","type":"ui_group","z":"","name":"ISS Infos","tab":"5c11d200.e9e4e4","order":2,"disp":true,"width":"6"},{"id":"daf4cba9.67cf","type":"ui_group","z":"","name":"FromPI","tab":"5c11d200.e9e4e4","order":3,"disp":true,"width":"6"},{"id":"5c11d200.e9e4e4","type":"ui_tab","z":"","name":"ISS Area","icon":"dashboard"},{"id":"1950c3f1.0225b4","type":"ui_group","z":"","name":"ISS Area","tab":"79f3e4e5.ebdfdc","order":1,"disp":true,"width":"12"},{"id":"e0f0bae3.d7df98","type":"ui_group","z":"","name":"ISS Infos","tab":"79f3e4e5.ebdfdc","order":2,"disp":true,"width":"6"},{"id":"cf8b9498.08d88","type":"ui_group","z":"","name":"FromPI","tab":"79f3e4e5.ebdfdc","order":3,"disp":true,"width":"6"},{"id":"79f3e4e5.ebdfdc","type":"ui_tab","z":"","name":"ISS Area","icon":"dashboard"},{"id":"6e106082.5c7b98","type":"ibmiot","z":"","name":"","keepalive":"60","cleansession":true,"appId":"","shared":false},{"id":"f9740945.03c29","type":"ibmiot","z":"","name":"","keepalive":"60","cleansession":true,"appId":"","shared":false},{"id":"3dd93ba5.582784","type":"ui_group","z":"","name":"7SegLED","tab":"f29657ba.316b58","disp":true,"width":"6"},{"id":"b740950a.49306","type":"ui_tab","z":"","name":"BurglarAlarm","icon":"dashboard"},{"id":"d96fb8e1.56a3d","type":"ibmiot","z":"","name":"","keepalive":"60","cleansession":true,"appId":"","shared":false},{"id":"f29657ba.316b58","type":"ui_tab","z":"","name":"7-SegLED","icon":"dashboard"},{"id":"12b15121.1d21ff","type":"ui_group","z":"","name":"LEDCounter","tab":"f29657ba.316b58","disp":true,"width":"6"},{"id":"d978be97.f2089","type":"ui_group","z":"","name":"LEDCounter","tab":"b340846a.a37b1","disp":true,"width":"6"},{"id":"b340846a.a37b1","type":"ui_tab","z":"","name":"7-SegLED","icon":"dashboard"},{"id":"9dab94e5.20abf","type":"ui_tab","z":"","name":"Ramp","icon":"dashboard"},{"id":"685c0b62.9dfd04","type":"ui_group","z":"","name":"Ramp","tab":"9dab94e5.20abf","disp":true,"width":"6"},{"id":"76bac390.ab04bc","type":"ui_tab","z":"","name":"Race","icon":"dashboard"},{"id":"98e50627.d5922","type":"ui_group","z":"","name":"Group24","tab":"76bac390.ab04bc","disp":true,"width":"6"},{"id":"10ed93c7.89d70c","type":"ui_group","name":"Group 2","tab":"9dab94e5.20abf","order":2,"disp":true,"width":6},{"id":"c124f11f.5449a8","type":"ibmiot","z":"","name":"","keepalive":"60","cleansession":true,"appId":"","shared":false},{"id":"d693cf3.3482fb","type":"ui_group","name":"Group 2","tab":"ecc6b782.d936f8","order":2,"disp":true,"width":6},{"id":"da747b62.eb4ea8","type":"ui_group","z":"","name":"Ramp","tab":"ecc6b782.d936f8","disp":true,"width":"6"},{"id":"435b5a39.a47004","type":"ibmiot","z":"","name":"","keepalive":"60","cleansession":true,"appId":"","shared":false},{"id":"b88ccd4c.e1477","type":"ibmiot","z":"","name":"ibmnewhire","keepalive":"60","serverName":"","cleansession":true,"appId":"","shared":false},{"id":"5920217a.6f9eb8","type":"ui_group","z":"","name":"IBMNH","tab":"d20a472a.988b6","disp":true,"width":"6"},{"id":"ecc6b782.d936f8","type":"ui_tab","z":"","name":"Ramp","icon":"dashboard"},{"id":"d20a472a.988b6","type":"ui_tab","z":"","name":"IBMNH","icon":"dashboard"},{"id":"8aa622b4.5833a8","type":"ibmiot","z":"","name":"ibmnewhire","keepalive":"60","serverName":"","cleansession":true,"appId":"","shared":false},{"id":"1cbbc1b0.21efde","type":"ibmiot","z":"","name":"","keepalive":"60","cleansession":true,"appId":"","shared":false},{"id":"80c075da.7fb52","type":"ui_group","z":"","name":"Grade10","tab":"9bb2607.ce7982","disp":true,"width":"12"},{"id":"8e01af7a.19911","type":"ui_group","z":"","name":"Group 2","tab":"9bb2607.ce7982","order":2,"disp":false,"width":"13"},{"id":"9bb2607.ce7982","type":"ui_tab","z":"","name":"Grade10","icon":"dashboard"},{"id":"147a8037.1dd968","type":"ibmiot","z":"","name":"","keepalive":"60","cleansession":true,"appId":"","shared":false},{"id":"5379369c.3517d8","type":"ui_group","z":"","name":"Grade10","tab":"34c55035.c025e8","disp":true,"width":"12"},{"id":"dae58bef.fb8508","type":"ui_group","z":"","name":"Group 2","tab":"34c55035.c025e8","order":2,"disp":false,"width":"13"},{"id":"34c55035.c025e8","type":"ui_tab","z":"","name":"Grade10","icon":"dashboard"},{"id":"cadcbaf8.9e7c18","type":"ibmiot","z":"","name":"","keepalive":"60","cleansession":true,"appId":"","shared":false},{"id":"a6165bf1.813048","type":"ui_group","name":"Group 2","tab":"","order":2,"disp":true,"width":6},{"id":"5909026c.2ea14c","type":"ui_group","z":"","name":"Ramp","tab":"","disp":true,"width":"6"},{"id":"880db0ee.9d202","type":"ibmiot","z":"","name":"","keepalive":"60","cleansession":true,"appId":"","shared":false},{"id":"95266688.b052e8","type":"ibmiot","z":"","name":"ibmnewhire","keepalive":"60","serverName":"","cleansession":true,"appId":"","shared":false},{"id":"e6170bf6.938f38","type":"ui_group","z":"","name":"1 LoraWeatherStation","tab":"6ba7382f.4982b8","order":1,"disp":true,"width":"8","collapse":false},{"id":"872bede8.ae467","type":"ui_group","z":"","name":"DHT11","tab":"6ba7382f.4982b8","order":3,"disp":true,"width":"8","collapse":false},{"id":"d92be970.5553b8","type":"ui_group","z":"","name":"DHT11-Current","tab":"6ba7382f.4982b8","order":4,"disp":true,"width":"8","collapse":false},{"id":"a5d67bf8.06ca38","type":"ui_group","z":"","name":"DS18B20","tab":"6ba7382f.4982b8","order":2,"disp":true,"width":"8","collapse":false},{"id":"6ba7382f.4982b8","type":"ui_tab","z":"","name":"LoraWeatherStation","icon":"dashboard","disabled":false,"hidden":false},{"id":"69376f2c.c8a0e8","type":"ibmiot","z":"","name":"FCC Watson IoT","keepalive":"60","serverName":"nnoy6b.messaging.internetofthings.ibmcloud.com","cleansession":true,"appId":"","shared":false},{"id":"8e43c949.e647","type":"mqtt-broker","z":"","name":"","broker":"127.0.0.1","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"7d53723a.cf3f8c","type":"ibmiot in","z":"cee0583a.5d0b6","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb00","applicationId":"","deviceType":"+","eventType":"ping","commandType":"","format":"json","name":"FromPiCandle","service":"registered","allDevices":false,"allApplications":false,"allDeviceTypes":true,"allEvents":true,"allCommands":false,"allFormats":true,"qos":"0","x":157,"y":124.25,"wires":[["ce321792.1164a8","28c7d1a1.f643de"]]},{"id":"ce321792.1164a8","type":"debug","z":"cee0583a.5d0b6","name":"","active":false,"console":"false","complete":"false","x":178.5,"y":214.75,"wires":[]},{"id":"b0b7dff5.512578","type":"comment","z":"cee0583a.5d0b6","name":"GetDataFromPiCandle","info":"","x":180,"y":40,"wires":[]},{"id":"146c4009.51e6d","type":"ibmiot out","z":"3e1bffeb.8b3528","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb14","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"toPiCandle","service":"registered","x":730,"y":300,"wires":[]},{"id":"80a10ff3.d48778","type":"inject","z":"3e1bffeb.8b3528","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":140,"y":500,"wires":[["6b08e410.775124"]]},{"id":"6b08e410.775124","type":"function","z":"3e1bffeb.8b3528","name":"SetColorRed","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":355,"y":504.4999694824219,"wires":[["146c4009.51e6d","e35f7924.29b818"]]},{"id":"e35f7924.29b818","type":"debug","z":"3e1bffeb.8b3528","name":"","active":true,"console":"false","complete":"false","x":630,"y":500,"wires":[]},{"id":"320abb06.b361d4","type":"function","z":"3e1bffeb.8b3528","name":"setModeCandleLight","func":"var newmsg = {\"cmd\" : \"setcolor\",\n// mode =01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":\"1\",\n\"speed1\":0,\n\"speed2\":255,\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":200,"wires":[["146c4009.51e6d"]]},{"id":"dc23604a.76dd38","type":"inject","z":"3e1bffeb.8b3528","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":140,"y":300,"wires":[["3bb88973.ae3e26"]]},{"id":"31a7bbe7.efa7a4","type":"function","z":"3e1bffeb.8b3528","name":"setCandleMode=FADEDGB=03","func":"var newmsg = {\"cmd\" : \"setcolor\",\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":1,\n\"speed1\":48,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":390,"y":240,"wires":[["146c4009.51e6d"]]},{"id":"319314fa.a662cc","type":"comment","z":"3e1bffeb.8b3528","name":"Candle Modes","info":"01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect","x":140,"y":151,"wires":[]},{"id":"ebe18829.4ca5b","type":"comment","z":"3e1bffeb.8b3528","name":"SetCandleColors","info":"01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect","x":140,"y":440,"wires":[]},{"id":"3bb88973.ae3e26","type":"function","z":"3e1bffeb.8b3528","name":"setCandleMode=Jump=02","func":"var newmsg = {\"cmd\" : \"setcolor\",\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":2,\n\"speed1\":9,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":390,"y":301,"wires":[["146c4009.51e6d"]]},{"id":"322bcf3e.ac3ec","type":"inject","z":"3e1bffeb.8b3528","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":140,"y":200,"wires":[["320abb06.b361d4"]]},{"id":"cec18e13.d89c58","type":"inject","z":"3e1bffeb.8b3528","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":140,"y":240,"wires":[["31a7bbe7.efa7a4"]]},{"id":"3b09d250.474dae","type":"function","z":"3e1bffeb.8b3528","name":"setCandleMode=Flashing","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":19,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":368,"y":349,"wires":[["146c4009.51e6d"]]},{"id":"b51b75c8.60fa38","type":"inject","z":"3e1bffeb.8b3528","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":138,"y":347,"wires":[["3b09d250.474dae"]]},{"id":"e27f162c.4962","type":"function","z":"3e1bffeb.8b3528","name":"setCandleMode=Rainbow","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00ff00ff 02 00 5f00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":02,\n\"speed1\":95,\n\"speed2\":0,\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":358,"y":400,"wires":[["146c4009.51e6d"]]},{"id":"ecf0818.d5f01","type":"inject","z":"3e1bffeb.8b3528","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":140,"y":400,"wires":[["e27f162c.4962"]]},{"id":"141097b9.5e6ca8","type":"function","z":"3e1bffeb.8b3528","name":"SetColorGreen","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":340,"y":560,"wires":[["146c4009.51e6d"]]},{"id":"10f729ca.c47fde","type":"inject","z":"3e1bffeb.8b3528","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":140,"y":560,"wires":[["141097b9.5e6ca8"]]},{"id":"1dcdaaf2.ade24d","type":"debug","z":"cee0583a.5d0b6","name":"","active":false,"console":"false","complete":"false","x":627,"y":121,"wires":[]},{"id":"28c7d1a1.f643de","type":"function","z":"cee0583a.5d0b6","name":"","func":"if (msg.payload.candleGG == 255)\nvar newmsg = {};\nmsg.payload = \"Green\"\nreturn msg;","outputs":1,"noerr":0,"x":390,"y":120,"wires":[["1dcdaaf2.ade24d"]]},{"id":"824ccec7.698ae8","type":"ibmiot in","z":"cce2ce51.a5c9b","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb00","applicationId":"","deviceType":"+","eventType":"ping","commandType":"","format":"json","name":"FromPiCandle","service":"registered","allDevices":false,"allApplications":false,"allDeviceTypes":true,"allEvents":true,"allCommands":false,"allFormats":true,"qos":"0","x":130,"y":120,"wires":[["87fb3961.84c6e"]]},{"id":"87fb3961.84c6e","type":"debug","z":"cce2ce51.a5c9b","name":"","active":true,"console":"false","complete":"false","x":370,"y":120,"wires":[]},{"id":"718f2076.193e9","type":"ibmiot out","z":"cce2ce51.a5c9b","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb14","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"toPiCandle","service":"registered","x":604.27783203125,"y":347.3889465332031,"wires":[]},{"id":"13f66c30.c07f24","type":"inject","z":"cce2ce51.a5c9b","name":"SetToRed","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":140,"y":260,"wires":[["dd2a7b60.8a9cb"]]},{"id":"dd2a7b60.8a9cb","type":"function","z":"cce2ce51.a5c9b","name":"SetColorRed","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":260,"wires":[["718f2076.193e9","74aacffa.19cde8"]]},{"id":"74aacffa.19cde8","type":"debug","z":"cce2ce51.a5c9b","name":"","active":true,"console":"false","complete":"false","x":602.77783203125,"y":255.88894653320312,"wires":[]},{"id":"c4a6cde2.c2b94","type":"comment","z":"cce2ce51.a5c9b","name":"GetDataFromPiCandle","info":"","x":160,"y":40,"wires":[]},{"id":"4c1fe9db.005f","type":"comment","z":"cce2ce51.a5c9b","name":"SetCandleColors","info":"01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect","x":140,"y":220,"wires":[]},{"id":"7915446f.b24c6c","type":"inject","z":"cce2ce51.a5c9b","name":"SetGreen","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":140,"y":320,"wires":[["fee15315.840d38"]]},{"id":"4dc48326.a50494","type":"function","z":"cce2ce51.a5c9b","name":"SetColorBlue","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":348.72216796875,"y":383.6110534667969,"wires":[["718f2076.193e9","74aacffa.19cde8"]]},{"id":"fee15315.840d38","type":"function","z":"cce2ce51.a5c9b","name":"SetColorGreen","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":320,"wires":[["74aacffa.19cde8","718f2076.193e9"]]},{"id":"1d9991c1.2cd936","type":"inject","z":"cce2ce51.a5c9b","name":"SetBlue","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":130,"y":380,"wires":[["4dc48326.a50494"]]},{"id":"c81776c9.f786f","type":"function","z":"cce2ce51.a5c9b","name":"TurnOff","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":340,"y":440,"wires":[["718f2076.193e9","74aacffa.19cde8"]]},{"id":"4b33afec.417938","type":"inject","z":"cce2ce51.a5c9b","name":"TurnOff","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":130,"y":440,"wires":[["c81776c9.f786f"]]},{"id":"a8f3ee1e.bdacb8","type":"function","z":"cce2ce51.a5c9b","name":"TurnOn","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 255,\n\"bb\" : 255\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":340,"y":520,"wires":[["74aacffa.19cde8","718f2076.193e9"]]},{"id":"6926ae60.271898","type":"inject","z":"cce2ce51.a5c9b","name":"TurnOff","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":130,"y":520,"wires":[["a8f3ee1e.bdacb8"]]},{"id":"c44009fc.b0644","type":"function","z":"cce2ce51.a5c9b","name":"SetColorOrange","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 140,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":580,"wires":[["718f2076.193e9"]]},{"id":"2cd9b66c.f05162","type":"inject","z":"cce2ce51.a5c9b","name":"SetBlue","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":130,"y":580,"wires":[["c44009fc.b0644"]]},{"id":"6a0219bd.82bf2","type":"ibmiot in","z":"3e1bffeb.8b3528","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb00","applicationId":"","deviceType":"+","eventType":"ping","commandType":"","format":"json","name":"FromPiCandle","service":"registered","allDevices":false,"allApplications":false,"allDeviceTypes":true,"allEvents":false,"allCommands":false,"allFormats":true,"qos":"0","x":130,"y":100,"wires":[["e85784f1.bdc498"]]},{"id":"e85784f1.bdc498","type":"debug","z":"3e1bffeb.8b3528","name":"","active":false,"console":"false","complete":"false","x":370,"y":100,"wires":[]},{"id":"924a4233.532b5","type":"comment","z":"3e1bffeb.8b3528","name":"GetDataFromPiCandle","info":"","x":160,"y":20,"wires":[]},{"id":"22038151.d87146","type":"switch","z":"2ec3ffd6.4082f8","name":"Mode","property":"payload.mode","propertyType":"msg","rules":[{"t":"eq","v":"00000000ff000a0a","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":610,"y":160,"wires":[["2c914f99.23a94","95231d4f.2b6468","5d95b159.73b22","270fddba.5a5b42"],["a893d223.e48c18","e1e42cc7.433eb"]]},{"id":"a893d223.e48c18","type":"function","z":"2ec3ffd6.4082f8","name":"DifferentMode","func":"return {payload:0};","outputs":1,"noerr":0,"x":800,"y":220,"wires":[[]]},{"id":"2c914f99.23a94","type":"function","z":"2ec3ffd6.4082f8","name":"candleRR","func":"return {payload:msg.payload.candleRR};","outputs":1,"noerr":0,"x":780,"y":80,"wires":[[]]},{"id":"95231d4f.2b6468","type":"function","z":"2ec3ffd6.4082f8","name":"candleGG","func":"return {payload:msg.payload.candleGG};","outputs":1,"noerr":0,"x":785.7222595214844,"y":122.1944580078125,"wires":[[]]},{"id":"5d95b159.73b22","type":"function","z":"2ec3ffd6.4082f8","name":"candleBB","func":"return {payload:msg.payload.candleBB};","outputs":1,"noerr":0,"x":785.7223205566406,"y":162.19442749023438,"wires":[[]]},{"id":"e1e42cc7.433eb","type":"debug","z":"2ec3ffd6.4082f8","name":"ModeCheck","active":false,"console":"false","complete":"payload","x":790,"y":280,"wires":[]},{"id":"8e374d70.5bd87","type":"switch","z":"2ec3ffd6.4082f8","name":"ModeText","property":"payload.mode","propertyType":"msg","rules":[{"t":"eq","v":"00000000ff000a0a","vt":"str"},{"t":"eq","v":"0000ff3903000101","vt":"str"},{"t":"eq","v":"00ffff0004000100","vt":"str"},{"t":"else"}],"checkall":"true","outputs":4,"x":140,"y":400,"wires":[[],[],["4fc7e3b0.f102a4"],["ccee3d47.4a4fa"]]},{"id":"270fddba.5a5b42","type":"function","z":"2ec3ffd6.4082f8","name":"ColorMode","func":"return {payload:\"Color\"};","outputs":1,"noerr":0,"x":790,"y":340,"wires":[[]]},{"id":"4fc7e3b0.f102a4","type":"function","z":"2ec3ffd6.4082f8","name":"CandleMode","func":"return {payload:\"Candle\"};","outputs":1,"noerr":0,"x":390,"y":460,"wires":[[]]},{"id":"ccee3d47.4a4fa","type":"function","z":"2ec3ffd6.4082f8","name":"CandleModeUnknown","func":"return {payload:\"Unknown\"};","outputs":1,"noerr":0,"x":420,"y":500,"wires":[[]]},{"id":"2327058c.5a683a","type":"ibmiot in","z":"2ec3ffd6.4082f8","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb00","applicationId":"","deviceType":"+","eventType":"ping","commandType":"","format":"json","name":"FromPiCandle","service":"registered","allDevices":false,"allApplications":false,"allDeviceTypes":true,"allEvents":false,"allCommands":false,"allFormats":true,"qos":"0","x":110,"y":120,"wires":[["193f71e7.32a28e"]]},{"id":"193f71e7.32a28e","type":"debug","z":"2ec3ffd6.4082f8","name":"","active":false,"console":"false","complete":"false","x":350,"y":120,"wires":[]},{"id":"eb11c8c0.3e13d8","type":"comment","z":"2ec3ffd6.4082f8","name":"GetDataFromPiCandle","info":"","x":144.5,"y":65.75,"wires":[]},{"id":"d2392890.110e9","type":"ibmiot in","z":"b0b7c84e.ce8c88","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb04","applicationId":"","deviceType":"+","eventType":"ping","commandType":"","format":"json","name":"FromPiCandle","service":"registered","allDevices":true,"allApplications":false,"allDeviceTypes":true,"allEvents":true,"allCommands":false,"allFormats":true,"qos":"0","x":150,"y":100,"wires":[["767079a.c1f2088","332e1fc3.aeba68","149e439c.f4ea0c","b11c792.aaeef08","f7562a05.e429d8","cc37d966.2fc3c","d85405a8.ef22c8","47c59031.388e28","fd6462db.513aa","460432bb.6f3944"]]},{"id":"767079a.c1f2088","type":"debug","z":"b0b7c84e.ce8c88","name":"","active":false,"console":"false","complete":"false","x":137.5,"y":158.5,"wires":[]},{"id":"fcac5a2e.ce9298","type":"comment","z":"b0b7c84e.ce8c88","name":"GetDataFromPi","info":"","x":144.5,"y":45.75,"wires":[]},{"id":"44f332bd.2d95ec","type":"ui_button","z":"b0b7c84e.ce8c88","name":"","group":"2afb1ee5.085fa2","order":0,"width":0,"height":0,"passthru":false,"label":"Set Candle to Red","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":650,"y":420,"wires":[["534ff153.54fab8"]]},{"id":"332e1fc3.aeba68","type":"ui_text","z":"b0b7c84e.ce8c88","group":"508ba1c8.456648","order":1,"width":0,"height":0,"name":"","label":"Name","format":"{{msg.payload.candleName}}","layout":"row-spread","x":608,"y":336,"wires":[]},{"id":"534ff153.54fab8","type":"function","z":"b0b7c84e.ce8c88","name":"SetColorRed","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":852.5,"y":411.25,"wires":[["c1eac58d.fd7868","15012939.31a07f","10b0a8ba.e539d7","5e21ceac.a2b3","b2a80564.037b98"]]},{"id":"c1eac58d.fd7868","type":"ibmiot out","z":"b0b7c84e.ce8c88","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb02","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"ToPiCandle","service":"registered","x":1092.5,"y":491.25,"wires":[]},{"id":"47c59031.388e28","type":"ui_text","z":"b0b7c84e.ce8c88","group":"508ba1c8.456648","order":2,"width":0,"height":0,"name":"","label":"Counter","format":"{{msg.payload.value}}","layout":"row-spread","x":615.5,"y":375,"wires":[]},{"id":"b403a0b8.37b908","type":"ui_gauge","z":"b0b7c84e.ce8c88","name":"","group":"508ba1c8.456648","order":5,"width":0,"height":0,"gtype":"gage","title":"BatteryLevel","label":"units","format":"{{value}}","min":0,"max":"100","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":852.5,"y":711.25,"wires":[]},{"id":"149e439c.f4ea0c","type":"function","z":"b0b7c84e.ce8c88","name":"BatteryLevel","func":"\nmsg.payload=msg.payload.batLevel ;\nreturn msg;","outputs":1,"noerr":0,"x":632.5,"y":711.25,"wires":[["b403a0b8.37b908"]]},{"id":"b11c792.aaeef08","type":"ui_text","z":"b0b7c84e.ce8c88","group":"508ba1c8.456648","order":4,"width":0,"height":0,"name":"","label":"BatLevel","format":"{{msg.payload.batLevel}}","layout":"row-spread","x":580,"y":40,"wires":[]},{"id":"22b2f392.f258c4","type":"ui_button","z":"b0b7c84e.ce8c88","name":"","group":"2afb1ee5.085fa2","order":0,"width":0,"height":0,"passthru":false,"label":"Set Candle to Green","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":662.5,"y":471.25,"wires":[["72919ff.b73f96"]]},{"id":"11229638.3dd1ea","type":"ui_text","z":"b0b7c84e.ce8c88","group":"508ba1c8.456648","order":3,"width":0,"height":0,"name":"","label":"IpAddress","format":"{{msg.payload.ipAddr}}","layout":"row-spread","x":632.5,"y":291.25,"wires":[]},{"id":"72919ff.b73f96","type":"function","z":"b0b7c84e.ce8c88","name":"SetColorGreen","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":885.5,"y":471.25,"wires":[["c1eac58d.fd7868","15012939.31a07f","10b0a8ba.e539d7","5e21ceac.a2b3","b2a80564.037b98"]]},{"id":"d191fe8b.cce9c8","type":"ui_button","z":"b0b7c84e.ce8c88","name":"","group":"2afb1ee5.085fa2","order":0,"width":0,"height":0,"passthru":false,"label":"Set Candle to Blue","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":652.5,"y":511.25,"wires":[["cc27db23.c065f"]]},{"id":"cc27db23.c065f","type":"function","z":"b0b7c84e.ce8c88","name":"SetColorBlue","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":857.5,"y":517.25,"wires":[["c1eac58d.fd7868","15012939.31a07f","10b0a8ba.e539d7","5e21ceac.a2b3","b2a80564.037b98"]]},{"id":"400ff360.3d5224","type":"ui_button","z":"b0b7c84e.ce8c88","name":"","group":"2afb1ee5.085fa2","order":0,"width":0,"height":0,"passthru":false,"label":"Turn Off Candle","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":642.5,"y":571.25,"wires":[["e53301ff.1483b"]]},{"id":"e53301ff.1483b","type":"function","z":"b0b7c84e.ce8c88","name":"SetColorNone","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":882.5,"y":571.25,"wires":[["c1eac58d.fd7868"]]},{"id":"36ffe0d9.b27ca8","type":"ui_button","z":"b0b7c84e.ce8c88","name":"","group":"2afb1ee5.085fa2","order":0,"width":0,"height":0,"passthru":false,"label":"SetCandletoblueFlash","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":662.5,"y":631.25,"wires":[["52461c54.0c850c"]]},{"id":"52461c54.0c850c","type":"function","z":"b0b7c84e.ce8c88","name":"setCandleMode=FadeBlueFast","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":01,\n\"speed1\":01,\n\"speed2\":00,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255,\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":952.5,"y":631.25,"wires":[["c1eac58d.fd7868"]]},{"id":"8f527538.85b76","type":"function","z":"b0b7c84e.ce8c88","name":"DifferentMode","func":"return {payload:0};","outputs":1,"noerr":0,"x":820,"y":220,"wires":[["c9b1c5d4.3abb48","2ad8fb71.98abec","49fd08d8.af3c88"]]},{"id":"f7562a05.e429d8","type":"function","z":"b0b7c84e.ce8c88","name":"candleRR","func":"return {payload:msg.payload.candleRR};","outputs":1,"noerr":0,"x":800,"y":60,"wires":[["2ad8fb71.98abec"]]},{"id":"cc37d966.2fc3c","type":"function","z":"b0b7c84e.ce8c88","name":"candleGG","func":"return {payload:msg.payload.candleGG};","outputs":1,"noerr":0,"x":805.7222595214844,"y":102.1944580078125,"wires":[["49fd08d8.af3c88"]]},{"id":"d85405a8.ef22c8","type":"function","z":"b0b7c84e.ce8c88","name":"candleBB","func":"return {payload:msg.payload.candleBB};","outputs":1,"noerr":0,"x":805.7223205566406,"y":142.19442749023438,"wires":[["c9b1c5d4.3abb48"]]},{"id":"c9b1c5d4.3abb48","type":"ui_gauge","z":"b0b7c84e.ce8c88","name":"","group":"92ceb0f6.1a527","order":0,"width":0,"height":0,"gtype":"gage","title":"Blue","label":"units","format":"{{value}}","min":0,"max":"255","colors":["#7e959a","#6f7dc9","#530dbb"],"seg1":"","seg2":"","x":972.5,"y":155.75,"wires":[]},{"id":"2ad8fb71.98abec","type":"ui_gauge","z":"b0b7c84e.ce8c88","name":"","group":"92ceb0f6.1a527","order":0,"width":0,"height":0,"gtype":"gage","title":"Red","label":"units","format":"{{value}}","min":0,"max":"255","colors":["#7e959a","#bcb489","#ac0c19"],"seg1":"","seg2":"","x":970,"y":60,"wires":[]},{"id":"49fd08d8.af3c88","type":"ui_gauge","z":"b0b7c84e.ce8c88","name":"","group":"92ceb0f6.1a527","order":0,"width":0,"height":0,"gtype":"gage","title":"Green","label":"units","format":"{{value}}","min":0,"max":"255","colors":["#7e959a","#73bc78","#21ac1b"],"seg1":"","seg2":"","x":972.5,"y":95.75,"wires":[]},{"id":"f795e104.220f","type":"ui_colour_picker","z":"b0b7c84e.ce8c88","name":"","label":"SetCandle to","group":"508ba1c8.456648","format":"rgb","outformat":"object","showSwatch":true,"showPicker":false,"showValue":false,"showAlpha":false,"showLightness":true,"order":0,"width":"6","height":"1","passthru":true,"topic":"","x":652.5,"y":811.25,"wires":[["5e54882d.d5679","ac09eeac.2109d"]]},{"id":"5e54882d.d5679","type":"debug","z":"b0b7c84e.ce8c88","name":"","active":true,"console":"false","complete":"false","x":692.5,"y":891.25,"wires":[]},{"id":"e28f3756.a71e7","type":"ui_text","z":"b0b7c84e.ce8c88","group":"508ba1c8.456648","order":2,"width":0,"height":0,"name":"","label":"Mode","format":"{{msg.payload}}","layout":"row-spread","x":1192.5,"y":391.25,"wires":[]},{"id":"ac09eeac.2109d","type":"function","z":"b0b7c84e.ce8c88","name":"SetColorBlue","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : msg.payload.r,\n\"gg\" : msg.payload.g,\n\"bb\" :  msg.payload.b\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":852.5,"y":811.25,"wires":[["c1eac58d.fd7868"]]},{"id":"15012939.31a07f","type":"ibmiot out","z":"b0b7c84e.ce8c88","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb01","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"playbulb01","service":"registered","x":1092.5,"y":451.25,"wires":[]},{"id":"10b0a8ba.e539d7","type":"ibmiot out","z":"b0b7c84e.ce8c88","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb04","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"playbulb04","service":"registered","x":832.5,"y":291.25,"wires":[]},{"id":"5e21ceac.a2b3","type":"ibmiot out","z":"b0b7c84e.ce8c88","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb05","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"playbulb05","service":"registered","x":1052.5,"y":351.25,"wires":[]},{"id":"b2a80564.037b98","type":"ibmiot out","z":"b0b7c84e.ce8c88","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb03","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"playbulb03","service":"registered","x":1072.5,"y":311.25,"wires":[]},{"id":"fd6462db.513aa","type":"switch","z":"b0b7c84e.ce8c88","name":"","property":"payload.candleName","propertyType":"msg","rules":[{"t":"eq","v":"playbulb01","vt":"str"},{"t":"eq","v":"playbulb02","vt":"str"},{"t":"eq","v":"playbulb03","vt":"str"},{"t":"eq","v":"playbulb04","vt":"str"},{"t":"eq","v":"playbulb05","vt":"str"}],"checkall":"true","outputs":5,"x":90,"y":260,"wires":[["2c03e7a8.ad4c","7d69d046.d9cae"],["4cf7089e.fcfcd","ce422542.2de768"],["7e2fdd85.83d524","fc13cf56.66c88"],["f280b2b6.57da48","aba5dd4d.f704c"],["eef85c6c.caac2","c063b081.ab6ba8"]]},{"id":"7d69d046.d9cae","type":"ui_text","z":"b0b7c84e.ce8c88","group":"282dabdd.920ff4","order":2,"width":0,"height":0,"name":"","label":"PB01Counter","format":"{{msg.payload.value}}","layout":"row-spread","x":280,"y":260,"wires":[]},{"id":"2c03e7a8.ad4c","type":"ui_text","z":"b0b7c84e.ce8c88","group":"282dabdd.920ff4","order":1,"width":0,"height":0,"name":"","label":"Name","format":"{{msg.payload.candleName}}","layout":"row-spread","x":250,"y":220,"wires":[]},{"id":"ce422542.2de768","type":"ui_text","z":"b0b7c84e.ce8c88","group":"282dabdd.920ff4","order":4,"width":0,"height":0,"name":"","label":"PB02Counter","format":"{{msg.payload.value}}","layout":"row-spread","x":260,"y":400,"wires":[]},{"id":"4cf7089e.fcfcd","type":"ui_text","z":"b0b7c84e.ce8c88","group":"282dabdd.920ff4","order":3,"width":0,"height":0,"name":"","label":"Name","format":"{{msg.payload.candleName}}","layout":"row-spread","x":230,"y":360,"wires":[]},{"id":"fc13cf56.66c88","type":"ui_text","z":"b0b7c84e.ce8c88","group":"282dabdd.920ff4","order":6,"width":0,"height":0,"name":"","label":"PB03Counter","format":"{{msg.payload.value}}","layout":"row-spread","x":280,"y":500,"wires":[]},{"id":"7e2fdd85.83d524","type":"ui_text","z":"b0b7c84e.ce8c88","group":"282dabdd.920ff4","order":5,"width":0,"height":0,"name":"","label":"Name","format":"{{msg.payload.candleName}}","layout":"row-spread","x":250,"y":460,"wires":[]},{"id":"aba5dd4d.f704c","type":"ui_text","z":"b0b7c84e.ce8c88","group":"282dabdd.920ff4","order":8,"width":0,"height":0,"name":"","label":"PB04Counter","format":"{{msg.payload.value}}","layout":"row-spread","x":280,"y":600,"wires":[]},{"id":"f280b2b6.57da48","type":"ui_text","z":"b0b7c84e.ce8c88","group":"282dabdd.920ff4","order":7,"width":0,"height":0,"name":"","label":"Name","format":"{{msg.payload.candleName}}","layout":"row-spread","x":250,"y":560,"wires":[]},{"id":"c063b081.ab6ba8","type":"ui_text","z":"b0b7c84e.ce8c88","group":"282dabdd.920ff4","order":10,"width":0,"height":0,"name":"","label":"PB05Counter","format":"{{msg.payload.value}}","layout":"row-spread","x":260,"y":700,"wires":[]},{"id":"eef85c6c.caac2","type":"ui_text","z":"b0b7c84e.ce8c88","group":"282dabdd.920ff4","order":9,"width":0,"height":0,"name":"","label":"Name","format":"{{msg.payload.candleName}}","layout":"row-spread","x":230,"y":660,"wires":[]},{"id":"ef48551f.dcbd5","type":"ui_text","z":"b0b7c84e.ce8c88","group":"282dabdd.920ff4","order":10,"width":0,"height":0,"name":"","label":"PB05Counter","format":"{{msg.payload.value}}","layout":"row-spread","x":260,"y":740,"wires":[]},{"id":"c7591b33.b9b0d","type":"debug","z":"b0b7c84e.ce8c88","name":"","active":true,"console":"false","complete":"payload.candleName","x":690,"y":180,"wires":[]},{"id":"460432bb.6f3944","type":"switch","z":"b0b7c84e.ce8c88","name":"","property":"payload.ipAddr","propertyType":"msg","rules":[{"t":"eq","v":"undefined","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":495.625,"y":170,"wires":[["c7591b33.b9b0d","11229638.3dd1ea"],["11229638.3dd1ea"]]},{"id":"cbc3efa6.c0d1f8","type":"ibmiot in","z":"d92bc279.83ec4","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb00","applicationId":"","deviceType":"+","eventType":"ping","commandType":"","format":"json","name":"FromPiCandle","service":"registered","allDevices":true,"allApplications":false,"allDeviceTypes":true,"allEvents":true,"allCommands":false,"allFormats":true,"qos":"0","x":130,"y":120,"wires":[["4f5819ca.b4724","d025969e.8a0838","959430d2.25c12","e6d79c82.be473","b47e9043.08ca98","8cc744b6.24ccd","f4202deb.a58b","8974de75.a75de"]]},{"id":"4f5819ca.b4724","type":"debug","z":"d92bc279.83ec4","name":"","active":false,"console":"false","complete":"false","x":330,"y":60,"wires":[]},{"id":"18805283.bf1dd5","type":"comment","z":"d92bc279.83ec4","name":"GetDataFromPi","info":"","x":140,"y":60,"wires":[]},{"id":"b3cca77e.89f8d8","type":"ui_button","z":"d92bc279.83ec4","name":"","group":"beb9f71b.54e748","order":0,"width":0,"height":0,"passthru":false,"label":"Set Candle to Red","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":170,"y":360,"wires":[["db5442c3.83b538"]]},{"id":"d025969e.8a0838","type":"ui_text","z":"d92bc279.83ec4","group":"9d06616d.48b6","order":1,"width":0,"height":0,"name":"","label":"Name","format":"{{msg.payload.candleName}}","layout":"row-spread","x":310,"y":260,"wires":[]},{"id":"db5442c3.83b538","type":"function","z":"d92bc279.83ec4","name":"SetColorRed","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":410,"y":360,"wires":[["3c5f7439.3125a4"]]},{"id":"3c5f7439.3125a4","type":"ibmiot out","z":"d92bc279.83ec4","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb00","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"ToPiCandle","service":"registered","x":690,"y":420,"wires":[]},{"id":"f4202deb.a58b","type":"ui_text","z":"d92bc279.83ec4","group":"9d06616d.48b6","order":2,"width":0,"height":0,"name":"","label":"Counter","format":"{{msg.payload.value}}","layout":"row-spread","x":320,"y":300,"wires":[]},{"id":"959430d2.25c12","type":"ui_text","z":"d92bc279.83ec4","group":"9d06616d.48b6","order":4,"width":0,"height":0,"name":"","label":"BatLevel","format":"{{msg.payload.batLevel}}","layout":"row-spread","x":320,"y":180,"wires":[]},{"id":"96d07925.842d4","type":"ui_button","z":"d92bc279.83ec4","name":"","group":"beb9f71b.54e748","order":0,"width":0,"height":0,"passthru":false,"label":"Set Candle to Green","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":160,"y":400,"wires":[["3ea553e7.7a0c0c"]]},{"id":"8974de75.a75de","type":"ui_text","z":"d92bc279.83ec4","group":"9d06616d.48b6","order":3,"width":0,"height":0,"name":"","label":"IpAddress","format":"{{msg.payload.ipAddr}}","layout":"row-spread","x":330,"y":220,"wires":[]},{"id":"3ea553e7.7a0c0c","type":"function","z":"d92bc279.83ec4","name":"SetColorGreen","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":420,"y":400,"wires":[["3c5f7439.3125a4"]]},{"id":"fbb54823.f8f858","type":"ui_button","z":"d92bc279.83ec4","name":"","group":"beb9f71b.54e748","order":0,"width":0,"height":0,"passthru":false,"label":"Set Candle to Blue","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":170,"y":440,"wires":[["d34638a1.575b58"]]},{"id":"d34638a1.575b58","type":"function","z":"d92bc279.83ec4","name":"SetColorBlue","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":410,"y":440,"wires":[["3c5f7439.3125a4"]]},{"id":"20a0bcc7.363944","type":"ui_button","z":"d92bc279.83ec4","name":"","group":"beb9f71b.54e748","order":0,"width":0,"height":0,"passthru":false,"label":"Turn Off Candle","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":162.5,"y":511.25,"wires":[["c0e214f2.7b8ad"]]},{"id":"c0e214f2.7b8ad","type":"function","z":"d92bc279.83ec4","name":"SetColorNone","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":402.5,"y":511.25,"wires":[["3c5f7439.3125a4"]]},{"id":"3ffafe87.d7edb2","type":"ui_button","z":"d92bc279.83ec4","name":"","group":"beb9f71b.54e748","order":0,"width":0,"height":0,"passthru":false,"label":"SetCandletoblueFlash","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":160,"y":560,"wires":[["59dd9b7.adb1ae4"]]},{"id":"59dd9b7.adb1ae4","type":"function","z":"d92bc279.83ec4","name":"setCandleMode=FadeBlueFast","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":01,\n\"speed1\":01,\n\"speed2\":00,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255,\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":450,"y":560,"wires":[["3c5f7439.3125a4"]]},{"id":"934b10c1.faa97","type":"function","z":"d92bc279.83ec4","name":"DifferentMode","func":"return {payload:0};","outputs":1,"noerr":0,"x":600,"y":220,"wires":[["b8d47882.6b433","e3779223.6d9c28","69795463.e0e3f4"]]},{"id":"e6d79c82.be473","type":"function","z":"d92bc279.83ec4","name":"candleRR","func":"return {payload:msg.payload.candleRR};","outputs":1,"noerr":0,"x":620,"y":80,"wires":[["e3779223.6d9c28"]]},{"id":"b47e9043.08ca98","type":"function","z":"d92bc279.83ec4","name":"candleGG","func":"return {payload:msg.payload.candleGG};","outputs":1,"noerr":0,"x":625.7222595214844,"y":122.1944580078125,"wires":[["69795463.e0e3f4"]]},{"id":"8cc744b6.24ccd","type":"function","z":"d92bc279.83ec4","name":"candleBB","func":"return {payload:msg.payload.candleBB};","outputs":1,"noerr":0,"x":625.7223205566406,"y":162.19442749023438,"wires":[["b8d47882.6b433"]]},{"id":"b8d47882.6b433","type":"ui_gauge","z":"d92bc279.83ec4","name":"","group":"691b038e.0f25cc","order":0,"width":0,"height":0,"gtype":"gage","title":"Blue","label":"units","format":"{{value}}","min":0,"max":"255","colors":["#7e959a","#6f7dc9","#530dbb"],"seg1":"","seg2":"","x":792.5,"y":175.75,"wires":[]},{"id":"e3779223.6d9c28","type":"ui_gauge","z":"d92bc279.83ec4","name":"","group":"691b038e.0f25cc","order":0,"width":0,"height":0,"gtype":"gage","title":"Red","label":"units","format":"{{value}}","min":0,"max":"255","colors":["#7e959a","#bcb489","#ac0c19"],"seg1":"","seg2":"","x":790,"y":80,"wires":[]},{"id":"69795463.e0e3f4","type":"ui_gauge","z":"d92bc279.83ec4","name":"","group":"691b038e.0f25cc","order":0,"width":0,"height":0,"gtype":"gage","title":"Green","label":"units","format":"{{value}}","min":0,"max":"255","colors":["#7e959a","#73bc78","#21ac1b"],"seg1":"","seg2":"","x":792.5,"y":115.75,"wires":[]},{"id":"75ba5bac.f3da14","type":"ui_colour_picker","z":"d92bc279.83ec4","name":"","label":"SetCandle to","group":"9d06616d.48b6","format":"rgb","outformat":"object","showSwatch":true,"showPicker":false,"showValue":false,"showAlpha":false,"showLightness":true,"order":0,"width":"6","height":"1","passthru":true,"topic":"","x":150,"y":640,"wires":[["f8b4cf6f.221d88","facf2115.0d5d8"]]},{"id":"f8b4cf6f.221d88","type":"debug","z":"d92bc279.83ec4","name":"","active":true,"console":"false","complete":"false","x":650,"y":640,"wires":[]},{"id":"ab4438a6.ad28f","type":"ui_text","z":"d92bc279.83ec4","group":"9d06616d.48b6","order":2,"width":0,"height":0,"name":"","label":"Mode","format":"{{msg.payload}}","layout":"row-spread","x":790,"y":280,"wires":[]},{"id":"facf2115.0d5d8","type":"function","z":"d92bc279.83ec4","name":"SetToSelectedColor","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : msg.payload.r,\n\"gg\" : msg.payload.g,\n\"bb\" :  msg.payload.b\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":380,"y":640,"wires":[["3c5f7439.3125a4"]]},{"id":"663cc621.5aaff","type":"ibmiot in","z":"4b61f53d.4e7d24","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb00","applicationId":"","deviceType":"+","eventType":"ping","commandType":"","format":"json","name":"FromPiCandle","service":"registered","allDevices":false,"allApplications":false,"allDeviceTypes":true,"allEvents":true,"allCommands":false,"allFormats":true,"qos":"0","x":150,"y":120,"wires":[["67818725.49b818","1fa68e0e.a185fa","ed96f06a.fdd788","337ae1e9.f72aee","bf101316.17596","4f267752.eb84b","d35a1483.1759","aea302e7.63965"]]},{"id":"67818725.49b818","type":"debug","z":"4b61f53d.4e7d24","name":"","active":true,"console":"false","complete":"false","x":410,"y":80,"wires":[]},{"id":"f08349b5.0b4bb","type":"comment","z":"4b61f53d.4e7d24","name":"GetDataFromPi","info":"","x":160,"y":40,"wires":[]},{"id":"f399dd7b.0ac67","type":"ui_button","z":"4b61f53d.4e7d24","name":"","group":"7403572f.6947f","order":0,"width":0,"height":0,"passthru":false,"label":"Set Candle to Red","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":190,"y":360,"wires":[["6f05bb86.9d0414"]]},{"id":"1fa68e0e.a185fa","type":"ui_text","z":"4b61f53d.4e7d24","group":"7b96dd88.919304","order":1,"width":0,"height":0,"name":"","label":"Name","format":"{{msg.payload.candleName}}","layout":"row-spread","x":330,"y":260,"wires":[]},{"id":"6f05bb86.9d0414","type":"function","z":"4b61f53d.4e7d24","name":"SetColorRed","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":430,"y":360,"wires":[["6bf1f34d.2a2fd4"]]},{"id":"6bf1f34d.2a2fd4","type":"ibmiot out","z":"4b61f53d.4e7d24","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb00","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"ToPiCandle","service":"registered","x":790,"y":420,"wires":[]},{"id":"bf101316.17596","type":"ui_text","z":"4b61f53d.4e7d24","group":"7b96dd88.919304","order":2,"width":0,"height":0,"name":"","label":"Counter","format":"{{msg.payload.value}}","layout":"row-spread","x":340,"y":300,"wires":[]},{"id":"337ae1e9.f72aee","type":"ui_text","z":"4b61f53d.4e7d24","group":"7b96dd88.919304","order":3,"width":0,"height":0,"name":"","label":"IpAddress","format":"{{msg.payload.ipAddr}}","layout":"row-spread","x":350,"y":220,"wires":[]},{"id":"51d48b8e.7116c4","type":"ui_button","z":"4b61f53d.4e7d24","name":"","group":"7403572f.6947f","order":0,"width":0,"height":0,"passthru":false,"label":"SetCandletoblueFlash","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":180,"y":520,"wires":[["2942a1da.1c2e0e"]]},{"id":"2942a1da.1c2e0e","type":"function","z":"4b61f53d.4e7d24","name":"setCandleMode=FadeBlueFast","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":01,\n\"speed1\":01,\n\"speed2\":00,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255,\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":490,"y":520,"wires":[["6bf1f34d.2a2fd4"]]},{"id":"ed96f06a.fdd788","type":"function","z":"4b61f53d.4e7d24","name":"candleRR","func":"return {payload:msg.payload.candleRR};","outputs":1,"noerr":0,"x":880,"y":120,"wires":[["fb8e6fcb.1a8a8"]]},{"id":"d35a1483.1759","type":"function","z":"4b61f53d.4e7d24","name":"candleGG","func":"return {payload:msg.payload.candleGG};","outputs":1,"noerr":0,"x":880,"y":160,"wires":[["1f7b1707.1daa51"]]},{"id":"b8b0a63.bdfbf58","type":"ui_gauge","z":"4b61f53d.4e7d24","name":"","group":"6f7fb2b3.bc0454","order":0,"width":0,"height":0,"gtype":"gage","title":"Blue","label":"units","format":"{{value}}","min":0,"max":"255","colors":["#7e959a","#6f7dc9","#530dbb"],"seg1":"","seg2":"","x":1050,"y":220,"wires":[]},{"id":"fb8e6fcb.1a8a8","type":"ui_gauge","z":"4b61f53d.4e7d24","name":"","group":"6f7fb2b3.bc0454","order":0,"width":0,"height":0,"gtype":"gage","title":"Red","label":"units","format":"{{value}}","min":0,"max":"255","colors":["#7e959a","#bcb489","#ac0c19"],"seg1":"","seg2":"","x":1050,"y":120,"wires":[]},{"id":"c2cedb6a.f12b98","type":"ui_colour_picker","z":"4b61f53d.4e7d24","name":"","label":"SetCandle to","group":"7b96dd88.919304","format":"rgb","outformat":"object","showSwatch":true,"showPicker":false,"showValue":false,"showAlpha":false,"showLightness":true,"order":0,"width":"6","height":"1","passthru":true,"topic":"","x":170,"y":600,"wires":[["df36f733.62ef38","934e7120.f882b8"]]},{"id":"df36f733.62ef38","type":"debug","z":"4b61f53d.4e7d24","name":"","active":true,"console":"false","complete":"false","x":570,"y":620,"wires":[]},{"id":"6c9e7200.49432","type":"debug","z":"27e6f3b6.413ff4","name":"OutputVar","active":true,"console":"false","complete":"payload","x":500,"y":80,"wires":[]},{"id":"1e76019f.c719c6","type":"inject","z":"27e6f3b6.413ff4","name":"Start","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":125.5,"y":80.25,"wires":[["f2734e0c.599ad8"]]},{"id":"f2734e0c.599ad8","type":"function","z":"27e6f3b6.413ff4","name":"Variable","func":"/* comment / describe your program */\nvar myname = \"Markus\";\nvar mynumber = 100;\nvar mynumber2 = 71.10;\nvar mybool = true;\n\n//When adding number to string all becomes a string\n\nnode.warn(\"String = \"+myname); \nnode.warn(\"Number1 = \"+mynumber2 + mynumber); \nnode.warn(\"Boolean = \"+mybool); \n\nmsg.payload = myname; \nreturn msg;","outputs":1,"noerr":0,"x":320,"y":80,"wires":[["6c9e7200.49432"]]},{"id":"65992cd2.e12a24","type":"debug","z":"27e6f3b6.413ff4","name":"outputIF","active":true,"console":"false","complete":"payload","x":500,"y":300,"wires":[]},{"id":"500c5b9b.29c43c","type":"inject","z":"27e6f3b6.413ff4","name":"Start","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":125.5,"y":300.25,"wires":[["824a3565.afad88"]]},{"id":"824a3565.afad88","type":"function","z":"27e6f3b6.413ff4","name":"IF","func":"/* comment / describe your program */\nvar i = 1;\nvar a = 5;\nvar answer;\nif(a>i)\n{\n    answer=true;\n}else{\n     answer=false;\n    \n}\n\nnode.warn(\"is a > i = \"+answer);\nmsg.payload = answer;\nreturn msg;","outputs":1,"noerr":0,"x":310,"y":300,"wires":[["65992cd2.e12a24"]]},{"id":"1890680d.5a6c18","type":"debug","z":"27e6f3b6.413ff4","name":"outputWHILE","active":true,"console":"false","complete":"payload","x":520,"y":360,"wires":[]},{"id":"dc614186.9651b","type":"inject","z":"27e6f3b6.413ff4","name":"Start","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":125.5,"y":360.25,"wires":[["cdcf5d1e.9ce67"]]},{"id":"cdcf5d1e.9ce67","type":"function","z":"27e6f3b6.413ff4","name":"WHILE","func":"/* comment / describe your program */\nvar i = 1;\nvar a = 5;\n\n\nwhile (a > i)\n{\n i++;\n node.warn(\" i = \"+i);\n}\n\n\nmsg.payload = i;\nreturn msg;","outputs":1,"noerr":0,"x":310,"y":360,"wires":[["1890680d.5a6c18"]]},{"id":"94faeb99.1ed6a","type":"debug","z":"27e6f3b6.413ff4","name":"outputFOR","active":true,"console":"false","complete":"payload","x":510,"y":420,"wires":[]},{"id":"96c3f5b1.47ee2","type":"inject","z":"27e6f3b6.413ff4","name":"Start","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":125.5,"y":420.25,"wires":[["f66123c6.bb9a9"]]},{"id":"7f88af23.cf511","type":"debug","z":"27e6f3b6.413ff4","name":"OutputHex","active":true,"console":"false","complete":"payload","x":470,"y":700,"wires":[]},{"id":"7b35171f.3f152","type":"inject","z":"27e6f3b6.413ff4","name":"Start","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":85.5,"y":700.25,"wires":[["6ad2bec1.4ce408"]]},{"id":"6ad2bec1.4ce408","type":"function","z":"27e6f3b6.413ff4","name":"HexDecBin","func":"/* comment / describe your program */\n\nvar hex = 0xAC;\nvar bin = 0b1000; \n\n// conversion via toString(base) base = 10,2,16 etc\n\n\n\n\nnode.warn(\"Hex = \"+hex.toString(16)); \nnode.warn(\"Dec = \"+hex.toString(10)); \nnode.warn(\"Bin = \"+hex.toString(2)); \nnode.warn(bin);\nmsg.payload = hex; \nreturn msg;","outputs":1,"noerr":0,"x":290,"y":700,"wires":[["7f88af23.cf511"]]},{"id":"4736deee.559df","type":"debug","z":"27e6f3b6.413ff4","name":"OutputObj","active":true,"console":"false","complete":"payload","x":510,"y":140,"wires":[]},{"id":"6c26bc0f.af981c","type":"inject","z":"27e6f3b6.413ff4","name":"Start","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":105.5,"y":140.25,"wires":[["ae12b4e4.0cebb8"]]},{"id":"ae12b4e4.0cebb8","type":"function","z":"27e6f3b6.413ff4","name":"Objects","func":"/* comment / describe your program */\nvar myname = \"Markus\"\nvar myJson = {\n    \"lable\":\"value\",\n    \"string\":myname\n    \n}\n\nmyJson.NewLabel = \"SNP\";\n\n\nmsg.payload = myJson; \nreturn msg;","outputs":1,"noerr":0,"x":300,"y":140,"wires":[["4736deee.559df"]]},{"id":"360c73f6.60d1fc","type":"debug","z":"27e6f3b6.413ff4","name":"OutputMix","active":true,"console":"false","complete":"payload","x":510,"y":200,"wires":[]},{"id":"8dba4184.cc3f6","type":"inject","z":"27e6f3b6.413ff4","name":"Start","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":125.5,"y":200.25,"wires":[["5ef486fc.3d2928"]]},{"id":"5ef486fc.3d2928","type":"function","z":"27e6f3b6.413ff4","name":"Mix","func":"/* comment / describe your program */\nvar myname = \"Markus\";\nvar mynumber = 100;\nvar hex = 0xFF;\nvar mynumber2 = 71.10;\nvar mybool = true;\nvar myJson = {\n    \"lable\":\"value\",\n    \"MyName\":myname\n    \n}\n\nmyJson.NewLabel = \"SNP\";\n\nvar myarray = [];\nmyarray[0]=\"c\";\nmyarray[1]=\"a\";\nmyarray[2]=99;\n\n// comment\nnode.warn(\"String = \"+myname); \nnode.warn(\"String2 = \"+mynumber); //When adding number to string all becomes a string\nnode.warn(\"Number1 = \"+mynumber2 + mynumber); \nnode.warn(\"Boolean = \"+mybool); \nnode.warn(\"Hex = \"+hex); \nnode.warn(hex.toString(16)); \nnode.warn(\"MyArray = \"+myarray); \n\nmsg.payload = myJson;\nreturn msg;","outputs":1,"noerr":0,"x":310,"y":200,"wires":[["360c73f6.60d1fc"]]},{"id":"e59a504c.f5baa8","type":"debug","z":"27e6f3b6.413ff4","name":"outputFOR","active":true,"console":"false","complete":"payload","x":490,"y":540,"wires":[]},{"id":"ce70f599.23398","type":"inject","z":"27e6f3b6.413ff4","name":"Start","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":105.5,"y":540.25,"wires":[["1f4a10ba.a04917"]]},{"id":"29a59b3f.b600bc","type":"debug","z":"27e6f3b6.413ff4","name":"outputFOR","active":true,"console":"false","complete":"payload","x":490,"y":620,"wires":[]},{"id":"51a53401.86f63c","type":"inject","z":"27e6f3b6.413ff4","name":"Start","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":105.5,"y":620.25,"wires":[["88930ee6.7a2c68"]]},{"id":"88930ee6.7a2c68","type":"function","z":"27e6f3b6.413ff4","name":"MyObject","func":"/* comment / describe your program */\nvar myname = \"Markus\"\nvar myJson = {\n    \"lable\":\"value\",\n    \"string\":myname\n    \n}\n\nmyJson.age = 48;\nmyJson.firstName = \"Markus\";\nmyJson.lastName = \"van Kempen\";\n\nmsg.payload = myJson; \nreturn msg;","outputs":1,"noerr":0,"x":300,"y":620,"wires":[["29a59b3f.b600bc"]]},{"id":"19c9b2dc.f60f25","type":"weather_insights","z":"848e1832.066718","name":"Brantford","host":"twcservice.mybluemix.net","service":"/observations.json","geocode":"43.1476032,-80.3090849","units":"m","language":"","x":400,"y":260,"wires":[["4c0c6a6d.51259c","66122ebf.9cc3"]]},{"id":"d536de71.e0237","type":"inject","z":"848e1832.066718","name":"","topic":"","payload":"markus","payloadType":"str","repeat":"","crontab":"","once":false,"x":170,"y":100,"wires":[["84a633ff.333258"]]},{"id":"84a633ff.333258","type":"function","z":"848e1832.066718","name":"","func":"msg.payload = msg.payload + \"van Kempen\"\nreturn msg;","outputs":1,"noerr":0,"x":353.5,"y":99.75,"wires":[["85237822.b5a57"]]},{"id":"85237822.b5a57","type":"debug","z":"848e1832.066718","name":"","active":true,"console":"false","complete":"false","x":530,"y":100,"wires":[]},{"id":"4c0c6a6d.51259c","type":"debug","z":"848e1832.066718","name":"Brantford","active":true,"console":"false","complete":"observation","x":640,"y":260,"wires":[]},{"id":"66122ebf.9cc3","type":"switch","z":"848e1832.066718","name":"Switch","property":"observation.temp","propertyType":"msg","rules":[{"t":"lt","v":"10","vt":"num"},{"t":"gt","v":"18","vt":"str"},{"t":"else"}],"checkall":"true","outputs":3,"x":530,"y":360,"wires":[["daf6bc87.5d8908"],["301ae9e2.e1cdb6"],["58b1d9ae.ecb81"]]},{"id":"85cf948.f90f7e8","type":"function","z":"848e1832.066718","name":"IF<10","func":"if (msg.observation.temp <10)\n    node.send(msg.observation)\n","outputs":1,"noerr":0,"x":550,"y":600,"wires":[[]]},{"id":"d41f1fb.4b45ae","type":"weather_insights","z":"848e1832.066718","name":"Johannesburg","host":"twcservice.mybluemix.net","service":"/forecast/daily/10day.json","geocode":"-26.1715046,27.9699844","units":"m","language":"","x":380,"y":500,"wires":[["66122ebf.9cc3","e3508efe.3724f8"]]},{"id":"b00ab708.08978","type":"inject","z":"848e1832.066718","name":"Start","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":150,"y":260,"wires":[["19c9b2dc.f60f25"]]},{"id":"6b1a1c06.02bce4","type":"inject","z":"848e1832.066718","name":"Start","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":150,"y":500,"wires":[["d41f1fb.4b45ae"]]},{"id":"e3508efe.3724f8","type":"debug","z":"848e1832.066718","name":"joburg","active":true,"console":"false","complete":"observation","x":630,"y":500,"wires":[]},{"id":"301ae9e2.e1cdb6","type":"function","z":"848e1832.066718","name":"SetColorRed","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":790,"y":360,"wires":[["ecb89614.8eaa3"]]},{"id":"daf6bc87.5d8908","type":"function","z":"848e1832.066718","name":"SetColorBlue","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":790,"y":320,"wires":[["ecb89614.8eaa3"]]},{"id":"58b1d9ae.ecb81","type":"function","z":"848e1832.066718","name":"SetColorOrange","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 140,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":800,"y":400,"wires":[["ecb89614.8eaa3"]]},{"id":"ecb89614.8eaa3","type":"ibmiot out","z":"848e1832.066718","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb00","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"toPiCandle","service":"registered","x":1030,"y":360,"wires":[]},{"id":"a7103a89.0ed81","type":"function","z":"848e1832.066718","name":"IF>20","func":"if (msg.observation.temp <10)\n    node.send(msg.observation)\n","outputs":1,"noerr":0,"x":550,"y":640,"wires":[[]]},{"id":"a3a77e92.5f8f18","type":"function","z":"848e1832.066718","name":"IF>10 && <20","func":"if (msg.observation.temp >10 && msg.observation.temp <20 )\n    node.send(msg.observation)\n","outputs":1,"noerr":0,"x":580,"y":680,"wires":[[]]},{"id":"b66d92fc.302158","type":"function","z":"848e1832.066718","name":"","func":"\nreturn msg;","outputs":1,"noerr":0,"x":410,"y":640,"wires":[["85cf948.f90f7e8","a7103a89.0ed81","a3a77e92.5f8f18"]]},{"id":"7bbec11e.5885d","type":"function","z":"848e1832.066718","name":"CheckAndSet","func":"var r=0;\nvar g=0;\nvar b=0;\n\nif (msg.observation.temp <10)\n       b=255; \n\n\nif (msg.observation.temp >20)\n       r=255; \n       \nif (msg.observation.temp >10 && msg.observation.temp <20 )\n{\n   r=255;\n   g=140;\n    \n}       \n       \n       \nvar newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : r,\n\"gg\" : g,\n\"bb\" : b\n    \n}\n\n\n\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":820,"y":620,"wires":[[]]},{"id":"c75bc896.51646","type":"weather_insights","z":"6934ef1.e47ca1","name":"Brantford","host":"twcservice.mybluemix.net","service":"/observations.json","geocode":"43.1476032,-80.3090849","units":"m","language":"","x":400,"y":80,"wires":[["2a590911.30fffe","4fd2e7bf.ab4e6"]]},{"id":"2a590911.30fffe","type":"debug","z":"6934ef1.e47ca1","name":"Brantford","active":true,"console":"false","complete":"observation","x":640,"y":80,"wires":[]},{"id":"4287d97a.fb42d","type":"function","z":"6934ef1.e47ca1","name":"IF<10","func":"if (msg.observation.temp <10)\n    node.send(msg.observation)\n","outputs":1,"noerr":0,"x":230,"y":680,"wires":[[]]},{"id":"bf0ab52b.cd9478","type":"weather_insights","z":"6934ef1.e47ca1","name":"Cape Town","host":"twcservice.mybluemix.net","service":"/observations.json","geocode":"-33.9142688,18.0956097","units":"m","language":"","x":370,"y":320,"wires":[["8c5ffe51.9c3e4","4fd2e7bf.ab4e6"]]},{"id":"3a2fd111.f2db06","type":"inject","z":"6934ef1.e47ca1","name":"Start","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":150,"y":80,"wires":[["c75bc896.51646"]]},{"id":"61127293.32a164","type":"inject","z":"6934ef1.e47ca1","name":"Start","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":150,"y":320,"wires":[["bf0ab52b.cd9478"]]},{"id":"8c5ffe51.9c3e4","type":"debug","z":"6934ef1.e47ca1","name":"joburg","active":true,"console":"false","complete":"observation","x":370,"y":380,"wires":[]},{"id":"733c72de.d4b034","type":"ibmiot out","z":"6934ef1.e47ca1","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb00","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"toPiCandle","service":"registered","x":910,"y":180,"wires":[]},{"id":"9b3b6d8e.408498","type":"function","z":"6934ef1.e47ca1","name":"IF>20","func":"if (msg.observation.temp <10)\n    node.send(msg.observation)\n","outputs":1,"noerr":0,"x":230,"y":720,"wires":[[]]},{"id":"d73be5c7.2d1838","type":"function","z":"6934ef1.e47ca1","name":"IF>10 && <20","func":"if (msg.observation.temp >10 && msg.observation.temp <20 )\n    node.send(msg.observation)\n","outputs":1,"noerr":0,"x":260,"y":760,"wires":[[]]},{"id":"43ab8e3.045c17","type":"function","z":"6934ef1.e47ca1","name":"","func":"\nreturn msg;","outputs":1,"noerr":0,"x":90,"y":720,"wires":[["4287d97a.fb42d","9b3b6d8e.408498","d73be5c7.2d1838"]]},{"id":"4fd2e7bf.ab4e6","type":"function","z":"6934ef1.e47ca1","name":"CheckAndSet","func":"var r=0;\nvar g=0;\nvar b=0;\n\nif (msg.observation.temp <=10)\n       b=255; \n\n\nif (msg.observation.temp >=20)\n       r=255; \n       \nif (msg.observation.temp >10 && msg.observation.temp <20 )\n{\n   r=255;\n   g=140;\n    \n}       \n       \n       \nvar newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : r,\n\"gg\" : g,\n\"bb\" : b\n    \n}\n\n\n\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":640,"y":180,"wires":[["733c72de.d4b034","66f88f5f.2549b","a9b19f30.bcc73","9fb35c91.444588"]]},{"id":"103ae60b.fef72a","type":"function","z":"6934ef1.e47ca1","name":"Set to10","func":"msg.observation={}\nmsg.observation.temp = 10\nmsg.payload = 10;\nreturn msg;","outputs":1,"noerr":0,"x":240,"y":160,"wires":[["4fd2e7bf.ab4e6"]]},{"id":"f92ca5aa.a5a298","type":"inject","z":"6934ef1.e47ca1","name":"Cold","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":110,"y":160,"wires":[["103ae60b.fef72a"]]},{"id":"66f88f5f.2549b","type":"debug","z":"6934ef1.e47ca1","name":"SendToCandle","active":true,"console":"false","complete":"true","x":900,"y":120,"wires":[]},{"id":"d453116f.e85598","type":"function","z":"6934ef1.e47ca1","name":"Set to 20","func":"msg.observation={}\nmsg.observation.temp = 20\nreturn msg;\n","outputs":1,"noerr":0,"x":240,"y":200,"wires":[["4fd2e7bf.ab4e6"]]},{"id":"8945ed70.2017b8","type":"inject","z":"6934ef1.e47ca1","name":"Hot","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":110,"y":200,"wires":[["d453116f.e85598"]]},{"id":"d1427b5f.4f1128","type":"function","z":"6934ef1.e47ca1","name":"Set to 15","func":"msg.observation={}\nmsg.observation.temp = 15;\n\nreturn msg;","outputs":1,"noerr":0,"x":240,"y":240,"wires":[["4fd2e7bf.ab4e6"]]},{"id":"91c921dd.2d3398","type":"inject","z":"6934ef1.e47ca1","name":"Warm","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":110,"y":240,"wires":[["d1427b5f.4f1128"]]},{"id":"61fa28e0.c9f498","type":"ui_chart","z":"6934ef1.e47ca1","name":"","group":"69fb3eb5.9ba54","order":0,"width":0,"height":0,"label":"chart","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"60","cutout":0,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":2,"x":930,"y":360,"wires":[[],[]]},{"id":"de0f1777.f91d18","type":"ui_gauge","z":"6934ef1.e47ca1","name":"","group":"69fb3eb5.9ba54","order":0,"width":0,"height":0,"gtype":"gage","title":"Gauge","label":"units","format":"{{value}}","min":"50","max":"50","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":930,"y":300,"wires":[]},{"id":"a9b19f30.bcc73","type":"function","z":"6934ef1.e47ca1","name":"observation.temp ","func":"msg.payload = msg.observation.temp \nreturn msg;","outputs":1,"noerr":0,"x":670,"y":340,"wires":[["de0f1777.f91d18","61fa28e0.c9f498","e8467fe2.08661"]]},{"id":"2d76a5e.a15865a","type":"template","z":"5654962e.5c5de","name":"Space Station Tracker","field":"payload","fieldType":"msg","format":"handlebars","syntax":"plain","template":"<!DOCTYPE html>\n<html>\n    <head>\n        <title>Realtime ISS</title>\n        <meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=no\" />\n        <style type=\"text/css\">\n            html { height: 100% }\n            body { height: 100%; margin: 0; padding: 0 }\n            #map { height: 100% }\n        </style>\n        <script type=\"text/javascript\" src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyAFLoXS1lPMv75OISOZ0GujwAhH1LPlJP4&sensor=false\"></script>\n        <script src=\"//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js\"></script>\n        <script type=\"text/javascript\">\n            var map, marker, last_latlng;\n\n            function init() {\n                var latlng = new google.maps.LatLng(51.48931, -0.08819);\n                var mapOptions = { center: latlng, zoom: 4, mapTypeId: google.maps.MapTypeId.TERRAIN, disableDefaultUI: false};\n                map = new google.maps.Map(document.getElementById(\"map\"), mapOptions);\n                infoWindow = new google.maps.InfoWindow();\n                maxZoomService = new google.maps.MaxZoomService();\n                map.addListener('click', showMaxZoom);\n                marker = new google.maps.Marker({ position: latlng, map: map, title: \"Lat:\"+latlng, icon: 'https://raw.githubusercontent.com/picklepete/iss/master/saticon.gif' });\n            }\n            google.maps.event.addDomListener(window, 'load', init);\n\n\n\n           function showMaxZoom(e) {\n             maxZoomService.getMaxZoomAtLatLng(e.latLng, function(response) {\n               if (response.status !== google.maps.MaxZoomStatus.OK) {\n                 infoWindow.setContent('Error in MaxZoomService');\n               } else {\n                 infoWindow.setContent(\n                     'The maximum zoom at this location is: ' + response.zoom);\n               }\n               infoWindow.setPosition(e.latLng);\n               infoWindow.open(map);\n             });\n           }\n            function draw_flight_path(latlng) {\n                if(last_latlng == undefined) {\n                    last_latlng = latlng;\n                }\n                flight_path = new google.maps.Polyline({\n                    path: [last_latlng, latlng],\n                    strokeColor: \"#FF0000\",\n                    strokeOpacity: 1.0,\n                    strokeWeight: 2\n                });\n                last_latlng = latlng;\n                flight_path.setMap(map);\n            };\n\n            function get_latest_position() {\n                $.getJSON('http://open-notify-api.herokuapp.com/iss-now.json?callback=?', function(data, status) {\n                    position = data.iss_position;\n var latlng = new google.maps.LatLng(position.latitude, position.longitude);\n// $.getJSON('https://api.wheretheiss.at/v1/satellites/25544/', function(data, status) {\n\n                    var latlng = new google.maps.LatLng(position.latitude, position.longitude);\n                    map.setCenter(latlng);\n                    marker.setPosition(latlng);\n                    marker.setTitle(\"Position: \"+latlng);\n                    var mycon = \"ISSI<br>Lat:\"+position.latitude+\"<br>Long\"+ position.longitude\n                    var myinfowindow = new google.maps.InfoWindow({\n                        content: mycon\n                    });\n marker.addListener('click', function() {\n    myinfowindow.open(map, marker);\n  });\n\n                    draw_flight_path(latlng);\n                    \n                });\n            };\n            setInterval(get_latest_position, 5000);\n        </script>\n    </head>\n    <body>\n        <div id=\"map\"/>\n    </body>\n</html>\n","output":"str","x":320,"y":80,"wires":[["d1c1596f.9acba8"]]},{"id":"900b3669.19da4","type":"http in","z":"5654962e.5c5de","name":"","url":"/issi","method":"get","upload":false,"swaggerDoc":"","x":103.5,"y":79.25,"wires":[["2d76a5e.a15865a"]]},{"id":"d1c1596f.9acba8","type":"http response","z":"5654962e.5c5de","name":"","statusCode":"","headers":{},"x":530,"y":80,"wires":[]},{"id":"768a35c.2b49e4c","type":"http request","z":"5654962e.5c5de","name":"","method":"GET","ret":"obj","url":"http://open-notify-api.herokuapp.com/iss-now.json","tls":"","x":350,"y":140,"wires":[["1385ce51.e85c5a","34325466.558e54","8a63407d.64b84"]]},{"id":"1385ce51.e85c5a","type":"debug","z":"5654962e.5c5de","name":"IssiPos","active":false,"console":"false","complete":"payload","x":530.5,"y":141.5,"wires":[]},{"id":"820bae97.9c8b68","type":"inject","z":"5654962e.5c5de","name":"","topic":"","payload":"","payloadType":"date","repeat":"10","crontab":"","once":false,"x":118.5,"y":139.25,"wires":[["768a35c.2b49e4c"]]},{"id":"63cd7771.dd09f","type":"ui_template","z":"5654962e.5c5de","group":"7fc35eba.8805d8","name":"map","order":0,"width":"15","height":"11","format":"<div >\n<iframe src=\"/issi\" height=600 width=800>\n  <p>Your browser does not support iframes.</p>\n</iframe>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":690,"y":80,"wires":[[]]},{"id":"18496b00.291e05","type":"comment","z":"5654962e.5c5de","name":"City","info":"whihte hourse\n60.6994622,-135.3647481,","x":110,"y":220,"wires":[]},{"id":"26d21509.be00ea","type":"ibmiot out","z":"7ebfd059.b4fe1","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb00","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"toPiCandle","service":"registered","x":930,"y":200,"wires":[]},{"id":"8533d0c5.21f39","type":"function","z":"7ebfd059.b4fe1","name":"CheckAndSet","func":"var r=0;\nvar g=0;\nvar b=0;\n\nif (msg.observation.temp <=10)\n       b=255; \n\n\nif (msg.observation.temp >=20)\n       r=255; \n       \nif (msg.observation.temp >10 && msg.observation.temp <20 )\n{\n   r=255;\n   g=140;\n    \n}       \n       \n       \nvar newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : r,\n\"gg\" : g,\n\"bb\" : b\n    \n}\n\n\n\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":660,"y":200,"wires":[["26d21509.be00ea","4c56e1d1.5a27b"]]},{"id":"b3d3a22.d6b546","type":"function","z":"7ebfd059.b4fe1","name":"Set to10","func":"msg.observation={}\nmsg.observation.temp = 10\nmsg.payload = 10;\nreturn msg;","outputs":1,"noerr":0,"x":260,"y":180,"wires":[["8533d0c5.21f39"]]},{"id":"66a96d38.5f5fa4","type":"inject","z":"7ebfd059.b4fe1","name":"Cold","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":130,"y":180,"wires":[["b3d3a22.d6b546"]]},{"id":"4c56e1d1.5a27b","type":"debug","z":"7ebfd059.b4fe1","name":"SendToCandle","active":true,"console":"false","complete":"true","x":920,"y":140,"wires":[]},{"id":"8e43f67b.9b9098","type":"inject","z":"7ebfd059.b4fe1","name":"Hot","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":130,"y":220,"wires":[["c1619cd5.b0cc28"]]},{"id":"4322998a.1cabb8","type":"function","z":"7ebfd059.b4fe1","name":"Set to 15","func":"msg.observation={}\nmsg.observation.temp = 15;\n\nreturn msg;","outputs":1,"noerr":0,"x":260,"y":260,"wires":[["8533d0c5.21f39"]]},{"id":"ee414bc5.a12c2","type":"inject","z":"7ebfd059.b4fe1","name":"Warm","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":130,"y":260,"wires":[["4322998a.1cabb8"]]},{"id":"14509aec.61606d","type":"function","z":"7ebfd059.b4fe1","name":"Create Email","func":"msg.observation={}\nmsg.observation.temp=5;\n\nif (msg.observation.temp <10)\n{\n    msg.topic = \"SNP00 temp update\"\n    msg.payload= \"Hello from Node-RED \"+\"\\nTemperature in Brantford is \"+msg.observation.temp \n\nnode.send(msg)\n}\n//return msg;","outputs":1,"noerr":0,"x":630,"y":500,"wires":[[]]},{"id":"3b774975.709166","type":"inject","z":"7ebfd059.b4fe1","name":"Warm","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":410,"y":500,"wires":[["14509aec.61606d"]]},{"id":"34325466.558e54","type":"function","z":"5654962e.5c5de","name":"DisplayLat","func":"\nreturn msg;","outputs":1,"noerr":0,"x":530,"y":220,"wires":[["875bdbd1.403ee8","5699db84.cfe58c"]]},{"id":"875bdbd1.403ee8","type":"ui_text","z":"5654962e.5c5de","group":"4ef99cc2.56e3b4","order":1,"width":0,"height":0,"name":"","label":"latitude","format":"{{msg.payload.iss_position.latitude}}","layout":"row-spread","x":721.5,"y":211.25,"wires":[]},{"id":"5699db84.cfe58c","type":"ui_text","z":"5654962e.5c5de","group":"4ef99cc2.56e3b4","order":2,"width":0,"height":0,"name":"","label":"longitude","format":"{{msg.payload.iss_position.longitude}}","layout":"row-spread","x":721.5,"y":271.25,"wires":[]},{"id":"90a549db.530c4","type":"weather_insights","z":"5654962e.5c5de","name":"GetTemp","host":"twcservice.mybluemix.net","service":"/observations.json","geocode":"-26.1715046,27.9699844","units":"m","language":"","x":260,"y":400,"wires":[["8ff5eeb4.931468","c9b3d6a4.043b48","a06f6444.404f2","ac452ea.dc16a5","c98ba095.d30008","37cfbed7.8b35e2"]]},{"id":"e472e73f.fa097","type":"function","z":"5654962e.5c5de","name":"LATLON","func":"\nmsg.latitude = msg.payload.iss_position.latitude;\nmsg.longitude = msg.payload.iss_position.longitude;\n\nmsg.payload = \"\"+msg.latitude+\",\"+msg.longitude;\n\nreturn msg;","outputs":1,"noerr":0,"x":300,"y":340,"wires":[["8c751cb9.f120d"]]},{"id":"8274603a.2781a","type":"ui_chart","z":"5654962e.5c5de","name":"","group":"4ef99cc2.56e3b4","order":4,"width":0,"height":0,"label":"Temperature Chart","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"-30","ymax":"50","removeOlder":"5","removeOlderPoints":"","removeOlderUnit":"60","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":2,"x":750,"y":420,"wires":[[],[]]},{"id":"60d31634.e9fc18","type":"ui_gauge","z":"5654962e.5c5de","name":"","group":"4ef99cc2.56e3b4","order":5,"width":0,"height":0,"gtype":"gage","title":"Temperature","label":"units","format":"{{value}}","min":"-50","max":"50","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":730,"y":360,"wires":[]},{"id":"8ff5eeb4.931468","type":"function","z":"5654962e.5c5de","name":"get Temperature","func":"\n\nmsg.payload=msg.observation.temp ;\nreturn msg;","outputs":1,"noerr":0,"x":520,"y":400,"wires":[["60d31634.e9fc18","8274603a.2781a"]]},{"id":"c9b3d6a4.043b48","type":"debug","z":"5654962e.5c5de","name":"temperature","active":true,"console":"false","complete":"true","x":510,"y":440,"wires":[]},{"id":"8a63407d.64b84","type":"delay","z":"5654962e.5c5de","name":"","pauseType":"rate","timeout":"1","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":320,"y":280,"wires":[["e472e73f.fa097"]]},{"id":"9f5b5cfe.514a18","type":"switch","z":"5654962e.5c5de","name":"Switch","property":"payload","propertyType":"msg","rules":[{"t":"lte","v":"10","vt":"num"},{"t":"gte","v":"20","vt":"str"},{"t":"else"}],"checkall":"true","outputs":3,"x":210,"y":820,"wires":[["28cfaade.19b556"],["bb299075.ceb738"],["666fdf52.2ea748"]]},{"id":"bb299075.ceb738","type":"function","z":"5654962e.5c5de","name":"SetColorRed","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":470,"y":820,"wires":[["b502cdd.3745f3"]]},{"id":"28cfaade.19b556","type":"function","z":"5654962e.5c5de","name":"SetColorBlue","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":470,"y":780,"wires":[["b502cdd.3745f3"]]},{"id":"666fdf52.2ea748","type":"function","z":"5654962e.5c5de","name":"SetColorOrange","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 140,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":480,"y":860,"wires":[["b502cdd.3745f3"]]},{"id":"b502cdd.3745f3","type":"ibmiot out","z":"5654962e.5c5de","authentication":"quickstart","apiKey":"","outputType":"evt","deviceId":"playbulb","deviceType":"0.17.5","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"toPiCandle","service":"quickstart","x":710,"y":820,"wires":[]},{"id":"17d6acfa.a476b3","type":"ui_gauge","z":"5654962e.5c5de","name":"","group":"7fc35eba.8805d8","order":0,"width":"5","height":"3","gtype":"gage","title":"Blue","label":"units","format":"{{value}}","min":0,"max":"255","colors":["#7e959a","#6f7dc9","#530dbb"],"seg1":"","seg2":"","x":690,"y":1020,"wires":[]},{"id":"1d29c5b8.8d397a","type":"ui_gauge","z":"5654962e.5c5de","name":"","group":"7fc35eba.8805d8","order":0,"width":"5","height":"3","gtype":"gage","title":"Red","label":"units","format":"{{value}}","min":0,"max":"255","colors":["#7e959a","#bcb489","#ac0c19"],"seg1":"","seg2":"","x":687.5,"y":944.25,"wires":[]},{"id":"4a6aa3de.2d2aa4","type":"ui_gauge","z":"5654962e.5c5de","name":"","group":"7fc35eba.8805d8","order":0,"width":"5","height":"3","gtype":"gage","title":"Green","label":"units","format":"{{value}}","min":0,"max":"255","colors":["#7e959a","#73bc78","#21ac1b"],"seg1":"","seg2":"","x":690,"y":980,"wires":[]},{"id":"3a74d57d.ff5342","type":"ibmiot in","z":"5654962e.5c5de","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb00","applicationId":"","deviceType":"+","eventType":"ping","commandType":"","format":"json","name":"FromPiCandle","service":"registered","allDevices":false,"allApplications":false,"allDeviceTypes":true,"allEvents":true,"allCommands":false,"allFormats":true,"qos":"0","x":370,"y":980,"wires":[["1d29c5b8.8d397a","4a6aa3de.2d2aa4","17d6acfa.a476b3"]]},{"id":"c98ba095.d30008","type":"ui_text","z":"5654962e.5c5de","group":"4ef99cc2.56e3b4","order":3,"width":0,"height":0,"name":"","label":"Weather Station","format":"{{msg.observation.obs_name}}","layout":"row-spread","x":740,"y":320,"wires":[]},{"id":"a06f6444.404f2","type":"function","z":"5654962e.5c5de","name":"CheckArea","func":"//top right corner Latitude: 26.368249 | Longitude: 114.257813\n//bottom left corner Latitude: 6.245404 | Longitude: 91.40625\n\nif((msg.longitude >  91.40625  && msg.longitude <  137.109375) && (msg.latitude >  6.24540  && msg.latitude < 26.36824))\n{\n\nmsg.payload=msg.observation.temp;\nreturn msg;\n\n}else{\n node.warn(\"Not in the area .. candle off\")   \n}","outputs":1,"noerr":0,"x":510,"y":520,"wires":[["eab55fa9.55a508","df8d1b2a.b35578"]]},{"id":"e8467fe2.08661","type":"function","z":"6934ef1.e47ca1","name":"Create Email if > 10","func":"\nif (msg.observation.temp >10)\n{\n    msg.topic = \"SNP00 temp update\"\n    msg.payload= \"Hello from Node-RED \"+\"\\nTemperature in \"+msg.observation.obs_name +\" is \"+msg.observation.temp\n\nnode.send(msg)\n}\n//return msg;","outputs":1,"noerr":0,"x":730,"y":500,"wires":[[]]},{"id":"971cb06d.718b08","type":"inject","z":"6934ef1.e47ca1","name":"Warm","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":490,"y":500,"wires":[["e8467fe2.08661"]]},{"id":"b82d7cac.05bbb8","type":"switch","z":"6934ef1.e47ca1","name":"Switch","property":"observation.temp","propertyType":"msg","rules":[{"t":"lt","v":"10","vt":"num"},{"t":"gt","v":"18","vt":"str"},{"t":"else"}],"checkall":"true","outputs":3,"x":70,"y":660,"wires":[[],[],[]]},{"id":"2f3ce18c.49b8f6","type":"comment","z":"6934ef1.e47ca1","name":"Alternative to IFs","info":"","x":113.125,"y":588.4375,"wires":[]},{"id":"eab55fa9.55a508","type":"function","z":"5654962e.5c5de","name":"IfIss is in Area send email","func":"\n    msg.topic = \"SNP00 ISS update\"\n    msg.payload= \"Hello from Node-RED ISS is in rea\"+\"\\nTemperature in \"+msg.observation.obs_name +\" is \"+msg.observation.temp\nreturn msg;","outputs":1,"noerr":0,"x":870,"y":520,"wires":[[]]},{"id":"52166dd0.edbcac","type":"inject","z":"5654962e.5c5de","name":"Send Email","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":790,"y":580,"wires":[["eab55fa9.55a508"]]},{"id":"ac452ea.dc16a5","type":"function","z":"5654962e.5c5de","name":"SetColorOff","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":470,"y":740,"wires":[["b502cdd.3745f3"]]},{"id":"8c751cb9.f120d","type":"debug","z":"5654962e.5c5de","name":"IssiPos","active":true,"console":"false","complete":"payload","x":520,"y":300,"wires":[]},{"id":"9fb35c91.444588","type":"ui_text","z":"6934ef1.e47ca1","group":"69fb3eb5.9ba54","order":0,"width":0,"height":0,"name":"","label":"WeatherStation","format":"{{msg.observation.obs_name}}","layout":"row-spread","x":900,"y":240,"wires":[]},{"id":"f66123c6.bb9a9","type":"function","z":"27e6f3b6.413ff4","name":"FOR","func":"/* comment / describe your program */\nvar i = 1;\nvar a = 5;\n\nfor(i=0;i<10;i++)\n{\n i++;\n node.warn(\" i = \"+i);\n}\n\n\nmsg.payload = i;\nreturn msg;","outputs":1,"noerr":0,"x":310,"y":420,"wires":[["94faeb99.1ed6a"]]},{"id":"1f4a10ba.a04917","type":"function","z":"27e6f3b6.413ff4","name":"Function","func":"/* comment / describe your program */\nfunction hello(name)\n{\n\tnode.warn(\"Hello \"+name);\n}\n\nfor(i=0;i<10;i++)\n{\n   hello(\"Markus \"+i);\n}\n\nmsg.payload = i;\nreturn msg;","outputs":1,"noerr":0,"x":300,"y":540,"wires":[["e59a504c.f5baa8"]]},{"id":"c1619cd5.b0cc28","type":"function","z":"7ebfd059.b4fe1","name":"Set to 20","func":"msg.observation={}\nmsg.observation.temp = 20\nreturn msg;\n","outputs":1,"noerr":0,"x":260,"y":220,"wires":[["8533d0c5.21f39"]]},{"id":"37cfbed7.8b35e2","type":"delay","z":"5654962e.5c5de","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":200,"y":760,"wires":[["9f5b5cfe.514a18"]]},{"id":"83d6c227.842fb","type":"function","z":"5654962e.5c5de","name":"setCandleMode=Flashing","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":19,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":530,"y":660,"wires":[["b502cdd.3745f3"]]},{"id":"df8d1b2a.b35578","type":"delay","z":"5654962e.5c5de","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":500,"y":600,"wires":[["83d6c227.842fb"]]},{"id":"fcdcb211.900ad8","type":"watson-tone-analyzer-v3","z":0,"name":"Analyzse","tones":"emotion","sentences":"true","contentType":"false","x":319,"y":167.75,"wires":[["6d94490d.5edd78","a00fce33.a060a8","14db50af.ee75cf"]]},{"id":"39aabee0.dbbe42","type":"debug","z":0,"name":"","active":false,"console":"false","complete":"false","x":310,"y":222.5,"wires":[]},{"id":"37719a9b.880686","type":"debug","z":0,"name":"Tcat","active":false,"console":"true","complete":"true","x":724.5,"y":163,"wires":[]},{"id":"6d94490d.5edd78","type":"function","z":0,"name":"tone_categories","func":"\nreturn msg.payload =msg.response.document_tone.tone_categories;","outputs":1,"noerr":0,"x":546,"y":162.75,"wires":[["37719a9b.880686"]]},{"id":"a00fce33.a060a8","type":"function","z":0,"name":"HighScore","func":"var emotions = [];\nemotions = msg.response.document_tone.tone_categories\n                .filter(function(c){\n                    if (c.category_id == \"emotion_tone\")\n                    {return c; }\n                    })[0].tones;\n                    \n//rename tone_id to topic\nvar myscore =  0;     \nvar mynewmsg ={};\n//msg.payload = emotions;\nfor (var i=0; i<emotions.length; i++) {\n\n    if(emotions[i].score > myscore)\n    {\n        msg.payload = emotions[i].score;\n        msg.topic = emotions[i].tone_name;\n        myscore = emotions[i].score;\n    }\n //   node.send(msg);\n}\nmynewmsg = msg;\nreturn mynewmsg;","outputs":1,"noerr":0,"x":535.5,"y":204,"wires":[["e87f43d9.a00e9","b7094bed.0800b8"]]},{"id":"e87f43d9.a00e9","type":"debug","z":0,"name":"Score","active":true,"console":"true","complete":"payload","x":727.5,"y":206.5555419921875,"wires":[]},{"id":"f727754d.fbf818","type":"inject","z":0,"name":"Test","topic":"","payload":"Hello Your","payloadType":"str","repeat":"","crontab":"","once":false,"x":129,"y":166.25,"wires":[["fcdcb211.900ad8"]]},{"id":"f17ca1b7.4073e","type":"debug","z":0,"name":"AnaReport","active":false,"console":"true","complete":"true","x":746.5,"y":124,"wires":[]},{"id":"14db50af.ee75cf","type":"function","z":0,"name":"Ananlyser response","func":"\nreturn msg.payload =msg.response;","outputs":1,"noerr":0,"x":557.5,"y":124,"wires":[["f17ca1b7.4073e"]]},{"id":"206a1ceb.276554","type":"function","z":0,"name":"SetColorYellow-Joy","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 255,\n\"bb\" : 0,\n\"tone\" : msg.topic,   \n\"score\" : msg.payload\n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":758.5,"y":252,"wires":[["7265d62f.2d80a","e33f30b.c46655"]]},{"id":"7265d62f.2d80a","type":"ibmiot out","z":0,"authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"candle","deviceType":"macbook","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"IBM IoT","service":"registered","x":989.5,"y":301,"wires":[]},{"id":"b7094bed.0800b8","type":"switch","z":0,"name":"SelectColor","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"Joy","vt":"str"},{"t":"eq","v":"Fear","vt":"str"},{"t":"eq","v":"Sadness","vt":"str"},{"t":"eq","v":"Anger","vt":"str"},{"t":"else"}],"checkall":"true","outputs":5,"x":529,"y":275.75,"wires":[["206a1ceb.276554"],["3e1bcd2a.b4d112"],["95aaa26d.f6921"],["8cba8e11.859768"],["a17e68d8.be"]]},{"id":"3e1bcd2a.b4d112","type":"function","z":0,"name":"SetColorRed-Fear","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0,\n\"tone\" : msg.topic,   \n\"score\" : msg.payload\n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":760.5,"y":291,"wires":[["7265d62f.2d80a"]]},{"id":"8cba8e11.859768","type":"function","z":0,"name":"SetColorGreen-Anger","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0,\n\"tone\" : msg.topic,   \n\"score\" : msg.payload\n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":767.5,"y":366,"wires":[["7265d62f.2d80a"]]},{"id":"95aaa26d.f6921","type":"function","z":0,"name":"SetColorBlue-Sadness","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255,\n\"tone\" : msg.topic,   \n\"score\" : msg.payload\n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":765.5,"y":329,"wires":[["7265d62f.2d80a"]]},{"id":"e33f30b.c46655","type":"debug","z":0,"name":"","active":false,"console":"false","complete":"false","x":992.5,"y":262,"wires":[]},{"id":"a17e68d8.be","type":"function","z":0,"name":"SetColorOtherOff","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0,\n\"tone\" : msg.topic,   \n\"score\" : msg.payload\n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":757.5,"y":401,"wires":[["7265d62f.2d80a"]]},{"id":"d075af8.b01425","type":"delay","z":0,"name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":154.5,"y":294,"wires":[["fcdcb211.900ad8"]]},{"id":"cad8bc7d.6a891","type":"ibmiot in","z":"3c563f6a.498c58","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb00","applicationId":"","deviceType":"+","eventType":"BlowOnOff","commandType":"","format":"json","name":"onCandleBlowOnOFF","service":"registered","allDevices":false,"allApplications":false,"allDeviceTypes":true,"allEvents":false,"allCommands":false,"allFormats":true,"qos":"0","x":180,"y":140,"wires":[["a185f5c3.0e2788","1117e31d.b0f6fd"]]},{"id":"a185f5c3.0e2788","type":"debug","z":"3c563f6a.498c58","name":"","active":false,"console":"false","complete":"false","x":410,"y":60,"wires":[]},{"id":"9a6d4167.259da8","type":"ibmiot out","z":"3c563f6a.498c58","authentication":"quickstart","apiKey":"d5fa8c45.273dc8","outputType":"evt","deviceId":"playbulb01","deviceType":"0.17.5","eventCommandType":"setColor","format":"json","data":"payload","qos":0,"name":"playbulb01","service":"quickstart","x":890,"y":140,"wires":[]},{"id":"1904c494.3180eb","type":"function","z":"3c563f6a.498c58","name":"SetCandleOFF","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.deviceId=\"playbulb01\"\n\nmsg.CommandType=\"setColor\"\n\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":660,"y":100,"wires":[["9a6d4167.259da8"]]},{"id":"f144f138.0114e","type":"inject","z":"3c563f6a.498c58","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":620,"y":140,"wires":[["1904c494.3180eb"]]},{"id":"2dcd88b7.69048","type":"function","z":"3c563f6a.498c58","name":"SetCandleON","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmsg.deviceId=\"playbulb01\"\n\nmsg.CommandType=\"setColor\"\n\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":660,"y":200,"wires":[["9a6d4167.259da8"]]},{"id":"dda3dcf9.925e9","type":"inject","z":"3c563f6a.498c58","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":640,"y":240,"wires":[["2dcd88b7.69048"]]},{"id":"1117e31d.b0f6fd","type":"switch","z":"3c563f6a.498c58","name":"status","property":"payload.status","propertyType":"msg","rules":[{"t":"eq","v":"off","vt":"str"},{"t":"eq","v":"on","vt":"str"},{"t":"else"}],"checkall":"true","outputs":3,"x":430,"y":140,"wires":[["1904c494.3180eb"],["2dcd88b7.69048"],["ad1d44a4.c1b818"]]},{"id":"ad1d44a4.c1b818","type":"debug","z":"3c563f6a.498c58","name":"other","active":true,"console":"false","complete":"payload","x":430,"y":200,"wires":[]},{"id":"6c6904cd.82f8bc","type":"ibmiot out","z":"3c563f6a.498c58","authentication":"boundService","apiKey":"d5fa8c45.273dc8","outputType":"cmd","deviceId":"playbulb00","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"payload","qos":0,"name":"playbulb00","service":"registered","x":690,"y":360,"wires":[]},{"id":"52344498.0c5074","type":"function","z":"3c563f6a.498c58","name":"SetCandleON","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.deviceId=\"playbulb00\"\n\nmsg.CommandType=\"setColor\"\n\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":480,"y":360,"wires":[["6c6904cd.82f8bc"]]},{"id":"3d7c871f.5bc17","type":"inject","z":"3c563f6a.498c58","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":160,"y":360,"wires":[["52344498.0c5074"]]},{"id":"8168cc21.3fb888","type":"function","z":"3c563f6a.498c58","name":"SetCandleOFF","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.deviceId=\"playbulb00\"\n\nmsg.CommandType=\"setColor\"\n\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":480,"y":400,"wires":[["6c6904cd.82f8bc"]]},{"id":"ac8900fa.60704","type":"inject","z":"3c563f6a.498c58","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":160,"y":400,"wires":[["8168cc21.3fb888"]]},{"id":"f1c10443.57de","type":"ibmiot in","z":"3c563f6a.498c58","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb00","applicationId":"","deviceType":"+","eventType":"CandleColorChange","commandType":"","format":"json","name":"CandleColorChange","service":"registered","allDevices":false,"allApplications":false,"allDeviceTypes":true,"allEvents":false,"allCommands":false,"allFormats":true,"qos":"0","x":190,"y":480,"wires":[["6e370fda.eadef","5d29e734.f66ce"]]},{"id":"6e370fda.eadef","type":"debug","z":"3c563f6a.498c58","name":"onCandleColorChange","active":true,"console":"false","complete":"payload","x":560,"y":480,"wires":[]},{"id":"5d29e734.f66ce","type":"switch","z":"3c563f6a.498c58","name":"status","property":"payload.status","propertyType":"msg","rules":[{"t":"eq","v":"off","vt":"str"},{"t":"eq","v":"on","vt":"str"},{"t":"else"}],"checkall":"true","outputs":3,"x":350,"y":580,"wires":[["3909e184.210456"],["9cd4f6c.0666088"],[]]},{"id":"bba75ac6.61149","type":"ibmiot out","z":"3c563f6a.498c58","authentication":"boundService","apiKey":"4c6c3038.24319","outputType":"cmd","deviceId":"playbulb01","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"payload","qos":0,"name":"playbulb01Next","service":"registered","x":760,"y":540,"wires":[]},{"id":"3909e184.210456","type":"function","z":"3c563f6a.498c58","name":"SetCandleOFF","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.deviceId=\"playbulb01\"\n\nmsg.CommandType=\"setColor\"\n\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":540,"y":540,"wires":[["bba75ac6.61149"]]},{"id":"9cd4f6c.0666088","type":"function","z":"3c563f6a.498c58","name":"SetCandleON","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmsg.deviceId=\"playbulb01\"\n\nmsg.CommandType=\"setColor\"\n\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":540,"y":580,"wires":[["bba75ac6.61149"]]},{"id":"6497f992.4f8e98","type":"template","z":0,"name":"Space Station Tracker","field":"payload","fieldType":"msg","format":"handlebars","syntax":"plain","template":"<!DOCTYPE html>\n<html>\n    <head>\n        <title>Realtime ISS</title>\n        <meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=no\" />\n        <style type=\"text/css\">\n            html { height: 100% }\n            body { height: 100%; margin: 0; padding: 0 }\n            #map { height: 100% }\n        </style>\n        <script type=\"text/javascript\" src=\"//maps.googleapis.com/maps/api/js?key=AIzaSyAFLoXS1lPMv75OISOZ0GujwAhH1LPlJP4&sensor=false\"></script>\n        <script src=\"//googlemaps.github.io/js-map-label/src/maplabel-compiled.js\"></script>\n        <script src=\"//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js\"></script>\n        <script type=\"text/javascript\">\n            var map, marker, last_latlng;\n\n            function init() {\n                var latlng = new google.maps.LatLng(43.7081784,-79.4609571);//51.48931, -0.08819);\n                var mapOptions = { center: latlng, zoom: 2, mapTypeId: google.maps.MapTypeId.TERRAIN, //zoomControl: true, scaleControl: true}\n          \n           mapTypeControl: true,\n          mapTypeControlOptions: {\n              style: google.maps.MapTypeControlStyle.HORIZONTAL_BAR,\n              position: google.maps.ControlPosition.TOP_CENTER\n          },\n          zoomControl: true,\n          zoomControlOptions: {\n              position: google.maps.ControlPosition.LEFT_CENTER\n          },\n          scaleControl: true,\n          streetViewControl: true,\n          streetViewControlOptions: {\n              position: google.maps.ControlPosition.LEFT_TOP\n          },\n          fullscreenControl: true\n                }\n\n\n                map = new google.maps.Map(document.getElementById(\"map\"), mapOptions);\n                infoWindow = new google.maps.InfoWindow();\n                maxZoomService = new google.maps.MaxZoomService();\n              //  map.addListener('click', showMaxZoom);\n\n\n                marker = new google.maps.Marker({ position: latlng, map: map, title: \"Lat:\"+latlng, icon: 'https://raw.githubusercontent.com/picklepete/iss/master/saticon.gif' });\n    //aquator\n    \n    \n       var rectangle = new google.maps.Rectangle({\n       strokeColor: '#0000FF',\n       strokeOpacity: 0.8,\n       strokeWeight: 2,\n       fillColor: '#ffffff',\n       fillOpacity: 0.35,\n       map: map,\n       bounds: new google.maps.LatLngBounds(\n       new google.maps.LatLng(0, 90),\n       new google.maps.LatLng(0, 0))\n     });\n     \n    b1tlx= 85.03568516\n    b1tly= -150.734375\n    b1brx= -60.2679967\n    b1bry= -120.90625\n    var rectangle = new google.maps.Rectangle({\n       strokeColor: '#FF0000',\n       strokeOpacity: 0.8,\n       strokeWeight: 2,\n       fillColor: '#ffffff',\n       fillOpacity: 0.35,\n       map: map,\n       bounds: new google.maps.LatLngBounds(\n       new google.maps.LatLng(b1tlx, b1tly),\n       new google.maps.LatLng(b1brx, b1bry))\n     });\n     \n       var mapLabel = new MapLabel({\n          text: 'BOX 1',\n          position: new google.maps.LatLng(b1brx, b1bry),\n          map: map,\n          fontSize: 15,\n          align: 'top'\n        });\n     //   mapLabel.set('position', new google.maps.LatLng(34.03, -118.235));\n        \n    b2tlx= 85.03568516\n    b2tly= -100.734375\n    b2brx= -60.2679967\n    b2bry= -70.90625\n   \n  var rectangle1 = new google.maps.Rectangle({\n       strokeColor: '#FF0000',\n       strokeOpacity: 0.8,\n       strokeWeight: 2,\n       fillColor: '#ffffff',\n       fillOpacity: 0.35,\n       map: map,\n       bounds: new google.maps.LatLngBounds(\n       new google.maps.LatLng(b2tlx, b2tly),\n       new google.maps.LatLng(b2brx, b2bry))\n     });\n     \n       var mapLabel = new MapLabel({\n          text: 'BOX 2',\n          position: new google.maps.LatLng(b2brx, b2bry),\n          map: map,\n          fontSize: 15,\n          align: 'top'\n        });\n\n   \n  var rectangle2 = new google.maps.Rectangle({\n       strokeColor: '#FF0000',\n       strokeOpacity: 0.8,\n       strokeWeight: 2,\n       fillColor: '#ffffff',\n       fillOpacity: 0.35,\n       map: map,\n       bounds: new google.maps.LatLngBounds(\n       new google.maps.LatLng(85.03568516, -50.734375),\n       new google.maps.LatLng(-60.2679967,-10.90625))\n     });\n   \n       var mapLabel = new MapLabel({\n          text: 'BOX 3',\n          position: new google.maps.LatLng(-60.2679967,-10.90625),\n          map: map,\n          fontSize: 15,\n          align: 'top'\n        });\n\n\n     var rectangle3 = new google.maps.Rectangle({\n       strokeColor: '#FF0000',\n       strokeOpacity: 0.8,\n       strokeWeight: 2,\n       fillColor: '#ffffff',\n       fillOpacity: 0.35,\n       map: map,\n       bounds: new google.maps.LatLngBounds(\n       new google.maps.LatLng(85.03568516, 10),\n       new google.maps.LatLng(-60.2679967, 40))\n     });\n     \n     \n       var mapLabel = new MapLabel({\n          text: 'BOX 4',\n          position: new google.maps.LatLng(-60.2679967, 40),\n          map: map,\n          fontSize: 15,\n          align: 'top'\n        });\n\n\n          var rectangle4 = new google.maps.Rectangle({\n       strokeColor: '#FF0000',\n       strokeOpacity: 0.8,\n       strokeWeight: 2,\n       fillColor: '#ffffff',\n       fillOpacity: 0.35,\n       map: map,\n       bounds: new google.maps.LatLngBounds(\n       new google.maps.LatLng(85, 90),\n       new google.maps.LatLng(-60, 130))\n     }); \n     \n       \n       var mapLabel = new MapLabel({\n          text: 'BOX 5',\n          position: new google.maps.LatLng(-60, 130),\n          map: map,\n          fontSize: 15,\n          align: 'top'\n        });\n         \n            }\n            google.maps.event.addDomListener(window, 'load', init);\n\n\n\n           function showMaxZoom(e) {\n             maxZoomService.getMaxZoomAtLatLng(e.latLng, function(response) {\n               if (response.status !== google.maps.MaxZoomStatus.OK) {\n                 infoWindow.setContent('Error in MaxZoomService');\n               } else {\n                 infoWindow.setContent(\n                     'The maximum zoom at this location is: ' + response.zoom);\n               }\n               infoWindow.setPosition(e.latLng);\n               infoWindow.open(map);\n             });\n           }\n            function draw_flight_path(latlng) {\n                if(last_latlng == undefined) {\n                    last_latlng = latlng;\n                }\n                flight_path = new google.maps.Polyline({\n                    path: [last_latlng, latlng],\n                    strokeColor: \"#FFFF00\",\n                    strokeOpacity: 1.0,\n                    strokeWeight: 2\n                });\n                last_latlng = latlng;\n                flight_path.setMap(map);\n            };\n\n            function get_latest_position() {\n                $.getJSON('http://open-notify-api.herokuapp.com/iss-now.json?callback=?', function(data, status) {\n                    position = data.iss_position;\n var latlng = new google.maps.LatLng(position.latitude, position.longitude);\n// $.getJSON('https://api.wheretheiss.at/v1/satellites/25544/', function(data, status) {\n\n                    var latlng = new google.maps.LatLng(position.latitude, position.longitude);\n                    map.setCenter(latlng);\n                    marker.setPosition(latlng);\n                    marker.setTitle(\"Position: \"+latlng);\n                    var mycon = \"ISSI<br>Lat:\"+position.latitude+\"<br>Long\"+ position.longitude\n                    var myinfowindow = new google.maps.InfoWindow({\n                        content: mycon\n                    });\n marker.addListener('click', function() {\n    myinfowindow.open(map, marker);\n  });\n\n                    draw_flight_path(latlng);\n                    \n                });\n            };\n            setInterval(get_latest_position, 5000);\n        </script>\n    </head>\n    <body>\n        <div id=\"map\"/>\n    </body>\n</html>\n","output":"str","x":280,"y":80,"wires":[["e843479b.1bf6e"]]},{"id":"5dcdaef.2810cd","type":"http in","z":0,"name":"","url":"/iss","method":"get","upload":false,"swaggerDoc":"","x":63.5,"y":79.25,"wires":[["6497f992.4f8e98"]]},{"id":"e843479b.1bf6e","type":"http response","z":0,"name":"","statusCode":"","headers":{},"x":490,"y":80,"wires":[]},{"id":"ba373d25.7cf34","type":"http request","z":0,"name":"","method":"GET","ret":"obj","url":"http://open-notify-api.herokuapp.com/iss-now.json","tls":"","x":250,"y":160,"wires":[["a501d5e7.8edf48","5d519b9c.c8d30c","d9ea91db.ade6","3c93a124.f3ea2e"]]},{"id":"a501d5e7.8edf48","type":"debug","z":0,"name":"IssiPos","active":true,"console":"false","complete":"payload","x":240,"y":120,"wires":[]},{"id":"5a978061.d9dcc","type":"inject","z":0,"name":"","topic":"","payload":"","payloadType":"date","repeat":"10","crontab":"","once":false,"x":70,"y":160,"wires":[["ba373d25.7cf34","8e1e3ada.e163f8","9cb2a2de.19871"]]},{"id":"85af0641.9187d8","type":"ui_template","z":0,"group":"d26ced6e.7c9c9","name":"map","order":0,"width":"15","height":"11","format":"<div >\n<iframe src=\"/iss\" height=600 width=800>\n  <p>Your browser does not support iframes.</p>\n</iframe>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":490,"y":40,"wires":[[]]},{"id":"5d519b9c.c8d30c","type":"function","z":0,"name":"DisplayLat","func":"\nreturn msg;","outputs":1,"noerr":0,"x":490,"y":180,"wires":[["f456ef66.9d0d08","60819974.d846d"]]},{"id":"f456ef66.9d0d08","type":"ui_text","z":0,"group":"20bfbb42.404ad4","order":1,"width":0,"height":0,"name":"","label":"latitude","format":"{{msg.payload.iss_position.latitude}}","layout":"row-spread","x":820,"y":160,"wires":[]},{"id":"60819974.d846d","type":"ui_text","z":0,"group":"20bfbb42.404ad4","order":2,"width":0,"height":0,"name":"","label":"longitude","format":"{{msg.payload.iss_position.longitude}}","layout":"row-spread","x":680,"y":180,"wires":[]},{"id":"9d02e649.0b5058","type":"ui_gauge","z":0,"name":"","group":"daf4cba9.67cf","order":0,"width":"5","height":"3","gtype":"gage","title":"Blue","label":"units","format":"{{value}}","min":0,"max":"255","colors":["#7e959a","#6f7dc9","#530dbb"],"seg1":"","seg2":"","x":1210,"y":740,"wires":[]},{"id":"1a74ff8b.0dd278","type":"ui_gauge","z":0,"name":"","group":"daf4cba9.67cf","order":0,"width":"5","height":"3","gtype":"gage","title":"Green","label":"units","format":"{{value}}","min":0,"max":"255","colors":["#7e959a","#73bc78","#21ac1b"],"seg1":"","seg2":"","x":1210,"y":700,"wires":[]},{"id":"9a47fa50.ba189","type":"ibmiot in","z":0,"authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb00","applicationId":"","deviceType":"+","eventType":"ping","commandType":"","format":"json","name":"FromPiCandle","service":"registered","allDevices":false,"allApplications":false,"allDeviceTypes":true,"allEvents":false,"allCommands":false,"allFormats":true,"qos":"0","x":690,"y":700,"wires":[["312e8a2c.8c4536","3d6075db.2f626a","fb8fc89d.3bd798","ca4a7db3.1f5968","be265edc.5b90c8","f8b7adb5.91c52"]]},{"id":"3c93a124.f3ea2e","type":"function","z":0,"name":"CheckArea","func":"//Lat = Y Long = X\n/*\nbb is the bounding box, (ix,iy) are its top-left coordinates, and (ax,ay) its bottom-right coordinates. p is the point and (x,y) its coordinates.\n*/\nfunction checkPos(lat,lon,topleftlat,topleftlon,bottomrightlat,bottomrightlon,box)\n{\n    msg.inbox = box;\n  \n  //  node.warn(\"X topleftlon \"+topleftlon+\"  <= lon \"+lon+ \" res = \"+(   topleftlon <= lon   ))\n  //  node.warn(\"X lon \"+lon+\"  <= bottomrightlon \"+bottomrightlon+ \" res = \"+(  lon <= bottomrightlon)  )\n\nif( topleftlon <= lon && lon <= bottomrightlon ) {\n    // Point is in bounding box\n\n \n //node.warn(\" ISS in the area (\"+box+\").. candle ON\")  \nreturn true;\n\n}else{\n// node.warn(\"ISS not in the area  (\"+box+\")... candle OFF\")  \n return  false;\n\n\n}\nreturn  false;\n}\n\n \nmsg.latitude = msg.payload.iss_position.latitude;\nmsg.longitude = msg.payload.iss_position.longitude;\n\n  r0LatTl= 85\n  r0LngTl=-150\n\n  r0LatBr= -60\n  r0LngBr= -120\n\n  r1LatTl=  85\n  r1LngTl=-100.\n\n  r1LatBr= -60\n  r1LngBr= -70\n\n\n  r2LatTl=  85\n  r2LngTl= -50\n\n  r2LatBr= -60\n  r2LngBr= -10\n\n  r3LatTl=  85\n  r3LngTl= 10\n\n  r3LatBr= 85\n  r3LngBr= 40\n  \n  r4LatTl= 85\n  r4LngTl= 90\n\n  r4LatBr= -60\n  r4LngBr= 130\n\n/*\n\nlatitude\n\n-50.50472391191916\n\nlongitude\n\n-126.35910070188285\n\n\n\nlatitude = -50.5047239119191\n\nlongitude= -126.35910070188285\n\nmsg.inarea = false;\n node.warn(\"check\")\nres =checkPos(latitude ,longitude,r0LatTl,r0LngTl,r0LatBr,r0LngBr,\"box 1\");\nmsg.inarea = res;\nif(res)\n    return msg;\n  */  \n\nmsg.inarea = false;\nres =checkPos(msg.latitude ,msg.longitude,r0LatTl,r0LngTl,r0LatBr,r0LngBr,\"box1\");\nmsg.inarea = res;\nif(res)\n    return msg;\n\n\nres =checkPos(msg.latitude ,msg.longitude,r1LatTl,r1LngTl,r1LatBr,r1LngBr,\"box 2\");\nmsg.inarea = res;\nif(res)\n    return msg;\n    \n \nres =checkPos(msg.latitude ,msg.longitude,r2LatTl,r2LngTl,r2LatBr,r2LngBr,\"box 3\");\nmsg.inarea = res;\nif(res)\n    return msg;   \n\nres =checkPos(msg.latitude ,msg.longitude,r3LatTl,r3LngTl,r3LatBr,r3LngBr,\"box 4\");\nmsg.inarea = res;\nif(res)\n    return msg;   \n\n\nres =checkPos(msg.latitude ,msg.longitude,r4LatTl,r4LngTl,r4LatBr,r4LngBr,\"box 5\");\nmsg.inarea = res;\nif(res)\n    return msg; \n    \nmsg.inbox = \"No\";    \nreturn msg;","outputs":1,"noerr":0,"x":150,"y":340,"wires":[["661ab7f7.7f9ac8","1281a8c1.02bf77","7f2ff6c1.f8254"]]},{"id":"a4ecb6fd.2ae5e8","type":"function","z":0,"name":"IfIss is in Area send email","func":"\n    msg.topic = \"ISS update for YOU\"\n    msg.payload= \"Hello from Node-RED ISS is in Area with the SPEED of x Km/H and traveled  \"+global.get(\"distance\")+ \" km\";\n    return msg;","outputs":1,"noerr":0,"x":850,"y":340,"wires":[["41d642fb.c6c8ac"]]},{"id":"6b6003fb.2c0604","type":"inject","z":0,"name":"Send Email","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":850,"y":0,"wires":[["a4ecb6fd.2ae5e8"]]},{"id":"41d642fb.c6c8ac","type":"debug","z":0,"name":"email","active":false,"console":"false","complete":"true","x":1070,"y":400,"wires":[]},{"id":"d2c10582.007ee8","type":"function","z":0,"name":"setCandleMode=Flashing","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":19,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":110,"y":860,"wires":[[]]},{"id":"e2d8e6f.c2ef518","type":"delay","z":0,"name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":80,"y":500,"wires":[["95a169f6.91e69"]]},{"id":"77e00edc.3d1b9","type":"ibmiot out","z":0,"authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb00","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"toPiCandle","service":"registered","x":610,"y":500,"wires":[]},{"id":"42d6082a.772088","type":"comment","z":0,"name":"Check the Code below","info":"","x":160,"y":300,"wires":[]},{"id":"5be85f6c.741508","type":"comment","z":0,"name":"IssWebPage","info":"","x":247.22222222222217,"y":37.5,"wires":[]},{"id":"eed40b0d.bf5758","type":"comment","z":0,"name":"#2 Use Your GMAIL account","info":"","x":1140,"y":300,"wires":[]},{"id":"da799211.ce5b68","type":"inject","z":0,"name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":80,"y":540,"wires":[["95a169f6.91e69"]]},{"id":"22e2dbb9.7502dc","type":"comment","z":0,"name":"#1 Adjust the candle number","info":"","x":880,"y":440,"wires":[]},{"id":"719f3102.47b1e","type":"comment","z":0,"name":"#1 Adjust the candle number","info":"","x":700,"y":660,"wires":[]},{"id":"312e8a2c.8c4536","type":"debug","z":0,"name":"InComing","active":true,"console":"false","complete":"payload","x":680,"y":760,"wires":[]},{"id":"3d6075db.2f626a","type":"function","z":0,"name":"Red","func":"var newmsg ={}\nnewmsg.payload = msg.payload.candleRR\nnewmsg.topic =\"Red\";\nreturn newmsg;","outputs":1,"noerr":0,"x":1010,"y":660,"wires":[["624f6615.bfe0e"]]},{"id":"fb8fc89d.3bd798","type":"function","z":0,"name":"Green","func":"msg.payload = msg.payload.candleGG\nmsg.topic =\"Green\";\nreturn msg;","outputs":1,"noerr":0,"x":1010,"y":700,"wires":[["1a74ff8b.0dd278"]]},{"id":"ca4a7db3.1f5968","type":"function","z":0,"name":"Blue","func":"msg.payload = msg.payload.candleBB\nmsg.topic =\"Blue\";\nreturn msg;","outputs":1,"noerr":0,"x":1010,"y":740,"wires":[["9d02e649.0b5058"]]},{"id":"624f6615.bfe0e","type":"ui_gauge","z":0,"name":"","group":"daf4cba9.67cf","order":0,"width":"5","height":"3","gtype":"gage","title":"Red","label":"units","format":"{{value}}","min":0,"max":"255","colors":["#7e959a","#bcb489","#ac0c19"],"seg1":"","seg2":"","x":1210,"y":660,"wires":[]},{"id":"83702703.6f7e38","type":"function","z":0,"name":"setCandle=OFF","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.eventOrCommandType = \"setColor\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":420,"y":420,"wires":[["77e00edc.3d1b9","c577dac.3f15928"]]},{"id":"152d804a.e0fe28","type":"function","z":0,"name":"setCandle=Red","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.eventOrCommandType = \"setColor\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":320,"y":480,"wires":[[]]},{"id":"186cff3f.348491","type":"function","z":0,"name":"setCandle=Blue","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"setColor\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":120,"y":620,"wires":[["77e00edc.3d1b9"]]},{"id":"4db980ec.7899c8","type":"inject","z":0,"name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":80,"y":580,"wires":[["186cff3f.348491"]]},{"id":"95a169f6.91e69","type":"function","z":0,"name":"setCandle=Green","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0,\n\"who\": \"mvk00\"    \n}\nmsg.eventOrCommandType = \"setColor\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":520,"wires":[["77e00edc.3d1b9","8c1bad03.2d42c8"]]},{"id":"fe7c1394.f8f0e","type":"comment","z":0,"name":"#3 Check email text","info":"","x":830,"y":300,"wires":[]},{"id":"661ab7f7.7f9ac8","type":"switch","z":0,"name":"In Area ?","property":"inarea","propertyType":"msg","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","outputs":2,"x":340,"y":340,"wires":[["e2d8e6f.c2ef518","64467d11.cd25dc","152d804a.e0fe28","8b74f554.2720e"],["83702703.6f7e38"]]},{"id":"64467d11.cd25dc","type":"delay","z":0,"name":"","pauseType":"rate","timeout":"1","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":580,"y":340,"wires":[["a4ecb6fd.2ae5e8"]]},{"id":"c577dac.3f15928","type":"debug","z":0,"name":"Not in area","active":true,"console":"false","complete":"true","x":610,"y":420,"wires":[]},{"id":"1281a8c1.02bf77","type":"debug","z":0,"name":"Check","active":false,"console":"false","complete":"payload","x":130,"y":400,"wires":[]},{"id":"f13ead50.575b98","type":"ui_text","z":0,"group":"20bfbb42.404ad4","order":4,"width":0,"height":0,"name":"","label":"In Area?","format":"{{msg.inbox}}","layout":"row-spread","x":680,"y":260,"wires":[]},{"id":"7f2ff6c1.f8254","type":"function","z":0,"name":"InBox","func":"msg.inbox = msg.inbox.toUpperCase();\nreturn msg;","outputs":1,"noerr":0,"x":470,"y":260,"wires":[["f13ead50.575b98"]]},{"id":"e66c92ea.43ce48","type":"function","z":0,"name":"setCandle=OFF","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.eventOrCommandType = \"setColor\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":120,"y":740,"wires":[["77e00edc.3d1b9"]]},{"id":"c4cf6280.1d0358","type":"ui_button","z":0,"name":"","group":"20bfbb42.404ad4","order":6,"width":0,"height":0,"passthru":false,"label":"Turn Candle Off","color":"","bgcolor":"","icon":"","payload":"\"off\"","payloadType":"str","topic":"","x":96.875,"y":780.625,"wires":[["e66c92ea.43ce48"]]},{"id":"8b74f554.2720e","type":"debug","z":0,"name":"In Area","active":false,"console":"false","complete":"true","x":480,"y":300,"wires":[]},{"id":"83c7e6b6.baa75","type":"comment","z":0,"name":"Infos","info":"mvk@ca.ibm.com - November 2017 \nSee https://github.com/SixNationsPolytechnic/iotcandle","x":50,"y":1000,"wires":[]},{"id":"be265edc.5b90c8","type":"function","z":0,"name":"Counter","func":"var newmsg ={}\nnewmsg.payload = msg.payload.value\nreturn newmsg;","outputs":1,"noerr":0,"x":1020,"y":600,"wires":[["db723816.207f78"]]},{"id":"db723816.207f78","type":"ui_text","z":0,"group":"daf4cba9.67cf","order":5,"width":0,"height":0,"name":"","label":"Counter","format":"{{msg.payload}}","layout":"row-spread","x":1220,"y":600,"wires":[]},{"id":"d9ea91db.ade6","type":"function","z":0,"name":"Sale LatLong","func":"\nmsg.latitude = msg.payload.iss_position.latitude;\nmsg.longitude = msg.payload.iss_position.longitude;\n//msg.payload = []//\n//msg.payload =msg.latitude;\n//msg.topic=\"Lat\";\nnode.send(msg)\nmsg.topic=\"Lon\";\nmsg.payload =msg.longitude;\n//msg.payload[1] =msg.longitude;\n//\"\"+msg.latitude+\",\"+msg.longitude;\nglobal.set(\"oldlatitude\",global.get(\"latitude\"));\nglobal.set(\"oldlongitude\",global.get(\"longitude\"));\n\nglobal.set(\"latitude\",msg.latitude)\nglobal.set(\"longitude\",msg.longitude)\n\n\nreturn msg;","outputs":1,"noerr":0,"x":490,"y":140,"wires":[["46c6ed39.548b94","ff6e3185.fa535"]]},{"id":"f8b7adb5.91c52","type":"function","z":0,"name":"Time","func":"function unixTime(unixtime) {\n\n    var u = new Date(unixtime);\n\n      return u.getUTCFullYear() +\n        '-' + ('0' +( 1+ u.getUTCMonth())).slice(-2) +\n        '-' + ('0' + u.getUTCDate()).slice(-2) + \n        ' ' + ('0' + u.getUTCHours()).slice(-2) +\n        ':' + ('0' + u.getUTCMinutes()).slice(-2) +\n        ':' + ('0' + u.getUTCSeconds()).slice(-2) +\n        '.' + (u.getUTCMilliseconds() / 1000).toFixed(3).slice(2, 5) \n    };\n    var newmsg ={}\nnewmsg.payload = unixTime(parseInt(msg.payload.ts))\nreturn newmsg;","outputs":1,"noerr":0,"x":1010,"y":560,"wires":[["e015ab14.b31aa8"]]},{"id":"e015ab14.b31aa8","type":"ui_text","z":0,"group":"daf4cba9.67cf","order":5,"width":0,"height":0,"name":"","label":"Msg Time","format":"{{msg.payload}}","layout":"row-spread","x":1220,"y":560,"wires":[]},{"id":"dd06dee5.fd2ba8","type":"ui_button","z":0,"name":"","group":"20bfbb42.404ad4","order":6,"width":0,"height":0,"passthru":false,"label":"Turn Candle Blue","color":"","bgcolor":"","icon":"","payload":"\"off\"","payloadType":"str","topic":"","x":90,"y":680,"wires":[["186cff3f.348491"]]},{"id":"46c6ed39.548b94","type":"function","z":0,"name":"Distance","func":"function getDistanceFromLatLonInKm(lat1,lon1,lat2,lon2) {\n  var R = 6371; // Radius of the earth in km\n  var dLat = deg2rad(lat2-lat1);  // deg2rad below\n  var dLon = deg2rad(lon2-lon1); \n  var a = \n    Math.sin(dLat/2) * Math.sin(dLat/2) +\n    Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * \n    Math.sin(dLon/2) * Math.sin(dLon/2)\n    ; \n  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); \n  var d = R * c; // Distance in km\n  return d;\n}\n\nfunction deg2rad(deg) {\n  return deg * (Math.PI/180)\n}\nlat=global.get(\"latitude\");\nlon=global.get(\"longitude\");\nolat=global.get(\"oldlatitude\");\nolon=global.get(\"oldlongitude\");\n\n\ndistance =getDistanceFromLatLonInKm(olat,olon,lat,lon)\n//node.warn(speed)\nmsg.payload = distance.toFixed(2);\nmsg.distance = distance;\nglobal.set(\"distance\",distance);\nreturn msg;","outputs":1,"noerr":0,"x":680,"y":80,"wires":[["46f10254.6bff3c","c18ae789.ee2538"]]},{"id":"46f10254.6bff3c","type":"ui_text","z":0,"group":"20bfbb42.404ad4","order":4,"width":0,"height":0,"name":"","label":"Distance in Km( 10Sec)","format":"{{msg.payload}}","layout":"row-spread","x":930,"y":80,"wires":[]},{"id":"ff6e3185.fa535","type":"ui_chart","z":0,"name":"","group":"20bfbb42.404ad4","order":0,"width":0,"height":0,"label":"Longitude","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":"10","removeOlderPoints":"","removeOlderUnit":"60","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":2,"x":680,"y":140,"wires":[[],[]]},{"id":"18275630.54574a","type":"ui_text","z":0,"group":"20bfbb42.404ad4","order":4,"width":0,"height":0,"name":"","label":"Speed in Km/h","format":"{{msg.payload}}","layout":"row-spread","x":900,"y":40,"wires":[]},{"id":"c18ae789.ee2538","type":"function","z":0,"name":"Calulate SPEED","func":"// Home work! Calulate the speed in Km/H of the ISS\n// based on the distance \n//msg.distance = IIS traveld in 10 Sec\n\nmsg.payload = \"???\"\nreturn msg;","outputs":1,"noerr":0,"x":700,"y":40,"wires":[["18275630.54574a"]]},{"id":"4360eec2.b7e68","type":"inject","z":0,"name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":100,"y":820,"wires":[["e66c92ea.43ce48"]]},{"id":"8c1bad03.2d42c8","type":"debug","z":0,"name":"In area","active":true,"console":"false","complete":"true","x":590,"y":580,"wires":[]},{"id":"8e1e3ada.e163f8","type":"function","z":0,"name":"TS","func":"function unixTime(unixtime) {\n\n    var u = new Date(unixtime);\n\n      return u.getUTCFullYear() +\n        '-' + ('0' +( 1+ u.getUTCMonth())).slice(-2) +\n        '-' + ('0' + u.getUTCDate()).slice(-2) + \n        ' ' + ('0' + u.getUTCHours()).slice(-2) +\n        ':' + ('0' + u.getUTCMinutes()).slice(-2) +\n        ':' + ('0' + u.getUTCSeconds()).slice(-2) +\n        '.' + (u.getUTCMilliseconds() / 1000).toFixed(3).slice(2, 5) \n    };\n    var newmsg ={}\nnewmsg.payload = unixTime(msg.payload)\nreturn newmsg;","outputs":1,"noerr":0,"x":470,"y":220,"wires":[["3175b907.9a44ee"]]},{"id":"3175b907.9a44ee","type":"ui_text","z":0,"group":"20bfbb42.404ad4","order":2,"width":0,"height":0,"name":"","label":"Time","format":"{{msg.payload}}","layout":"row-spread","x":670,"y":220,"wires":[]},{"id":"9cb2a2de.19871","type":"debug","z":0,"name":"Debug","active":false,"console":"false","complete":"payload","x":90,"y":220,"wires":[]},{"id":"3652a329.38a0fc","type":"template","z":"5977a607.3e7eb","name":"Space Station Tracker","field":"payload","fieldType":"msg","format":"handlebars","syntax":"plain","template":"<!DOCTYPE html>\n<html>\n    <head>\n        <title>Realtime ISS</title>\n        <meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=no\" />\n        <style type=\"text/css\">\n            html { height: 100% }\n            body { height: 100%; margin: 0; padding: 0 }\n            #map { height: 100% }\n        </style>\n        <script type=\"text/javascript\" src=\"//maps.googleapis.com/maps/api/js?key=AIzaSyAFLoXS1lPMv75OISOZ0GujwAhH1LPlJP4&sensor=false\"></script>\n        <script src=\"//googlemaps.github.io/js-map-label/src/maplabel-compiled.js\"></script>\n        <script src=\"//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js\"></script>\n        <script type=\"text/javascript\">\n            var map, marker, last_latlng;\n\n            function init() {\n                var latlng = new google.maps.LatLng(43.7081784,-79.4609571);//51.48931, -0.08819);\n                var mapOptions = { center: latlng, zoom: 2, mapTypeId: google.maps.MapTypeId.TERRAIN, //zoomControl: true, scaleControl: true}\n          \n           mapTypeControl: true,\n          mapTypeControlOptions: {\n              style: google.maps.MapTypeControlStyle.HORIZONTAL_BAR,\n              position: google.maps.ControlPosition.TOP_CENTER\n          },\n          zoomControl: true,\n          zoomControlOptions: {\n              position: google.maps.ControlPosition.LEFT_CENTER\n          },\n          scaleControl: true,\n          streetViewControl: true,\n          streetViewControlOptions: {\n              position: google.maps.ControlPosition.LEFT_TOP\n          },\n          fullscreenControl: true\n                }\n\n\n                map = new google.maps.Map(document.getElementById(\"map\"), mapOptions);\n                infoWindow = new google.maps.InfoWindow();\n                maxZoomService = new google.maps.MaxZoomService();\n              //  map.addListener('click', showMaxZoom);\n\n\n                marker = new google.maps.Marker({ position: latlng, map: map, title: \"Lat:\"+latlng, icon: 'https://raw.githubusercontent.com/picklepete/iss/master/saticon.gif' });\n    //aquator\n    \n    \n       var rectangle = new google.maps.Rectangle({\n       strokeColor: '#0000FF',\n       strokeOpacity: 0.8,\n       strokeWeight: 2,\n       fillColor: '#ffffff',\n       fillOpacity: 0.35,\n       map: map,\n       bounds: new google.maps.LatLngBounds(\n       new google.maps.LatLng(0, 90),\n       new google.maps.LatLng(0, 0))\n     });\n     \n    b1tlx= 85.03568516\n    b1tly= -150.734375\n    b1brx= -60.2679967\n    b1bry= -120.90625\n    var rectangle = new google.maps.Rectangle({\n       strokeColor: '#FF0000',\n       strokeOpacity: 0.8,\n       strokeWeight: 2,\n       fillColor: '#ffffff',\n       fillOpacity: 0.35,\n       map: map,\n       bounds: new google.maps.LatLngBounds(\n       new google.maps.LatLng(b1tlx, b1tly),\n       new google.maps.LatLng(b1brx, b1bry))\n     });\n     \n       var mapLabel = new MapLabel({\n          text: 'BOX 1',\n          position: new google.maps.LatLng(b1brx, b1bry),\n          map: map,\n          fontSize: 15,\n          align: 'top'\n        });\n     //   mapLabel.set('position', new google.maps.LatLng(34.03, -118.235));\n        \n    b2tlx= 85.03568516\n    b2tly= -100.734375\n    b2brx= -60.2679967\n    b2bry= -70.90625\n   \n  var rectangle1 = new google.maps.Rectangle({\n       strokeColor: '#FF0000',\n       strokeOpacity: 0.8,\n       strokeWeight: 2,\n       fillColor: '#ffffff',\n       fillOpacity: 0.35,\n       map: map,\n       bounds: new google.maps.LatLngBounds(\n       new google.maps.LatLng(b2tlx, b2tly),\n       new google.maps.LatLng(b2brx, b2bry))\n     });\n     \n       var mapLabel = new MapLabel({\n          text: 'BOX 2',\n          position: new google.maps.LatLng(b2brx, b2bry),\n          map: map,\n          fontSize: 15,\n          align: 'top'\n        });\n\n   \n  var rectangle2 = new google.maps.Rectangle({\n       strokeColor: '#FF0000',\n       strokeOpacity: 0.8,\n       strokeWeight: 2,\n       fillColor: '#ffffff',\n       fillOpacity: 0.35,\n       map: map,\n       bounds: new google.maps.LatLngBounds(\n       new google.maps.LatLng(85.03568516, -50.734375),\n       new google.maps.LatLng(-60.2679967,-10.90625))\n     });\n   \n       var mapLabel = new MapLabel({\n          text: 'BOX 3',\n          position: new google.maps.LatLng(-60.2679967,-10.90625),\n          map: map,\n          fontSize: 15,\n          align: 'top'\n        });\n\n\n     var rectangle3 = new google.maps.Rectangle({\n       strokeColor: '#FF0000',\n       strokeOpacity: 0.8,\n       strokeWeight: 2,\n       fillColor: '#ffffff',\n       fillOpacity: 0.35,\n       map: map,\n       bounds: new google.maps.LatLngBounds(\n       new google.maps.LatLng(85.03568516, 10),\n       new google.maps.LatLng(-60.2679967, 40))\n     });\n     \n     \n       var mapLabel = new MapLabel({\n          text: 'BOX 4',\n          position: new google.maps.LatLng(-60.2679967, 40),\n          map: map,\n          fontSize: 15,\n          align: 'top'\n        });\n\n\n          var rectangle4 = new google.maps.Rectangle({\n       strokeColor: '#FF0000',\n       strokeOpacity: 0.8,\n       strokeWeight: 2,\n       fillColor: '#ffffff',\n       fillOpacity: 0.35,\n       map: map,\n       bounds: new google.maps.LatLngBounds(\n       new google.maps.LatLng(85, 90),\n       new google.maps.LatLng(-60, 130))\n     }); \n     \n       \n       var mapLabel = new MapLabel({\n          text: 'BOX 5',\n          position: new google.maps.LatLng(-60, 130),\n          map: map,\n          fontSize: 15,\n          align: 'top'\n        });\n         \n            }\n            google.maps.event.addDomListener(window, 'load', init);\n\n\n\n           function showMaxZoom(e) {\n             maxZoomService.getMaxZoomAtLatLng(e.latLng, function(response) {\n               if (response.status !== google.maps.MaxZoomStatus.OK) {\n                 infoWindow.setContent('Error in MaxZoomService');\n               } else {\n                 infoWindow.setContent(\n                     'The maximum zoom at this location is: ' + response.zoom);\n               }\n               infoWindow.setPosition(e.latLng);\n               infoWindow.open(map);\n             });\n           }\n            function draw_flight_path(latlng) {\n                if(last_latlng == undefined) {\n                    last_latlng = latlng;\n                }\n                flight_path = new google.maps.Polyline({\n                    path: [last_latlng, latlng],\n                    strokeColor: \"#FFFF00\",\n                    strokeOpacity: 1.0,\n                    strokeWeight: 2\n                });\n                last_latlng = latlng;\n                flight_path.setMap(map);\n            };\n\n            function get_latest_position() {\n                $.getJSON('http://open-notify-api.herokuapp.com/iss-now.json?callback=?', function(data, status) {\n                    position = data.iss_position;\n var latlng = new google.maps.LatLng(position.latitude, position.longitude);\n// $.getJSON('https://api.wheretheiss.at/v1/satellites/25544/', function(data, status) {\n\n                    var latlng = new google.maps.LatLng(position.latitude, position.longitude);\n                    map.setCenter(latlng);\n                    marker.setPosition(latlng);\n                    marker.setTitle(\"Position: \"+latlng);\n                    var mycon = \"ISSI<br>Lat:\"+position.latitude+\"<br>Long\"+ position.longitude\n                    var myinfowindow = new google.maps.InfoWindow({\n                        content: mycon\n                    });\n marker.addListener('click', function() {\n    myinfowindow.open(map, marker);\n  });\n\n                    draw_flight_path(latlng);\n                    \n                });\n            };\n            setInterval(get_latest_position, 5000);\n        </script>\n    </head>\n    <body>\n        <div id=\"map\"/>\n    </body>\n</html>\n","output":"str","x":320,"y":80,"wires":[["5c024462.a77d84"]]},{"id":"369d4d14.ecb762","type":"http in","z":"5977a607.3e7eb","name":"","url":"/iss","method":"get","upload":false,"swaggerDoc":"","x":103.5,"y":79.25,"wires":[["3652a329.38a0fc"]]},{"id":"5c024462.a77d84","type":"http response","z":"5977a607.3e7eb","name":"","statusCode":"","headers":{},"x":530,"y":80,"wires":[]},{"id":"ab985207.6243d","type":"http request","z":"5977a607.3e7eb","name":"","method":"GET","ret":"obj","url":"http://open-notify-api.herokuapp.com/iss-now.json","tls":"","x":290,"y":160,"wires":[["6167b211.0fa58c","ff362b54.412b28","72fa7d32.22d6d4","8c69eb1a.eb4928","d02da683.fb8008"]]},{"id":"6167b211.0fa58c","type":"debug","z":"5977a607.3e7eb","name":"IssiPos","active":false,"console":"false","complete":"payload","x":280,"y":120,"wires":[]},{"id":"b115a8d2.2c4e98","type":"inject","z":"5977a607.3e7eb","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":100,"y":160,"wires":[["ab985207.6243d"]]},{"id":"65edde5c.bbe92","type":"ui_template","z":"5977a607.3e7eb","group":"1950c3f1.0225b4","name":"map","order":0,"width":"15","height":"11","format":"<div >\n<iframe src=\"/iss\" height=600 width=800>\n  <p>Your browser does not support iframes.</p>\n</iframe>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":530,"y":40,"wires":[[]]},{"id":"ff362b54.412b28","type":"function","z":"5977a607.3e7eb","name":"DisplayLat","func":"\nreturn msg;","outputs":1,"noerr":0,"x":530,"y":180,"wires":[["6953c818.6f7668","cd5a6c91.bfb53"]]},{"id":"6953c818.6f7668","type":"ui_text","z":"5977a607.3e7eb","group":"e0f0bae3.d7df98","order":1,"width":0,"height":0,"name":"","label":"Latitude","format":"{{msg.payload.iss_position.latitude}}","layout":"row-spread","x":720,"y":160,"wires":[]},{"id":"cd5a6c91.bfb53","type":"ui_text","z":"5977a607.3e7eb","group":"e0f0bae3.d7df98","order":2,"width":0,"height":0,"name":"","label":"Longitude","format":"{{msg.payload.iss_position.longitude}}","layout":"row-spread","x":720,"y":200,"wires":[]},{"id":"5fd57c7e.6588bc","type":"ui_gauge","z":"5977a607.3e7eb","name":"","group":"cf8b9498.08d88","order":0,"width":"5","height":"3","gtype":"gage","title":"Blue","label":"units","format":"{{value}}","min":0,"max":"255","colors":["#7e959a","#6f7dc9","#530dbb"],"seg1":"","seg2":"","x":1250,"y":800,"wires":[]},{"id":"cc707d55.daf2e","type":"ui_gauge","z":"5977a607.3e7eb","name":"","group":"cf8b9498.08d88","order":0,"width":"5","height":"3","gtype":"gage","title":"Green","label":"units","format":"{{value}}","min":0,"max":"255","colors":["#7e959a","#73bc78","#21ac1b"],"seg1":"","seg2":"","x":1250,"y":760,"wires":[]},{"id":"8c69eb1a.eb4928","type":"function","z":"5977a607.3e7eb","name":"CheckArea","func":"//Lat = Y Long = X\n/*\nbb is the bounding box, (ix,iy) are its top-left coordinates, and (ax,ay) its bottom-right coordinates. p is the point and (x,y) its coordinates.\n*/\nfunction checkPos(lat,lon,topleftlat,topleftlon,bottomrightlat,bottomrightlon,box)\n{\n    msg.inbox = box;\n  \n  //  node.warn(\"X topleftlon \"+topleftlon+\"  <= lon \"+lon+ \" res = \"+(   topleftlon <= lon   ))\n  //  node.warn(\"X lon \"+lon+\"  <= bottomrightlon \"+bottomrightlon+ \" res = \"+(  lon <= bottomrightlon)  )\n\nif( topleftlon <= lon && lon <= bottomrightlon ) {\n    // Point is in bounding box\n\n \n //node.warn(\" ISS in the area (\"+box+\").. candle ON\")  \nreturn true;\n\n}else{\n// node.warn(\"ISS not in the area  (\"+box+\")... candle OFF\")  \n return  false;\n\n\n}\nreturn  false;\n}\n\n \nmsg.latitude = msg.payload.iss_position.latitude;\nmsg.longitude = msg.payload.iss_position.longitude;\n\n  r0LatTl= 85\n  r0LngTl=-150\n\n  r0LatBr= -60\n  r0LngBr= -120\n\n  r1LatTl=  85\n  r1LngTl=-100.\n\n  r1LatBr= -60\n  r1LngBr= -70\n\n\n  r2LatTl=  85\n  r2LngTl= -50\n\n  r2LatBr= -60\n  r2LngBr= -10\n\n  r3LatTl=  85\n  r3LngTl= 10\n\n  r3LatBr= 85\n  r3LngBr= 40\n  \n  r4LatTl= 85\n  r4LngTl= 90\n\n  r4LatBr= -60\n  r4LngBr= 130\n\n/*\n\nlatitude\n\n-50.50472391191916\n\nlongitude\n\n-126.35910070188285\n\n\n\nlatitude = -50.5047239119191\n\nlongitude= -126.35910070188285\n\nmsg.inarea = false;\n node.warn(\"check\")\nres =checkPos(latitude ,longitude,r0LatTl,r0LngTl,r0LatBr,r0LngBr,\"box 1\");\nmsg.inarea = res;\nif(res)\n    return msg;\n  */  \n\nmsg.inarea = false;\nres =checkPos(msg.latitude ,msg.longitude,r0LatTl,r0LngTl,r0LatBr,r0LngBr,\"box1\");\nmsg.inarea = res;\nif(res)\n    return msg;\n\n\nres =checkPos(msg.latitude ,msg.longitude,r1LatTl,r1LngTl,r1LatBr,r1LngBr,\"box 2\");\nmsg.inarea = res;\nif(res)\n    return msg;\n    \n \nres =checkPos(msg.latitude ,msg.longitude,r2LatTl,r2LngTl,r2LatBr,r2LngBr,\"box 3\");\nmsg.inarea = res;\nif(res)\n    return msg;   \n\nres =checkPos(msg.latitude ,msg.longitude,r3LatTl,r3LngTl,r3LatBr,r3LngBr,\"box 4\");\nmsg.inarea = res;\nif(res)\n    return msg;   \n\n\nres =checkPos(msg.latitude ,msg.longitude,r4LatTl,r4LngTl,r4LatBr,r4LngBr,\"box 5\");\nmsg.inarea = res;\nif(res)\n    return msg; \n    \nmsg.inbox = \"No\";    \nreturn msg;","outputs":1,"noerr":0,"x":190,"y":400,"wires":[["dfe44a8.276d638","53c391ec.af9288","c3c8b7ed.853128"]]},{"id":"3ee02a0e.f4b6ae","type":"function","z":"5977a607.3e7eb","name":"IfIss is in Area send email","func":"\n    msg.topic = \"ISS update for YOU\"\n    msg.payload= \"Hello from Node-RED ISS is in Area with the SPEED of x Km/H and traveled  \"+global.get(\"distance\")+ \" km\";\n    return msg;","outputs":1,"noerr":0,"x":890,"y":400,"wires":[[]]},{"id":"493ccc2b.d612e4","type":"inject","z":"5977a607.3e7eb","name":"Send Email","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":890,"y":460,"wires":[["3ee02a0e.f4b6ae"]]},{"id":"bc0438a9.3cbb5","type":"function","z":"5977a607.3e7eb","name":"setCandleMode=Flashing","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":19,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":150,"y":920,"wires":[[]]},{"id":"87699fc6.06b91","type":"delay","z":"5977a607.3e7eb","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":120,"y":560,"wires":[["c03a33f.66f485"]]},{"id":"696ae47b.51befc","type":"ibmiot out","z":"5977a607.3e7eb","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb00","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"toPiCandle","service":"registered","x":650,"y":560,"wires":[]},{"id":"4db249d9.a5b89","type":"comment","z":"5977a607.3e7eb","name":"Check the Code below","info":"","x":200,"y":360,"wires":[]},{"id":"273d1e77.33ede2","type":"comment","z":"5977a607.3e7eb","name":"IssWebPage","info":"","x":287.2222222222222,"y":37.5,"wires":[]},{"id":"eb87da3f.2d349","type":"comment","z":"5977a607.3e7eb","name":"#2 Use Your GMAIL account","info":"","x":1180,"y":360,"wires":[]},{"id":"81466e0.9b9871","type":"inject","z":"5977a607.3e7eb","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":120,"y":600,"wires":[["c03a33f.66f485"]]},{"id":"fedbd7d1.0ba19","type":"comment","z":"5977a607.3e7eb","name":"#1 Adjust the candle number","info":"","x":920,"y":500,"wires":[]},{"id":"87a62ae8.ff875","type":"comment","z":"5977a607.3e7eb","name":"#1 Adjust the candle number","info":"","x":680,"y":720,"wires":[]},{"id":"b11e3d80.a1885","type":"debug","z":"5977a607.3e7eb","name":"InComing","active":false,"console":"false","complete":"payload","x":620,"y":840,"wires":[]},{"id":"94dd34a8.ef1748","type":"function","z":"5977a607.3e7eb","name":"Red","func":"var newmsg ={}\nnewmsg.payload = msg.payload.candleRR\nnewmsg.topic =\"Red\";\nreturn newmsg;","outputs":1,"noerr":0,"x":1050,"y":720,"wires":[["98397a20.d74fa"]]},{"id":"22dcc2b3.fbd8d6","type":"function","z":"5977a607.3e7eb","name":"Green","func":"msg.payload = msg.payload.candleGG\nmsg.topic =\"Green\";\nreturn msg;","outputs":1,"noerr":0,"x":1050,"y":760,"wires":[["cc707d55.daf2e"]]},{"id":"36ba035.489a87c","type":"function","z":"5977a607.3e7eb","name":"Blue","func":"msg.payload = msg.payload.candleBB\nmsg.topic =\"Blue\";\nreturn msg;","outputs":1,"noerr":0,"x":1050,"y":800,"wires":[["5fd57c7e.6588bc"]]},{"id":"98397a20.d74fa","type":"ui_gauge","z":"5977a607.3e7eb","name":"","group":"cf8b9498.08d88","order":0,"width":"5","height":"3","gtype":"gage","title":"Red","label":"units","format":"{{value}}","min":0,"max":"255","colors":["#7e959a","#bcb489","#ac0c19"],"seg1":"","seg2":"","x":1250,"y":720,"wires":[]},{"id":"6d503ff5.b7f148","type":"function","z":"5977a607.3e7eb","name":"setCandle=OFF","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.eventOrCommandType = \"setColor\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":480,"y":480,"wires":[["696ae47b.51befc","22478d1f.d87b82"]]},{"id":"67e0eab.ebf2c94","type":"function","z":"5977a607.3e7eb","name":"setCandle=Red","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.eventOrCommandType = \"setColor\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":540,"wires":[["696ae47b.51befc"]]},{"id":"a52183db.58a25","type":"function","z":"5977a607.3e7eb","name":"setCandle=Blue","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"setColor\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":160,"y":680,"wires":[["696ae47b.51befc"]]},{"id":"d46c90fe.ec8e8","type":"inject","z":"5977a607.3e7eb","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":120,"y":640,"wires":[["a52183db.58a25"]]},{"id":"c03a33f.66f485","type":"function","z":"5977a607.3e7eb","name":"setCandle=Green","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmsg.eventOrCommandType = \"setColor\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":580,"wires":[["696ae47b.51befc"]]},{"id":"b876a379.841928","type":"comment","z":"5977a607.3e7eb","name":"#3 Check email text","info":"","x":870,"y":360,"wires":[]},{"id":"dfe44a8.276d638","type":"switch","z":"5977a607.3e7eb","name":"In Area ?","property":"inarea","propertyType":"msg","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","outputs":2,"x":380,"y":400,"wires":[["87699fc6.06b91","819f2813.4f67f","67e0eab.ebf2c94","fc0d1d8e.629b9"],["6d503ff5.b7f148"]]},{"id":"819f2813.4f67f","type":"delay","z":"5977a607.3e7eb","name":"","pauseType":"rate","timeout":"1","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":620,"y":400,"wires":[["3ee02a0e.f4b6ae"]]},{"id":"22478d1f.d87b82","type":"debug","z":"5977a607.3e7eb","name":"Not in area","active":true,"console":"false","complete":"true","x":650,"y":480,"wires":[]},{"id":"53c391ec.af9288","type":"debug","z":"5977a607.3e7eb","name":"Check","active":false,"console":"false","complete":"payload","x":170,"y":460,"wires":[]},{"id":"38ae4de.2dfeeb2","type":"ui_text","z":"5977a607.3e7eb","group":"e0f0bae3.d7df98","order":4,"width":0,"height":0,"name":"","label":"In Area?","format":"{{msg.inbox}}","layout":"row-spread","x":720,"y":320,"wires":[]},{"id":"c3c8b7ed.853128","type":"function","z":"5977a607.3e7eb","name":"InBox","func":"msg.inbox = msg.inbox.toUpperCase();\nreturn msg;","outputs":1,"noerr":0,"x":510,"y":320,"wires":[["38ae4de.2dfeeb2"]]},{"id":"4c146c79.ec58fc","type":"function","z":"5977a607.3e7eb","name":"setCandle=OFF","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.eventOrCommandType = \"setColor\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":160,"y":800,"wires":[["696ae47b.51befc"]]},{"id":"8d4372ea.ed982","type":"ui_button","z":"5977a607.3e7eb","name":"","group":"e0f0bae3.d7df98","order":6,"width":0,"height":0,"passthru":false,"label":"Turn Candle Off","color":"","bgcolor":"","icon":"","payload":"\"off\"","payloadType":"str","topic":"","x":136.875,"y":840.625,"wires":[["4c146c79.ec58fc"]]},{"id":"fc0d1d8e.629b9","type":"debug","z":"5977a607.3e7eb","name":"In Area","active":false,"console":"false","complete":"true","x":520,"y":360,"wires":[]},{"id":"f4793df9.bb232","type":"comment","z":"5977a607.3e7eb","name":"Infos","info":"mvk@ca.ibm.com - November 2017 \nSee https://github.com/SixNationsPolytechnic/iotcandle","x":90,"y":1000,"wires":[]},{"id":"3afd8d16.265ab2","type":"function","z":"5977a607.3e7eb","name":"Counter","func":"var newmsg ={}\nnewmsg.payload = msg.payload.value\nreturn newmsg;","outputs":1,"noerr":0,"x":1060,"y":660,"wires":[["4240af3e.18b4e"]]},{"id":"4240af3e.18b4e","type":"ui_text","z":"5977a607.3e7eb","group":"cf8b9498.08d88","order":5,"width":0,"height":0,"name":"","label":"Counter","format":"{{msg.payload}}","layout":"row-spread","x":1260,"y":660,"wires":[]},{"id":"72fa7d32.22d6d4","type":"function","z":"5977a607.3e7eb","name":"Sale LatLong","func":"\nmsg.latitude = msg.payload.iss_position.latitude;\nmsg.longitude = msg.payload.iss_position.longitude;\n//msg.payload = []//\n//msg.payload =msg.latitude;\n//msg.topic=\"Lat\";\nnode.send(msg)\nmsg.topic=\"Lon\";\nmsg.payload =msg.longitude;\n//msg.payload[1] =msg.longitude;\n//\"\"+msg.latitude+\",\"+msg.longitude;\nglobal.set(\"oldlatitude\",global.get(\"latitude\"));\nglobal.set(\"oldlongitude\",global.get(\"longitude\"));\n\nglobal.set(\"latitude\",msg.latitude)\nglobal.set(\"longitude\",msg.longitude)\n\n\nreturn msg;","outputs":1,"noerr":0,"x":530,"y":140,"wires":[["2f5a5e37.5a57fa","fb726036.801ba8"]]},{"id":"cf6b925f.49d9b","type":"function","z":"5977a607.3e7eb","name":"Time","func":"function unixTime(unixtime) {\n\n    var u = new Date(unixtime);\n\n      return u.getUTCFullYear() +\n        '-' + ('0' + (1+u.getUTCMonth())).slice(-2) +\n        '-' + ('0' + u.getUTCDate()).slice(-2) + \n        ' ' + ('0' + u.getUTCHours()).slice(-2) +\n        ':' + ('0' + u.getUTCMinutes()).slice(-2) +\n        ':' + ('0' + u.getUTCSeconds()).slice(-2) +\n        '.' + (u.getUTCMilliseconds() / 1000).toFixed(3).slice(2, 5) \n    };\n    var newmsg ={}\nnewmsg.payload = unixTime(parseInt(msg.payload.ts))\nreturn newmsg;","outputs":1,"noerr":0,"x":1050,"y":620,"wires":[["c23f8e99.02fe58"]]},{"id":"c23f8e99.02fe58","type":"ui_text","z":"5977a607.3e7eb","group":"cf8b9498.08d88","order":5,"width":0,"height":0,"name":"","label":"Msg Time","format":"{{msg.payload}}","layout":"row-spread","x":1260,"y":620,"wires":[]},{"id":"3c7825aa.c7882a","type":"ui_button","z":"5977a607.3e7eb","name":"","group":"e0f0bae3.d7df98","order":6,"width":0,"height":0,"passthru":false,"label":"Turn Candle Blue","color":"","bgcolor":"","icon":"","payload":"\"off\"","payloadType":"str","topic":"","x":130,"y":740,"wires":[["a52183db.58a25"]]},{"id":"2f5a5e37.5a57fa","type":"function","z":"5977a607.3e7eb","name":"Distance","func":"function getDistanceFromLatLonInKm(lat1,lon1,lat2,lon2) {\n  var R = 6371; // Radius of the earth in km\n  var dLat = deg2rad(lat2-lat1);  // deg2rad below\n  var dLon = deg2rad(lon2-lon1); \n  var a = \n    Math.sin(dLat/2) * Math.sin(dLat/2) +\n    Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * \n    Math.sin(dLon/2) * Math.sin(dLon/2)\n    ; \n  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); \n  var d = R * c; // Distance in km\n  return d;\n}\n\nfunction deg2rad(deg) {\n  return deg * (Math.PI/180)\n}\nlat=global.get(\"latitude\");\nlon=global.get(\"longitude\");\nolat=global.get(\"oldlatitude\");\nolon=global.get(\"oldlongitude\");\n\n\ndistance =getDistanceFromLatLonInKm(olat,olon,lat,lon)\n//node.warn(speed)\nmsg.payload = distance.toFixed(2);\nmsg.distance = distance;\nglobal.set(\"distance\",distance);\nreturn msg;","outputs":1,"noerr":0,"x":720,"y":80,"wires":[["d798f3f3.f7b658","de1bba7.8c426c8"]]},{"id":"d798f3f3.f7b658","type":"ui_text","z":"5977a607.3e7eb","group":"e0f0bae3.d7df98","order":4,"width":0,"height":0,"name":"","label":"Distance in Km( 10Sec)","format":"{{msg.payload}}","layout":"row-spread","x":970,"y":80,"wires":[]},{"id":"fb726036.801ba8","type":"ui_chart","z":"5977a607.3e7eb","name":"","group":"e0f0bae3.d7df98","order":0,"width":0,"height":0,"label":"Longitude","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":"10","removeOlderPoints":"","removeOlderUnit":"60","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":2,"x":727.2222222222222,"y":123.88888888888889,"wires":[[],[]]},{"id":"2eb19fe9.27b188","type":"ui_text","z":"5977a607.3e7eb","group":"e0f0bae3.d7df98","order":4,"width":0,"height":0,"name":"","label":"Speed in Km/H","format":"{{msg.payload}}","layout":"row-spread","x":940,"y":40,"wires":[]},{"id":"de1bba7.8c426c8","type":"function","z":"5977a607.3e7eb","name":"Calulate SPEED","func":"// Home work! Calulate the speed in Km/H of the ISS\n// based on the distance \n//msg.distance = IIS traveld in 10 Sec\n\nmsg.payload = \"???\"\nreturn msg;","outputs":1,"noerr":0,"x":740,"y":40,"wires":[["2eb19fe9.27b188"]]},{"id":"9a5a8848.fbbb98","type":"switch","z":"5977a607.3e7eb","name":"Filter Event","property":"topic","propertyType":"msg","rules":[{"t":"cont","v":"ping","vt":"str"},{"t":"cont","v":"onCandleColorChange","vt":"str"},{"t":"cont","v":"onCandleBlowOnOFF","vt":"str"},{"t":"else"}],"checkall":"true","outputs":4,"x":810,"y":760,"wires":[["cf6b925f.49d9b","3afd8d16.265ab2","7dd2eb98.8912dc"],["22dcc2b3.fbd8d6","36ba035.489a87c","94dd34a8.ef1748"],["94dd34a8.ef1748","22dcc2b3.fbd8d6","36ba035.489a87c"],["71a07ae2.8eca9c"]]},{"id":"89a0770c.2afc88","type":"ibmiot in","z":"5977a607.3e7eb","authentication":"boundService","apiKey":"4c6c3038.24319","inputType":"evt","deviceId":"playbulb00","applicationId":"","deviceType":"+","eventType":"+","commandType":"","format":"json","name":"fromCandle","service":"registered","allDevices":"","allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":"","qos":0,"x":630,"y":760,"wires":[["9a5a8848.fbbb98","b11e3d80.a1885","4f68e685.469318"]]},{"id":"71a07ae2.8eca9c","type":"debug","z":"5977a607.3e7eb","name":"Event","active":false,"console":"false","complete":"payload","x":810,"y":840,"wires":[]},{"id":"d02da683.fb8008","type":"function","z":"5977a607.3e7eb","name":"Time","func":"function unixTime(unixtime) {\n\n    var u = new Date(unixtime);\n//node.warn(unixtime*1000)\n      return u.getUTCFullYear() +\n        '-' + ('0' + (1+u.getUTCMonth())).slice(-2) +\n        '-' + ('0' + u.getUTCDate()).slice(-2) + \n        ' ' + ('0' + u.getUTCHours()).slice(-2) +\n        ':' + ('0' + u.getUTCMinutes()).slice(-2) +\n        ':' + ('0' + u.getUTCSeconds()).slice(-2) \n          };\n    var newmsg ={}\nnewmsg.payload = unixTime((msg.payload.timestamp*1000))\nreturn newmsg;","outputs":1,"noerr":0,"x":510,"y":240,"wires":[["523e0799.e73618"]]},{"id":"523e0799.e73618","type":"ui_text","z":"5977a607.3e7eb","group":"e0f0bae3.d7df98","order":2,"width":0,"height":0,"name":"","label":"ISS Time","format":"{{msg.payload}}","layout":"row-spread","x":720,"y":240,"wires":[]},{"id":"4f68e685.469318","type":"function","z":"5977a607.3e7eb","name":"Event","func":"return msg;","outputs":1,"noerr":0,"x":1050,"y":580,"wires":[["8bad3168.ad37a8"]]},{"id":"8bad3168.ad37a8","type":"ui_text","z":"5977a607.3e7eb","group":"cf8b9498.08d88","order":5,"width":0,"height":0,"name":"","label":"Event","format":"{{msg.payload.event}}","layout":"row-spread","x":1250,"y":580,"wires":[]},{"id":"7dd2eb98.8912dc","type":"function","z":"5977a607.3e7eb","name":"Name","func":"return msg;","outputs":1,"noerr":0,"x":1050,"y":540,"wires":[["b87c46ab.d45d5"]]},{"id":"b87c46ab.d45d5","type":"ui_text","z":"5977a607.3e7eb","group":"cf8b9498.08d88","order":5,"width":0,"height":0,"name":"","label":"Name","format":"{{msg.payload.candleName}}","layout":"row-spread","x":1250,"y":540,"wires":[]},{"id":"2ad2539c.c54084","type":"ibmiot in","z":"9549a969.6b4c68","authentication":"boundService","apiKey":"4c6c3038.24319","inputType":"evt","deviceId":"","applicationId":"","deviceType":"+","eventType":"+","commandType":"","format":"json","name":"fromCandle","service":"registered","allDevices":true,"allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":"","qos":0,"x":90,"y":120,"wires":[["2fe86803.5059a","5f8a1613.d48d1"]]},{"id":"77a96e68.156da","type":"debug","z":"9549a969.6b4c68","name":"onCandleColorChange","active":false,"console":"false","complete":"payload","x":560,"y":100,"wires":[]},{"id":"5f8a1613.d48d1","type":"switch","z":"9549a969.6b4c68","name":"Filter Event","property":"topic","propertyType":"msg","rules":[{"t":"cont","v":"ping","vt":"str"},{"t":"cont","v":"onCandleColorChange","vt":"str"},{"t":"cont","v":"onCandleBlowOnOFF","vt":"str"},{"t":"cont","v":"onCandleModeChange","vt":"str"},{"t":"else"}],"checkall":"true","outputs":5,"x":270,"y":120,"wires":[["153a03e5.8d1e44"],["77a96e68.156da","4a5056be.de642"],["e2dd5f5.2ab0aa"],["c86f0f48.825af","cd1ec4c9.bf938"],["d3375b16.60b738"]]},{"id":"79dbbf7e.4804b8","type":"ibmiot out","z":"9549a969.6b4c68","authentication":"boundService","apiKey":"4c6c3038.24319","outputType":"cmd","deviceId":"playbulb00","deviceType":"playbulb","eventCommandType":"set","format":"json","data":"payload","qos":0,"name":"ToCandle00","service":"registered","x":510,"y":460,"wires":[]},{"id":"d9afa11f.42325","type":"inject","z":"9549a969.6b4c68","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":95.5,"y":458.25,"wires":[["7517b100.efd328"]]},{"id":"7517b100.efd328","type":"function","z":"9549a969.6b4c68","name":"setCandle=Blue","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"setColor\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":300,"y":460,"wires":[["79dbbf7e.4804b8"]]},{"id":"bf91762c.807b","type":"inject","z":"9549a969.6b4c68","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":100,"y":540,"wires":[["a39b2ae9.fea508"]]},{"id":"a39b2ae9.fea508","type":"function","z":"9549a969.6b4c68","name":"setCandle=Red","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.eventOrCommandType = \"setColor\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":304.5,"y":541.75,"wires":[["79dbbf7e.4804b8"]]},{"id":"2fe86803.5059a","type":"debug","z":"9549a969.6b4c68","name":"AllCandleMsg","active":false,"console":"false","complete":"payload","x":100,"y":200,"wires":[]},{"id":"153a03e5.8d1e44","type":"debug","z":"9549a969.6b4c68","name":"ping","active":false,"console":"false","complete":"payload","x":510,"y":60,"wires":[]},{"id":"e2dd5f5.2ab0aa","type":"debug","z":"9549a969.6b4c68","name":"onCandleBlowOnOFF","active":false,"console":"false","complete":"payload","x":560,"y":140,"wires":[]},{"id":"d3375b16.60b738","type":"debug","z":"9549a969.6b4c68","name":"otherEvent","active":false,"console":"false","complete":"payload","x":290,"y":200,"wires":[]},{"id":"7a490997.e60eb","type":"function","z":"9549a969.6b4c68","name":"setCandle=RandomColor","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : Math.floor((Math.random() * 255) + 1),\n\"gg\" : Math.floor((Math.random() * 255) + 1),\n\"bb\" : Math.floor((Math.random() * 255) + 1),\n    \n}\nmsg.eventOrCommandType = \"setColor\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":620,"wires":[["79dbbf7e.4804b8"]]},{"id":"1cc5c11a.9d45af","type":"inject","z":"9549a969.6b4c68","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":100,"y":620,"wires":[["7a490997.e60eb"]]},{"id":"bd20d96.3270828","type":"function","z":"9549a969.6b4c68","name":"setCandleMode=Flashing","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":19,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":700,"wires":[["79dbbf7e.4804b8"]]},{"id":"2e4f099a.46a56e","type":"inject","z":"9549a969.6b4c68","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":100,"y":700,"wires":[["bd20d96.3270828"]]},{"id":"68b21b0d.a4dad4","type":"inject","z":"9549a969.6b4c68","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":100,"y":500,"wires":[["eda67f57.1ceb68"]]},{"id":"eda67f57.1ceb68","type":"function","z":"9549a969.6b4c68","name":"setCandle=off","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.eventOrCommandType = \"setColor\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":304.5,"y":501.75,"wires":[["79dbbf7e.4804b8"]]},{"id":"52ffbf2d.26027","type":"function","z":"9549a969.6b4c68","name":"ChangeNextCandle","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : Math.floor((Math.random() * 255) + 1),\n\"gg\" : Math.floor((Math.random() * 255) + 1),\n\"bb\" : Math.floor((Math.random() * 255) + 1),\n    \n}\nidx = parseInt (msg.deviceId.substring(8,10));\n\n\nrancan = Math.floor((Math.random() * 5) + 1), \n\nidx=idx+1;\nidxstr = (\"0\"+idx).slice(-2) \n//random candle\n//idxstr = (\"0\"+rancan).slice(-2) \n\nnode.warn(idxstr);\nmsg.deviceId=\"playbulb\"+idxstr\nmsg.eventOrCommandType = \"setColor\";\nmsg.payload=newmsg ;\nreturn msg;\n\n\n","outputs":1,"noerr":0,"x":550,"y":260,"wires":[["1403533.7c7f02d"]]},{"id":"3403ffbf.529f58","type":"ibmiot out","z":"9549a969.6b4c68","authentication":"boundService","apiKey":"4c6c3038.24319","outputType":"cmd","deviceId":"playbulb00","deviceType":"playbulb","eventCommandType":"set","format":"json","data":"payload","qos":0,"name":"toCandle","service":"registered","x":1020,"y":260,"wires":[]},{"id":"1403533.7c7f02d","type":"delay","z":"9549a969.6b4c68","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":740,"y":260,"wires":[["3403ffbf.529f58","8418acbe.bb103"]]},{"id":"8418acbe.bb103","type":"debug","z":"9549a969.6b4c68","name":"NextCandle","active":false,"console":"false","complete":"payload","x":1030,"y":220,"wires":[]},{"id":"8023eb9.2702818","type":"function","z":"9549a969.6b4c68","name":"ChangeAllCandlesRamdon","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : Math.floor((Math.random() * 255) + 1),\n\"gg\" : Math.floor((Math.random() * 255) + 1),\n\"bb\" : Math.floor((Math.random() * 255) + 1),\n    \n}\nidx = parseInt (msg.deviceId.substring(8,10));\n\n\nrancan = Math.floor((Math.random() * 5) + 1);\n//random candle\n//idxstr = (\"0\"+rancan).slice(-2) \nif(idx == 0)\n{\n    for(i=1;i<6;i++) \n    {\n        idxstr = (\"0\"+i).slice(-2) \n        node.warn(idxstr);\n        msg.deviceId=\"playbulb\"+idxstr;\n        newmsg.deviceId=\"playbulb\"+idxstr;\n        msg.eventOrCommandType = \"setColor\";\n        msg.payload=newmsg ;\n    node.send( msg);\n    }//for\n    \n}\n\n","outputs":1,"noerr":0,"x":580,"y":300,"wires":[["1989f3.9a76860d","3403ffbf.529f58"]]},{"id":"1989f3.9a76860d","type":"debug","z":"9549a969.6b4c68","name":"AllCandles","active":true,"console":"false","complete":"true","x":1030,"y":340,"wires":[]},{"id":"4a5056be.de642","type":"function","z":"9549a969.6b4c68","name":"ChangeAllCandlesSame","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : msg.payload.candleRR,\n\"gg\" : msg.payload.candleGG,\n\"bb\" : msg.payload.candleBB\n    \n}\nidx = parseInt (msg.deviceId.substring(8,10));\n\n\nrancan = Math.floor((Math.random() * 5) + 1);\n//random candle\n//idxstr = (\"0\"+rancan).slice(-2) \nif(idx == 0)\n{\n    for(i=1;i<6;i++) \n    {\n        idxstr = (\"0\"+i).slice(-2) \n        node.warn(idxstr);\n        msg.deviceId=\"playbulb\"+idxstr;\n        newmsg.deviceId=\"playbulb\"+idxstr;\n        msg.eventOrCommandType = \"setColor\";\n        msg.payload=newmsg ;\n    node.send( msg);\n    }//for\n    \n}\n\n","outputs":1,"noerr":0,"x":570,"y":340,"wires":[["3403ffbf.529f58","1989f3.9a76860d"]]},{"id":"36d43ba7.71efdc","type":"function","z":"9549a969.6b4c68","name":"setCandleMode=FlashingRandom","func":"var newmsg = {\"cmd\" : \"setCandleMode\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":2,\n\"speed1\":19,\n\"speed2\":0,\n\"rr\" : Math.floor((Math.random() * 255) + 1),\n\"gg\" : Math.floor((Math.random() * 255) + 1),\n\"bb\" : Math.floor((Math.random() * 255) + 1)\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":760,"wires":[["79dbbf7e.4804b8"]]},{"id":"473561f9.db174","type":"inject","z":"9549a969.6b4c68","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":100,"y":760,"wires":[["36d43ba7.71efdc"]]},{"id":"c86f0f48.825af","type":"debug","z":"9549a969.6b4c68","name":"onCandleModeChange","active":true,"console":"false","complete":"payload","x":570,"y":180,"wires":[]},{"id":"cd1ec4c9.bf938","type":"function","z":"9549a969.6b4c68","name":"setCandleMode=Flashing","func":"var newmsg = {\"cmd\" : \"setCandleMode\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\"  :msg.payload.modeno,\n\"speed1\":msg.payload.modes1,\n\"speed2\":msg.payload.modes2,\n\"rr\" : msg.payload.candleRR,\n\"gg\" : msg.payload.candleGG,\n\"bb\" : msg.payload.candleBB\n}\nmsg.eventOrCommandType = \"setCandleMode\";\nidx = parseInt (msg.deviceId.substring(8,10));\n\n\nrancan = Math.floor((Math.random() * 5) + 1);\n//random candle\n//idxstr = (\"0\"+rancan).slice(-2) \nif(idx == 0)\n{\n    for(i=1;i<6;i++) \n    {\n        idxstr = (\"0\"+i).slice(-2) \n        node.warn(idxstr);\n        msg.deviceId=\"playbulb\"+idxstr;\n        newmsg.deviceId=\"playbulb\"+idxstr;\n        msg.eventOrCommandType = \"setCandleMode\";\n        msg.payload=newmsg ;\n    node.send( msg);\n    }//for\n    \n}\n\n","outputs":1,"noerr":0,"x":570,"y":380,"wires":[["3403ffbf.529f58","3999cbd5.fe34c4"]]},{"id":"3999cbd5.fe34c4","type":"delay","z":"9549a969.6b4c68","name":"","pauseType":"delay","timeout":"200","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":790,"y":400,"wires":[["1989f3.9a76860d"]]},{"id":"9aa456cc.73b2b8","type":"ibmiot in","z":"fe2e5987.8efef8","authentication":"boundService","apiKey":"4c6c3038.24319","inputType":"evt","deviceId":"playbulb00","applicationId":"","deviceType":"+","eventType":"+","commandType":"","format":"json","name":"MyCandle ##","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":"","qos":0,"x":110,"y":40,"wires":[["bfcbfcd7.94fd5"]]},{"id":"bfcbfcd7.94fd5","type":"debug","z":"fe2e5987.8efef8","name":"MyCandle","active":false,"console":"false","complete":"payload","x":310,"y":40,"wires":[]},{"id":"644b98dd.782608","type":"inject","z":"fe2e5987.8efef8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":120,"y":560,"wires":[["f08b69.1d339498"]]},{"id":"f08b69.1d339498","type":"function","z":"fe2e5987.8efef8","name":"SendBilinkyBlue","func":"var newmsg = {\"cmd\" : \"blinky\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"color\": \"blue\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"blinky\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":324.5,"y":561.75,"wires":[["d3faca3.6eeef38"]]},{"id":"d3806c29.5477","type":"ibmiot in","z":"fe2e5987.8efef8","authentication":"boundService","apiKey":"4c6c3038.24319","inputType":"evt","deviceId":"playbulb01","applicationId":"","deviceType":"+","eventType":"blinky","commandType":"","format":"json","name":"AllCandles","service":"registered","allDevices":true,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":"","qos":0,"x":100,"y":180,"wires":[["f4354a8f.2bbc48","ee06a86a.417218"]]},{"id":"f4354a8f.2bbc48","type":"debug","z":"fe2e5987.8efef8","name":"Neighbour","active":false,"console":"false","complete":"payload","x":290,"y":180,"wires":[]},{"id":"a2c2a866.dfcc58","type":"function","z":"fe2e5987.8efef8","name":"setCandle=Blue","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255 //blue\n    \n}\nmymsg.eventOrCommandType = \"setColor\";\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":520,"y":340,"wires":[["7d7e6de1.d7aad4","962dc95b.1b5358"]]},{"id":"4ba77234.7e5d7c","type":"debug","z":"fe2e5987.8efef8","name":"other","active":true,"console":"false","complete":"payload","x":310,"y":340,"wires":[]},{"id":"562cde1c.641f5","type":"inject","z":"fe2e5987.8efef8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":520,"y":180,"wires":[["9e99e942.290028"]]},{"id":"7d7e6de1.d7aad4","type":"ibmiot out","z":"fe2e5987.8efef8","authentication":"boundService","apiKey":"4c6c3038.24319","outputType":"cmd","deviceId":"playbulb00","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"payload","qos":0,"name":"ToMyCandle ##","service":"registered","x":800,"y":280,"wires":[]},{"id":"5eb24da3.b93314","type":"inject","z":"fe2e5987.8efef8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":120,"y":620,"wires":[["b9344b73.d5e088"]]},{"id":"b9344b73.d5e088","type":"function","z":"fe2e5987.8efef8","name":"SendBilinky","func":"var newmsg = {\"cmd\" : \"blinky\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"color\": \"red\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"blinky\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":314.5,"y":621.75,"wires":[["d3faca3.6eeef38"]]},{"id":"962dc95b.1b5358","type":"debug","z":"fe2e5987.8efef8","name":"blue","active":true,"console":"false","complete":"payload","x":750,"y":340,"wires":[]},{"id":"867330b9.a97d2","type":"switch","z":"fe2e5987.8efef8","name":"","property":"payload.color","propertyType":"msg","rules":[{"t":"eq","v":"red","vt":"str"},{"t":"eq","v":"green","vt":"str"},{"t":"eq","v":"blue","vt":"str"},{"t":"eq","v":"off","vt":"str"},{"t":"else"}],"checkall":"true","outputs":5,"x":290,"y":280,"wires":[["131f3ef0.30baf1"],["9e99e942.290028"],["a2c2a866.dfcc58"],["47b323da.f7a5fc"],["4ba77234.7e5d7c"]]},{"id":"131f3ef0.30baf1","type":"function","z":"fe2e5987.8efef8","name":"setCandle=Red","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmymsg.eventOrCommandType = \"setColor\";\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":520,"y":260,"wires":[["7d7e6de1.d7aad4"]]},{"id":"47b323da.f7a5fc","type":"function","z":"fe2e5987.8efef8","name":"setCandle=Off","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmymsg.eventOrCommandType = \"setColor\";\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":520,"y":380,"wires":[["7d7e6de1.d7aad4"]]},{"id":"9e99e942.290028","type":"function","z":"fe2e5987.8efef8","name":"setCandle=Green","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmymsg.eventOrCommandType = \"setColor\";\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":530,"y":300,"wires":[["7d7e6de1.d7aad4"]]},{"id":"ee06a86a.417218","type":"switch","z":"fe2e5987.8efef8","name":"MyCandleBlinky ##","property":"deviceId","propertyType":"msg","rules":[{"t":"eq","v":"playbulb00","vt":"str"}],"checkall":"true","outputs":1,"x":110,"y":280,"wires":[["867330b9.a97d2","65566af3.ac4d74"]]},{"id":"bae61f34.7a521","type":"comment","z":"fe2e5987.8efef8","name":"adjust Candle #","info":"","x":100,"y":240,"wires":[]},{"id":"8d39c0e4.05102","type":"comment","z":"fe2e5987.8efef8","name":"adjust Candle #","info":"","x":800,"y":240,"wires":[]},{"id":"9b3044a2.2fd188","type":"comment","z":"fe2e5987.8efef8","name":"adjust Candle #","info":"","x":560,"y":520,"wires":[]},{"id":"65566af3.ac4d74","type":"delay","z":"fe2e5987.8efef8","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":300,"y":440,"wires":[["47b323da.f7a5fc","72d97667.0fc3c8"]]},{"id":"969adc02.0b62f","type":"ibmiot in","z":"2b716753.e93b38","authentication":"boundService","apiKey":"4c6c3038.24319","inputType":"evt","deviceId":"playbulb01","applicationId":"","deviceType":"+","eventType":"blinky","commandType":"","format":"json","name":"AllCandles","service":"registered","allDevices":true,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":"","qos":0,"x":140,"y":140,"wires":[["184666ae.caf879","432cf624.cb6808"]]},{"id":"184666ae.caf879","type":"debug","z":"2b716753.e93b38","name":"Neighbour","active":true,"console":"false","complete":"true","x":330,"y":140,"wires":[]},{"id":"a9090c49.59ce7","type":"function","z":"2b716753.e93b38","name":"setCandle=Blue","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255 //blue\n    \n}\nmymsg.eventOrCommandType = \"setColor\";\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":560,"y":440,"wires":[["e0773561.d09e18","564318b4.9b7bb8"]]},{"id":"81df5018.3d46","type":"debug","z":"2b716753.e93b38","name":"other","active":true,"console":"false","complete":"payload","x":370,"y":500,"wires":[]},{"id":"e0773561.d09e18","type":"ibmiot out","z":"2b716753.e93b38","authentication":"boundService","apiKey":"4c6c3038.24319","outputType":"cmd","deviceId":"playbulb01","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"payload","qos":0,"name":"ToMyCandle01","service":"registered","x":840,"y":380,"wires":[]},{"id":"564318b4.9b7bb8","type":"debug","z":"2b716753.e93b38","name":"Blue","active":true,"console":"false","complete":"true","x":790,"y":440,"wires":[]},{"id":"b186d2d.d21a83","type":"switch","z":"2b716753.e93b38","name":"","property":"payload.color","propertyType":"msg","rules":[{"t":"eq","v":"red","vt":"str"},{"t":"eq","v":"green","vt":"str"},{"t":"eq","v":"blue","vt":"str"},{"t":"eq","v":"off","vt":"str"},{"t":"else"}],"checkall":"true","outputs":5,"x":370,"y":440,"wires":[["1884c340.63ea9d"],["f1a1166b.377708"],["a9090c49.59ce7"],["c234161c.cafb98"],["81df5018.3d46"]]},{"id":"1884c340.63ea9d","type":"function","z":"2b716753.e93b38","name":"setCandle=Red","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmymsg.eventOrCommandType = \"setColor\";\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":560,"y":360,"wires":[["e0773561.d09e18"]]},{"id":"c234161c.cafb98","type":"function","z":"2b716753.e93b38","name":"setCandle=Off","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmymsg.eventOrCommandType = \"setColor\";\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":560,"y":480,"wires":[["e0773561.d09e18"]]},{"id":"f1a1166b.377708","type":"function","z":"2b716753.e93b38","name":"setCandle=Green","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmymsg.eventOrCommandType = \"setColor\";\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":570,"y":400,"wires":[["e0773561.d09e18"]]},{"id":"432cf624.cb6808","type":"switch","z":"2b716753.e93b38","name":"MyBlinkyMsg","property":"deviceId","propertyType":"msg","rules":[{"t":"eq","v":"playbulb01","vt":"str"}],"checkall":"true","outputs":1,"x":140,"y":440,"wires":[["b186d2d.d21a83","f37024e9.4df788","2ee24fbc.4f5c5"]]},{"id":"ed8b8ecd.683c3","type":"comment","z":"2b716753.e93b38","name":"adjust Candle #","info":"","x":140,"y":400,"wires":[]},{"id":"6bcd5b7e.51cca4","type":"comment","z":"2b716753.e93b38","name":"adjust Candle #","info":"","x":840,"y":340,"wires":[]},{"id":"83b45846.a8ea98","type":"ibmiot in","z":"2b716753.e93b38","authentication":"boundService","apiKey":"4c6c3038.24319","inputType":"evt","deviceId":"playbulb01","applicationId":"","deviceType":"+","eventType":"+","commandType":"","format":"json","name":"MyCandle ##","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":"","qos":0,"x":150,"y":40,"wires":[["85461d22.5d1ba"]]},{"id":"85461d22.5d1ba","type":"debug","z":"2b716753.e93b38","name":"MyCandle","active":false,"console":"false","complete":"payload","x":350,"y":40,"wires":[]},{"id":"f3ad5b41.d5f468","type":"ibmiot in","z":"a7f9b688.8e0ae8","authentication":"boundService","apiKey":"4c6c3038.24319","inputType":"evt","deviceId":"playbulb01","applicationId":"","deviceType":"+","eventType":"blinky","commandType":"","format":"json","name":"AllCandles","service":"registered","allDevices":true,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":"","qos":0,"x":120,"y":160,"wires":[["e3dfaf90.47363","6bef0786.cd24d8"]]},{"id":"e3dfaf90.47363","type":"debug","z":"a7f9b688.8e0ae8","name":"Messages","active":false,"console":"false","complete":"payload","x":310,"y":160,"wires":[]},{"id":"381e62e6.015bbe","type":"function","z":"a7f9b688.8e0ae8","name":"setCandle=Blue","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255 //blue\n    \n}\n\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":540,"y":320,"wires":[["b5132714.f7f7a8","c78df665.6a0ba8"]]},{"id":"f56424be.a2c5b8","type":"debug","z":"a7f9b688.8e0ae8","name":"other","active":true,"console":"false","complete":"payload","x":330,"y":360,"wires":[]},{"id":"a40ff419.da2018","type":"inject","z":"a7f9b688.8e0ae8","name":"SetGreen","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":540,"y":180,"wires":[["59def5c3.93a5dc"]]},{"id":"b5132714.f7f7a8","type":"ibmiot out","z":"a7f9b688.8e0ae8","authentication":"boundService","apiKey":"4c6c3038.24319","outputType":"cmd","deviceId":"playbulb02","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"payload","qos":0,"name":"ToMyCandle","service":"registered","x":810,"y":260,"wires":[]},{"id":"c78df665.6a0ba8","type":"debug","z":"a7f9b688.8e0ae8","name":"blue","active":true,"console":"false","complete":"true","x":770,"y":320,"wires":[]},{"id":"4576ee8d.688bc","type":"switch","z":"a7f9b688.8e0ae8","name":"","property":"payload.color","propertyType":"msg","rules":[{"t":"eq","v":"red","vt":"str"},{"t":"eq","v":"green","vt":"str"},{"t":"eq","v":"blue","vt":"str"},{"t":"eq","v":"off","vt":"str"},{"t":"else"}],"checkall":"true","outputs":5,"x":330,"y":280,"wires":[["ae1d48d9.6b7318"],["59def5c3.93a5dc"],["381e62e6.015bbe"],["2bcaf5a9.d224ea"],["f56424be.a2c5b8"]]},{"id":"ae1d48d9.6b7318","type":"function","z":"a7f9b688.8e0ae8","name":"setCandle=Red","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmymsg.eventOrCommandType = \"setColor\";\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":540,"y":240,"wires":[["b5132714.f7f7a8"]]},{"id":"2bcaf5a9.d224ea","type":"function","z":"a7f9b688.8e0ae8","name":"setCandle=Off","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmymsg.eventOrCommandType = \"setColor\";\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":540,"y":360,"wires":[["b5132714.f7f7a8"]]},{"id":"59def5c3.93a5dc","type":"function","z":"a7f9b688.8e0ae8","name":"setCandle=Green","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmymsg.eventOrCommandType = \"setColor\";\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":550,"y":280,"wires":[["b5132714.f7f7a8"]]},{"id":"6bef0786.cd24d8","type":"switch","z":"a7f9b688.8e0ae8","name":"GetMyBlinkyMsg","property":"deviceId","propertyType":"msg","rules":[{"t":"eq","v":"playbulb02","vt":"str"}],"checkall":"true","outputs":1,"x":130,"y":280,"wires":[["4576ee8d.688bc","a7cfe47d.153698","b9c45c1d.16a28"]]},{"id":"49c06194.8d246","type":"comment","z":"a7f9b688.8e0ae8","name":"adjust Candle #","info":"","x":120,"y":220,"wires":[]},{"id":"25eb8e8e.a7b632","type":"comment","z":"a7f9b688.8e0ae8","name":"adjust Candle #","info":"","x":820,"y":220,"wires":[]},{"id":"fc42d0ab.cab64","type":"ibmiot in","z":"a7f9b688.8e0ae8","authentication":"boundService","apiKey":"4c6c3038.24319","inputType":"evt","deviceId":"playbulb02","applicationId":"","deviceType":"+","eventType":"+","commandType":"","format":"json","name":"MyCandle ##","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":"","qos":0,"x":130,"y":60,"wires":[["96cb6c78.1481a"]]},{"id":"96cb6c78.1481a","type":"debug","z":"a7f9b688.8e0ae8","name":"MyCandle","active":false,"console":"false","complete":"payload","x":330,"y":60,"wires":[]},{"id":"a6bdc544.7fe8f8","type":"inject","z":"2b716753.e93b38","name":"SetGreen","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":560,"y":300,"wires":[["f1a1166b.377708"]]},{"id":"ea0384b9.3caa18","type":"debug","z":"fe2e5987.8efef8","name":"toNeighbour","active":true,"console":"false","complete":"true","x":490,"y":480,"wires":[]},{"id":"72d97667.0fc3c8","type":"function","z":"fe2e5987.8efef8","name":"setNeighour","func":"idx = parseInt (msg.deviceId.substring(8,10));\nidx=idx+1\nidxstr = (\"0\"+idx).slice(-2) \n\nmsg.deviceId=\"playbulb\"+idxstr;\n\nreturn msg;\n\n","outputs":1,"noerr":0,"x":510,"y":440,"wires":[["ea0384b9.3caa18","b8ecb1a8.61324"]]},{"id":"d3faca3.6eeef38","type":"ibmiot out","z":"fe2e5987.8efef8","authentication":"boundService","apiKey":"4c6c3038.24319","outputType":"evt","deviceId":"playbulb00","deviceType":"playbulb","eventCommandType":"blinky","format":"json","data":"payload","qos":0,"name":"MsgToNeigbour","service":"registered","x":560,"y":560,"wires":[]},{"id":"2ee24fbc.4f5c5","type":"delay","z":"2b716753.e93b38","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":220,"y":600,"wires":[["c234161c.cafb98","a582e782.5c5658"]]},{"id":"d6c799d5.347a28","type":"ibmiot out","z":"2b716753.e93b38","authentication":"boundService","apiKey":"4c6c3038.24319","outputType":"evt","deviceId":"playbulb02","deviceType":"playbulb","eventCommandType":"blinky","format":"json","data":"payload","qos":0,"name":"ToMyNeigbourToTheRight","service":"registered","x":870,"y":600,"wires":[]},{"id":"21bcc4ad.adf61c","type":"debug","z":"2b716753.e93b38","name":"toNeighbour","active":true,"console":"false","complete":"true","x":550,"y":700,"wires":[]},{"id":"61f8f851.f78968","type":"function","z":"2b716753.e93b38","name":"sendRedNeighour","func":"idx = parseInt (msg.deviceId.substring(8,10));\nidx=idx+1\nidxstr = (\"0\"+idx).slice(-2) \n\nmsg.deviceId=\"playbulb\"+idxstr;\n\n\n\nmsg.payload.color =\"red\"\n\nreturn msg;\n\n","outputs":1,"noerr":0,"x":570,"y":560,"wires":[["d6c799d5.347a28"]]},{"id":"883f727.b4b139","type":"comment","z":"2b716753.e93b38","name":"adjust Candle #","info":"","x":840,"y":540,"wires":[]},{"id":"a7cfe47d.153698","type":"debug","z":"a7f9b688.8e0ae8","name":"MyBlinkyMsg","active":false,"console":"false","complete":"payload","x":120,"y":340,"wires":[]},{"id":"f37024e9.4df788","type":"debug","z":"2b716753.e93b38","name":"FromNeighbour","active":true,"console":"false","complete":"payload","x":140,"y":480,"wires":[]},{"id":"28b74947.1e6376","type":"ibmiot in","z":"cbc03fe6.8c474","authentication":"boundService","apiKey":"4c6c3038.24319","inputType":"evt","deviceId":"playbulb01","applicationId":"","deviceType":"+","eventType":"blinky","commandType":"","format":"json","name":"AllCandles","service":"registered","allDevices":true,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":"","qos":0,"x":220,"y":160,"wires":[["c1ab2e3d.96902","65f7d36c.f7b1fc"]]},{"id":"c1ab2e3d.96902","type":"debug","z":"cbc03fe6.8c474","name":"Messages","active":false,"console":"false","complete":"payload","x":410,"y":160,"wires":[]},{"id":"2f1750df.e1ef3","type":"function","z":"cbc03fe6.8c474","name":"setCandle=Blue","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255 //blue\n    \n}\n\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":640,"y":320,"wires":[["8f12da6c.48ee08","194897b2.62c148"]]},{"id":"3e7403db.8ac9dc","type":"debug","z":"cbc03fe6.8c474","name":"other","active":true,"console":"false","complete":"payload","x":430,"y":360,"wires":[]},{"id":"ae106f2a.c3de7","type":"inject","z":"cbc03fe6.8c474","name":"SetGreen","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":640,"y":180,"wires":[["25e1fc70.0b56c4"]]},{"id":"8f12da6c.48ee08","type":"ibmiot out","z":"cbc03fe6.8c474","authentication":"boundService","apiKey":"4c6c3038.24319","outputType":"cmd","deviceId":"playbulb04","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"payload","qos":0,"name":"ToMyCandle","service":"registered","x":910,"y":260,"wires":[]},{"id":"194897b2.62c148","type":"debug","z":"cbc03fe6.8c474","name":"blue","active":true,"console":"false","complete":"true","x":870,"y":320,"wires":[]},{"id":"6cd519ca.6290a8","type":"switch","z":"cbc03fe6.8c474","name":"","property":"payload.color","propertyType":"msg","rules":[{"t":"eq","v":"red","vt":"str"},{"t":"eq","v":"green","vt":"str"},{"t":"eq","v":"blue","vt":"str"},{"t":"eq","v":"off","vt":"str"},{"t":"else"}],"checkall":"true","outputs":5,"x":430,"y":280,"wires":[["9fadcd74.b78dd"],["25e1fc70.0b56c4"],["2f1750df.e1ef3"],["aec53ce.77612c"],["3e7403db.8ac9dc"]]},{"id":"9fadcd74.b78dd","type":"function","z":"cbc03fe6.8c474","name":"setCandle=Red","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmymsg.eventOrCommandType = \"setColor\";\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":640,"y":240,"wires":[["8f12da6c.48ee08"]]},{"id":"aec53ce.77612c","type":"function","z":"cbc03fe6.8c474","name":"setCandle=Off","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmymsg.eventOrCommandType = \"setColor\";\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":640,"y":360,"wires":[["8f12da6c.48ee08"]]},{"id":"25e1fc70.0b56c4","type":"function","z":"cbc03fe6.8c474","name":"setCandle=Green","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmymsg.eventOrCommandType = \"setColor\";\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":650,"y":280,"wires":[["8f12da6c.48ee08"]]},{"id":"65f7d36c.f7b1fc","type":"switch","z":"cbc03fe6.8c474","name":"GetMyBlinkyMsg","property":"deviceId","propertyType":"msg","rules":[{"t":"eq","v":"playbulb04","vt":"str"}],"checkall":"true","outputs":1,"x":230,"y":280,"wires":[["6cd519ca.6290a8","5fd72172.7bd34","2eb729b2.b78ee6"]]},{"id":"456a6bf5.8e3ab4","type":"comment","z":"cbc03fe6.8c474","name":"adjust Candle #","info":"","x":220,"y":220,"wires":[]},{"id":"690f6ce7.4ea444","type":"comment","z":"cbc03fe6.8c474","name":"adjust Candle #","info":"","x":920,"y":220,"wires":[]},{"id":"5c5a8364.f9b21c","type":"ibmiot in","z":"cbc03fe6.8c474","authentication":"boundService","apiKey":"4c6c3038.24319","inputType":"evt","deviceId":"playbulb02","applicationId":"","deviceType":"+","eventType":"+","commandType":"","format":"json","name":"MyCandle ##","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":"","qos":0,"x":230,"y":60,"wires":[["891aced6.b074c"]]},{"id":"891aced6.b074c","type":"debug","z":"cbc03fe6.8c474","name":"MyCandle","active":false,"console":"false","complete":"payload","x":430,"y":60,"wires":[]},{"id":"5fd72172.7bd34","type":"debug","z":"cbc03fe6.8c474","name":"MyBlinkyMsg","active":false,"console":"false","complete":"payload","x":220,"y":340,"wires":[]},{"id":"52570700.4f7cb8","type":"inject","z":"cbc03fe6.8c474","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":440,"y":560,"wires":[["69afacab.f7d924"]]},{"id":"69afacab.f7d924","type":"function","z":"cbc03fe6.8c474","name":"SendBilinkyBlue","func":"var newmsg = {\"cmd\" : \"blinky\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"color\": \"blue\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"blinky\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":644.5,"y":561.75,"wires":[["8480f20a.9f813"]]},{"id":"48c8488b.0032d8","type":"inject","z":"cbc03fe6.8c474","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":440,"y":620,"wires":[["a4f7b3a4.d1979"]]},{"id":"a4f7b3a4.d1979","type":"function","z":"cbc03fe6.8c474","name":"SendBilinky","func":"var newmsg = {\"cmd\" : \"blinky\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"color\": \"red\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"blinky\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":634.5,"y":621.75,"wires":[["8480f20a.9f813"]]},{"id":"2eb729b2.b78ee6","type":"delay","z":"cbc03fe6.8c474","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":440,"y":460,"wires":[["da41ae7c.6d6d5","aec53ce.77612c"]]},{"id":"8480f20a.9f813","type":"ibmiot out","z":"cbc03fe6.8c474","authentication":"boundService","apiKey":"4c6c3038.24319","outputType":"evt","deviceId":"playbulb03","deviceType":"playbulb","eventCommandType":"blinky","format":"json","data":"payload","qos":0,"name":"ToMyNeigbourToTheRight","service":"registered","x":950,"y":460,"wires":[]},{"id":"9ebdf551.d8ccd8","type":"debug","z":"cbc03fe6.8c474","name":"toNeighbour","active":true,"console":"false","complete":"true","x":630,"y":500,"wires":[]},{"id":"da41ae7c.6d6d5","type":"function","z":"cbc03fe6.8c474","name":"setNeighour","func":"idx = parseInt (msg.deviceId.substring(8,10));\nidx=idx+1\nidxstr = (\"0\"+idx).slice(-2) \n\nmsg.deviceId=\"playbulb\"+idxstr;\n\nreturn msg;\n\n","outputs":1,"noerr":0,"x":630,"y":460,"wires":[["8480f20a.9f813","9ebdf551.d8ccd8"]]},{"id":"6fc8f4ae.03a37c","type":"comment","z":"cbc03fe6.8c474","name":"adjust Candle #","info":"","x":920,"y":420,"wires":[]},{"id":"b8ecb1a8.61324","type":"ibmiot out","z":"fe2e5987.8efef8","authentication":"boundService","apiKey":"4c6c3038.24319","outputType":"evt","deviceId":"playbulb02","deviceType":"playbulb","eventCommandType":"blinky","format":"json","data":"payload","qos":0,"name":"ToMyNeigbourToTheRight","service":"registered","x":830,"y":440,"wires":[]},{"id":"a582e782.5c5658","type":"switch","z":"2b716753.e93b38","name":"","property":"payload.color","propertyType":"msg","rules":[{"t":"eq","v":"red","vt":"str"},{"t":"eq","v":"green","vt":"str"},{"t":"eq","v":"blue","vt":"str"}],"checkall":"true","outputs":3,"x":370,"y":600,"wires":[["8ea83c60.8496e"],["cb537293.82de3"],["61f8f851.f78968"]]},{"id":"cb537293.82de3","type":"function","z":"2b716753.e93b38","name":"sendGreenNeighour","func":"idx = parseInt (msg.deviceId.substring(8,10));\nidx=idx+1\nidxstr = (\"0\"+idx).slice(-2) \n\nmsg.deviceId=\"playbulb\"+idxstr;\n\n\nmsg.payload.color =\"green\"\n\nreturn msg;\n\n","outputs":1,"noerr":0,"x":580,"y":600,"wires":[["d6c799d5.347a28","21bcc4ad.adf61c"]]},{"id":"8ea83c60.8496e","type":"function","z":"2b716753.e93b38","name":"sendBlueNeighour","func":"idx = parseInt (msg.deviceId.substring(8,10));\nidx=idx+1\nidxstr = (\"0\"+idx).slice(-2) \n\nmsg.deviceId=\"playbulb\"+idxstr;\n\nmsg.payload.color = \"blue\"\n\nreturn msg;\n\n","outputs":1,"noerr":0,"x":570,"y":640,"wires":[["d6c799d5.347a28"]]},{"id":"7259603.ae0f4a","type":"function","z":"2b716753.e93b38","name":"SendBilinkyBlue","func":"var newmsg = {\"cmd\" : \"blinky\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"color\": \"blue\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.deviceId =\"playbub01\"\nmsg.eventOrCommandType = \"blinky\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":200,"y":700,"wires":[["a582e782.5c5658"]]},{"id":"eac4cbe6.987ab8","type":"inject","z":"2b716753.e93b38","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":200,"y":660,"wires":[["7259603.ae0f4a"]]},{"id":"b9c45c1d.16a28","type":"delay","z":"a7f9b688.8e0ae8","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":220,"y":480,"wires":[["b56d47e2.0933c8","2bcaf5a9.d224ea"]]},{"id":"92dcef33.effb8","type":"ibmiot out","z":"a7f9b688.8e0ae8","authentication":"boundService","apiKey":"4c6c3038.24319","outputType":"evt","deviceId":"playbulb02","deviceType":"playbulb","eventCommandType":"blinky","format":"json","data":"payload","qos":0,"name":"ToMyNeigbourToTheRight","service":"registered","x":870,"y":480,"wires":[]},{"id":"98b4a484.cc6028","type":"debug","z":"a7f9b688.8e0ae8","name":"toNeighbour","active":true,"console":"false","complete":"true","x":550,"y":580,"wires":[]},{"id":"56b541de.f4b21","type":"function","z":"a7f9b688.8e0ae8","name":"sendRedNeighour","func":"idx = parseInt (msg.deviceId.substring(8,10));\nidx=idx+1\nidxstr = (\"0\"+idx).slice(-2) \n\nmsg.deviceId=\"playbulb\"+idxstr;\n\n\n\nmsg.payload.color =\"red\"\n\nreturn msg;\n\n","outputs":1,"noerr":0,"x":570,"y":440,"wires":[["92dcef33.effb8"]]},{"id":"fcd9f285.9d029","type":"comment","z":"a7f9b688.8e0ae8","name":"adjust Candle #","info":"","x":840,"y":420,"wires":[]},{"id":"b56d47e2.0933c8","type":"switch","z":"a7f9b688.8e0ae8","name":"","property":"payload.color","propertyType":"msg","rules":[{"t":"eq","v":"red","vt":"str"},{"t":"eq","v":"green","vt":"str"},{"t":"eq","v":"blue","vt":"str"}],"checkall":"true","outputs":3,"x":370,"y":480,"wires":[["63325c3d.1dee04"],["77ad497c.0d7cc8"],["56b541de.f4b21"]]},{"id":"77ad497c.0d7cc8","type":"function","z":"a7f9b688.8e0ae8","name":"sendGreenNeighour","func":"idx = parseInt (msg.deviceId.substring(8,10));\nidx=idx+1\nidxstr = (\"0\"+idx).slice(-2) \n\nmsg.deviceId=\"playbulb\"+idxstr;\n\n\nmsg.payload.color =\"green\"\n\nreturn msg;\n\n","outputs":1,"noerr":0,"x":580,"y":480,"wires":[["92dcef33.effb8","98b4a484.cc6028"]]},{"id":"63325c3d.1dee04","type":"function","z":"a7f9b688.8e0ae8","name":"sendBlueNeighour","func":"idx = parseInt (msg.deviceId.substring(8,10));\nidx=idx+1\nidxstr = (\"0\"+idx).slice(-2) \n\nmsg.deviceId=\"playbulb\"+idxstr;\n\nmsg.payload.color = \"blue\"\n\nreturn msg;\n\n","outputs":1,"noerr":0,"x":570,"y":520,"wires":[["92dcef33.effb8"]]},{"id":"4c7e6cbc.192514","type":"function","z":"a7f9b688.8e0ae8","name":"SendBilinkyBlue","func":"var newmsg = {\"cmd\" : \"blinky\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"color\": \"blue\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.deviceId =\"playbub01\"\nmsg.eventOrCommandType = \"blinky\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":200,"y":580,"wires":[["b56d47e2.0933c8"]]},{"id":"37f1231.4c2c4dc","type":"inject","z":"a7f9b688.8e0ae8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":200,"y":540,"wires":[["4c7e6cbc.192514"]]},{"id":"4e1fca2a.eb3644","type":"ibmiot in","z":"40fc550d.ce2a0c","authentication":"boundService","apiKey":"4c6c3038.24319","inputType":"evt","deviceId":"playbulb01","applicationId":"","deviceType":"+","eventType":"blinky","commandType":"","format":"json","name":"AllCandles","service":"registered","allDevices":true,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":"","qos":0,"x":120,"y":160,"wires":[["4b28cc38.d6d594","540c9bbd.433a64"]]},{"id":"4b28cc38.d6d594","type":"debug","z":"40fc550d.ce2a0c","name":"Messages","active":false,"console":"false","complete":"payload","x":310,"y":160,"wires":[]},{"id":"abc0d5a3.9586a8","type":"function","z":"40fc550d.ce2a0c","name":"setCandle=Blue","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255 //blue\n    \n}\n\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":540,"y":320,"wires":[["f7be438c.381fc","a3ff3803.b6f188"]]},{"id":"2a2c7e9a.378c12","type":"debug","z":"40fc550d.ce2a0c","name":"other","active":true,"console":"false","complete":"payload","x":330,"y":360,"wires":[]},{"id":"5abb5876.e1b8d8","type":"inject","z":"40fc550d.ce2a0c","name":"SetGreen","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":540,"y":180,"wires":[["2340ea65.74f166"]]},{"id":"f7be438c.381fc","type":"ibmiot out","z":"40fc550d.ce2a0c","authentication":"boundService","apiKey":"4c6c3038.24319","outputType":"cmd","deviceId":"playbulb03","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"payload","qos":0,"name":"ToMyCandle","service":"registered","x":810,"y":260,"wires":[]},{"id":"a3ff3803.b6f188","type":"debug","z":"40fc550d.ce2a0c","name":"blue","active":true,"console":"false","complete":"true","x":770,"y":320,"wires":[]},{"id":"5fcb9d12.cfc454","type":"switch","z":"40fc550d.ce2a0c","name":"","property":"payload.color","propertyType":"msg","rules":[{"t":"eq","v":"red","vt":"str"},{"t":"eq","v":"green","vt":"str"},{"t":"eq","v":"blue","vt":"str"},{"t":"eq","v":"off","vt":"str"},{"t":"else"}],"checkall":"true","outputs":5,"x":330,"y":280,"wires":[["d12461c6.7c00e"],["2340ea65.74f166"],["abc0d5a3.9586a8"],["a585a3c6.cb3a5"],["2a2c7e9a.378c12"]]},{"id":"d12461c6.7c00e","type":"function","z":"40fc550d.ce2a0c","name":"setCandle=Red","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmymsg.eventOrCommandType = \"setColor\";\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":540,"y":240,"wires":[["f7be438c.381fc"]]},{"id":"a585a3c6.cb3a5","type":"function","z":"40fc550d.ce2a0c","name":"setCandle=Off","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmymsg.eventOrCommandType = \"setColor\";\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":540,"y":360,"wires":[["f7be438c.381fc"]]},{"id":"2340ea65.74f166","type":"function","z":"40fc550d.ce2a0c","name":"setCandle=Green","func":"var mymsg={}\nmymsg.payload ={}\nvar newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmymsg.eventOrCommandType = \"setColor\";\nmymsg.payload=newmsg ;\nreturn mymsg;","outputs":1,"noerr":0,"x":550,"y":280,"wires":[["f7be438c.381fc"]]},{"id":"540c9bbd.433a64","type":"switch","z":"40fc550d.ce2a0c","name":"GetMyBlinkyMsg","property":"deviceId","propertyType":"msg","rules":[{"t":"eq","v":"playbulb03","vt":"str"}],"checkall":"true","outputs":1,"x":130,"y":280,"wires":[["5fcb9d12.cfc454","bad9b977.9f3808","5d03f479.025ebc"]]},{"id":"da06561d.5a3f88","type":"comment","z":"40fc550d.ce2a0c","name":"adjust Candle #","info":"","x":120,"y":220,"wires":[]},{"id":"affcbb20.f0aaa8","type":"comment","z":"40fc550d.ce2a0c","name":"adjust Candle #","info":"","x":820,"y":220,"wires":[]},{"id":"a293879e.babd18","type":"ibmiot in","z":"40fc550d.ce2a0c","authentication":"boundService","apiKey":"4c6c3038.24319","inputType":"evt","deviceId":"playbulb02","applicationId":"","deviceType":"+","eventType":"+","commandType":"","format":"json","name":"MyCandle ##","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":"","qos":0,"x":130,"y":60,"wires":[["9aeeed1b.b6bd9"]]},{"id":"9aeeed1b.b6bd9","type":"debug","z":"40fc550d.ce2a0c","name":"MyCandle","active":false,"console":"false","complete":"payload","x":330,"y":60,"wires":[]},{"id":"bad9b977.9f3808","type":"debug","z":"40fc550d.ce2a0c","name":"MyBlinkyMsg","active":false,"console":"false","complete":"payload","x":120,"y":340,"wires":[]},{"id":"5d03f479.025ebc","type":"delay","z":"40fc550d.ce2a0c","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":220,"y":480,"wires":[["dc85f25e.c6036","a585a3c6.cb3a5"]]},{"id":"5764f781.2bad18","type":"ibmiot out","z":"40fc550d.ce2a0c","authentication":"boundService","apiKey":"4c6c3038.24319","outputType":"evt","deviceId":"playbulb04","deviceType":"playbulb","eventCommandType":"blinky","format":"json","data":"payload","qos":0,"name":"ToMyNeigbourToTheRight","service":"registered","x":870,"y":480,"wires":[]},{"id":"611b2acc.f2ebf4","type":"debug","z":"40fc550d.ce2a0c","name":"toNeighbour","active":true,"console":"false","complete":"true","x":550,"y":580,"wires":[]},{"id":"a139ef54.143f4","type":"function","z":"40fc550d.ce2a0c","name":"sendRedNeighour","func":"idx = parseInt (msg.deviceId.substring(8,10));\nidx=idx+1\nidxstr = (\"0\"+idx).slice(-2) \n\nmsg.deviceId=\"playbulb\"+idxstr;\n\n\n\nmsg.payload.color =\"red\"\n\nreturn msg;\n\n","outputs":1,"noerr":0,"x":570,"y":440,"wires":[["5764f781.2bad18"]]},{"id":"4dbd8a5b.044e34","type":"comment","z":"40fc550d.ce2a0c","name":"adjust Candle #","info":"","x":840,"y":420,"wires":[]},{"id":"dc85f25e.c6036","type":"switch","z":"40fc550d.ce2a0c","name":"","property":"payload.color","propertyType":"msg","rules":[{"t":"eq","v":"red","vt":"str"},{"t":"eq","v":"green","vt":"str"},{"t":"eq","v":"blue","vt":"str"}],"checkall":"true","outputs":3,"x":370,"y":480,"wires":[["73d2ec3f.49a6d4"],["310bdb41.545bc4"],["a139ef54.143f4"]]},{"id":"310bdb41.545bc4","type":"function","z":"40fc550d.ce2a0c","name":"sendGreenNeighour","func":"idx = parseInt (msg.deviceId.substring(8,10));\nidx=idx+1\nidxstr = (\"0\"+idx).slice(-2) \n\nmsg.deviceId=\"playbulb\"+idxstr;\n\n\nmsg.payload.color =\"green\"\n\nreturn msg;\n\n","outputs":1,"noerr":0,"x":580,"y":480,"wires":[["5764f781.2bad18","611b2acc.f2ebf4"]]},{"id":"73d2ec3f.49a6d4","type":"function","z":"40fc550d.ce2a0c","name":"sendBlueNeighour","func":"idx = parseInt (msg.deviceId.substring(8,10));\nidx=idx+1\nidxstr = (\"0\"+idx).slice(-2) \n\nmsg.deviceId=\"playbulb\"+idxstr;\n\nmsg.payload.color = \"blue\"\n\nreturn msg;\n\n","outputs":1,"noerr":0,"x":570,"y":520,"wires":[["5764f781.2bad18"]]},{"id":"9dc446bd.807cd8","type":"function","z":"40fc550d.ce2a0c","name":"SendBilinkyBlue","func":"var newmsg = {\"cmd\" : \"blinky\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":0,\n\"speed2\":0,\n\"color\": \"blue\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.deviceId =\"playbub01\"\nmsg.eventOrCommandType = \"blinky\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":200,"y":580,"wires":[["dc85f25e.c6036"]]},{"id":"6dd2577a.610998","type":"inject","z":"40fc550d.ce2a0c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":200,"y":540,"wires":[["9dc446bd.807cd8"]]},{"id":"4f267752.eb84b","type":"ui_text","z":"4b61f53d.4e7d24","group":"7b96dd88.919304","order":3,"width":0,"height":0,"name":"","label":"event","format":"{{msg.payload.event}}","layout":"row-spread","x":330,"y":180,"wires":[]},{"id":"aea302e7.63965","type":"function","z":"4b61f53d.4e7d24","name":"candleBB","func":"return {payload:msg.payload.candleBB};","outputs":1,"noerr":0,"x":880,"y":220,"wires":[["b8b0a63.bdfbf58"]]},{"id":"1f7b1707.1daa51","type":"ui_gauge","z":"4b61f53d.4e7d24","name":"","group":"6f7fb2b3.bc0454","order":0,"width":0,"height":0,"gtype":"gage","title":"Green","label":"units","format":"{{value}}","min":0,"max":"255","colors":["#7e959a","#bcb489","#ac0c19"],"seg1":"","seg2":"","x":1050,"y":160,"wires":[]},{"id":"934e7120.f882b8","type":"function","z":"4b61f53d.4e7d24","name":"SetColor","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : msg.payload.r,\n\"gg\" : msg.payload.g,\n\"bb\" : msg.payload.b,\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":560,"y":580,"wires":[["6bf1f34d.2a2fd4"]]},{"id":"b68252c3.ac8af","type":"ui_button","z":"4b61f53d.4e7d24","name":"","group":"7403572f.6947f","order":0,"width":0,"height":0,"passthru":false,"label":"Set Candle to Green","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":180,"y":400,"wires":[["56aee1b8.76edd"]]},{"id":"56aee1b8.76edd","type":"function","z":"4b61f53d.4e7d24","name":"SetColorGreen","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":440,"y":400,"wires":[["6bf1f34d.2a2fd4"]]},{"id":"caa0b00d.2c36","type":"comment","z":"cee0583a.5d0b6","name":"Change the deviceID ","info":"","x":180,"y":80,"wires":[]},{"id":"b3b1afed.33de88","type":"comment","z":"cce2ce51.a5c9b","name":"Change the deviceID ","info":"","x":160,"y":80,"wires":[]},{"id":"769145c4.f83bfc","type":"comment","z":"3e1bffeb.8b3528","name":"Change the deviceID ","info":"","x":160,"y":60,"wires":[]},{"id":"a508e1.0173072","type":"ui_button","z":"4b61f53d.4e7d24","name":"","group":"7403572f.6947f","order":0,"width":0,"height":0,"passthru":false,"label":"Set Candle to Blue","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":190,"y":440,"wires":[["1ce42ca.fe4cbd3"]]},{"id":"1ce42ca.fe4cbd3","type":"function","z":"4b61f53d.4e7d24","name":"SetColorBlue","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":430,"y":440,"wires":[["6bf1f34d.2a2fd4"]]},{"id":"37c00a7b.98d82e","type":"comment","z":"4b61f53d.4e7d24","name":"Change the deviceID ","info":"","x":180,"y":80,"wires":[]},{"id":"761a89f5.1e3a68","type":"ui_button","z":"4b61f53d.4e7d24","name":"","group":"beb9f71b.54e748","order":0,"width":0,"height":0,"passthru":false,"label":"Turn Off Candle","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":200,"y":480,"wires":[["48880986.9d5e5"]]},{"id":"48880986.9d5e5","type":"function","z":"4b61f53d.4e7d24","name":"SetColorNone","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":440,"y":480,"wires":[[]]},{"id":"51025d1.b3a5724","type":"ibmiot in","z":"62270d87.6a8a3c","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb00","applicationId":"","deviceType":"+","eventType":"ping","commandType":"","format":"json","name":"FromPiCandle","service":"registered","allDevices":false,"allApplications":false,"allDeviceTypes":true,"allEvents":true,"allCommands":false,"allFormats":true,"qos":"0","x":150,"y":160,"wires":[["a5f547b1.652dd","ac72b789.758a98"]]},{"id":"a5f547b1.652dd","type":"debug","z":"62270d87.6a8a3c","name":"","active":false,"console":"false","complete":"false","x":171.5,"y":250.5,"wires":[]},{"id":"8a3be3e9.3eee6","type":"comment","z":"62270d87.6a8a3c","name":"GetDataFromPiCandle","info":"","x":173,"y":75.75,"wires":[]},{"id":"fdc5ec04.dc59a8","type":"debug","z":"62270d87.6a8a3c","name":"ping","active":true,"console":"false","complete":"payload","x":630,"y":100,"wires":[]},{"id":"89434f73.8100c8","type":"comment","z":"62270d87.6a8a3c","name":"Change the deviceID ","info":"","x":173,"y":115.75,"wires":[]},{"id":"ac72b789.758a98","type":"switch","z":"62270d87.6a8a3c","name":"Events","property":"payload.event","propertyType":"msg","rules":[{"t":"eq","v":"ping","vt":"str"},{"t":"eq","v":"onCandleColorChange","vt":"str"},{"t":"eq","v":"onCandleModeChange","vt":"str"},{"t":"eq","v":"onCandleBlowOnOFF","vt":"str"},{"t":"else"}],"checkall":"true","outputs":5,"x":410,"y":160,"wires":[["fdc5ec04.dc59a8"],["87abfd8a.0edb5"],["2726a484.f4a6ac"],["d9d2c28.d956bc"],["38c57136.a2b6d6"]]},{"id":"38c57136.a2b6d6","type":"debug","z":"62270d87.6a8a3c","name":"other","active":false,"console":"false","complete":"payload","x":630,"y":300,"wires":[]},{"id":"87abfd8a.0edb5","type":"debug","z":"62270d87.6a8a3c","name":"onCandleColorChange","active":true,"console":"false","complete":"payload","x":680,"y":140,"wires":[]},{"id":"d9d2c28.d956bc","type":"debug","z":"62270d87.6a8a3c","name":"onCandleBlowOnOFF","active":false,"console":"false","complete":"payload","x":680,"y":220,"wires":[]},{"id":"2726a484.f4a6ac","type":"debug","z":"62270d87.6a8a3c","name":"onCandleModeChange","active":false,"console":"false","complete":"payload","x":690,"y":180,"wires":[]},{"id":"2c416713.f521e8","type":"ibmiot out","z":"62270d87.6a8a3c","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb00","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"toPiCandle","service":"registered","x":770,"y":440,"wires":[]},{"id":"95d1b61e.4062b","type":"inject","z":"62270d87.6a8a3c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":160,"y":540,"wires":[["f0015a16.bf76a"]]},{"id":"f0015a16.bf76a","type":"function","z":"62270d87.6a8a3c","name":"SetColorRed","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":540,"wires":[["2c416713.f521e8","4d4fb001.fabce8"]]},{"id":"4d4fb001.fabce8","type":"debug","z":"62270d87.6a8a3c","name":"","active":false,"console":"false","complete":"false","x":770,"y":520,"wires":[]},{"id":"558d7e06.3de918","type":"function","z":"62270d87.6a8a3c","name":"setModeCandleLight","func":"var newmsg = {\"cmd\" : \"setcolor\",\n// mode =01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":\"1\",\n\"speed1\":0,\n\"speed2\":255,\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":400,"y":340,"wires":[["2c416713.f521e8"]]},{"id":"a50317d5.8a4c2","type":"comment","z":"62270d87.6a8a3c","name":"Candle Modes","info":"01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect","x":180,"y":291,"wires":[]},{"id":"d98a593f.f4dcc","type":"comment","z":"62270d87.6a8a3c","name":"SetCandleColors","info":"01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect","x":160,"y":480,"wires":[]},{"id":"5df8a4a6.e2ae7c","type":"inject","z":"62270d87.6a8a3c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":180,"y":340,"wires":[["558d7e06.3de918"]]},{"id":"75d6b9f9.e34c38","type":"function","z":"62270d87.6a8a3c","name":"setCandleMode=Flashing","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00 7e ff 00 00 00 19 00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":0,\n\"speed1\":19,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":410,"y":380,"wires":[["2c416713.f521e8"]]},{"id":"bf151e84.1a1fb","type":"inject","z":"62270d87.6a8a3c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":160,"y":378,"wires":[["75d6b9f9.e34c38"]]},{"id":"4f631709.d9a158","type":"function","z":"62270d87.6a8a3c","name":"setCandleMode=Rainbow","func":"var newmsg = {\"cmd\" : \"setcolor\",\n//00ff00ff 02 00 5f00\"\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":02,\n\"speed1\":95,\n\"speed2\":0,\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":410,"y":440,"wires":[["2c416713.f521e8","4d4fb001.fabce8"]]},{"id":"d09d6feb.16712","type":"inject","z":"62270d87.6a8a3c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":160,"y":440,"wires":[["4f631709.d9a158"]]},{"id":"fc8e7159.23bd3","type":"function","z":"62270d87.6a8a3c","name":"SetColorGreen","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":380,"y":580,"wires":[["2c416713.f521e8"]]},{"id":"423a708d.9709","type":"inject","z":"62270d87.6a8a3c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":160,"y":580,"wires":[["fc8e7159.23bd3"]]},{"id":"89f84707.143848","type":"ibmiot in","z":"8b8e23ad.69ebc","authentication":"boundService","apiKey":"6e106082.5c7b98","inputType":"evt","deviceId":"playbulb23","applicationId":"","deviceType":"+","eventType":"+","commandType":"","format":"json","name":"Change playbulb??","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":true,"qos":0,"x":110,"y":60,"wires":[["d8f5a1c5.5965f"]]},{"id":"d8f5a1c5.5965f","type":"debug","z":"8b8e23ad.69ebc","name":"","active":false,"console":"false","complete":"false","x":350,"y":60,"wires":[]},{"id":"ce32ea21.6c1e08","type":"ibmiot out","z":"8b8e23ad.69ebc","authentication":"boundService","apiKey":"6e106082.5c7b98","outputType":"cmd","deviceId":"playbulb30","deviceType":"playbulb","eventCommandType":"setLED1off","format":"json","data":"payload","qos":0,"name":"IBM IoT","service":"registered","x":550,"y":160,"wires":[]},{"id":"dba930e5.bb0d4","type":"function","z":"8b8e23ad.69ebc","name":"LEDOn","func":"var newmsg = {\"cmd\" : \"setLED1on\",\n\"level\":1\n}\nmsg.eventOrCommandType = \"setLED1on\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":340,"y":160,"wires":[["ce32ea21.6c1e08"]]},{"id":"9b53ac15.ca5c3","type":"inject","z":"8b8e23ad.69ebc","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":130,"y":160,"wires":[["dba930e5.bb0d4"]]},{"id":"2d0ea30e.0bc5ac","type":"function","z":"8b8e23ad.69ebc","name":"LEDOff","func":"var newmsg = {\"cmd\" : \"setLED1off\",\n\"level\":1\n}\nmsg.eventOrCommandType = \"setLED1off\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":340,"y":240,"wires":[["9ad20c93.20ead8"]]},{"id":"701af698.fc642","type":"inject","z":"8b8e23ad.69ebc","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":130,"y":240,"wires":[["2d0ea30e.0bc5ac"]]},{"id":"9ad20c93.20ead8","type":"ibmiot out","z":"8b8e23ad.69ebc","authentication":"boundService","apiKey":"6e106082.5c7b98","outputType":"cmd","deviceId":"playbulb30","deviceType":"playbulb","eventCommandType":"setLED1off","format":"json","data":"payload","qos":0,"name":"IBM IoT","service":"registered","x":550,"y":240,"wires":[]},{"id":"77fe20ed.8a215","type":"ibmiot in","z":"8b8e23ad.69ebc","authentication":"boundService","apiKey":"6e106082.5c7b98","inputType":"evt","deviceId":"playbulb231","applicationId":"","deviceType":"+","eventType":"IR1","commandType":"","format":"json","name":"IR1-playbulb30","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":true,"qos":0,"x":150,"y":380,"wires":[["1f2b8594.15e902","42200113.ec64e8"]]},{"id":"a5be9d26.b53088","type":"ibmiot out","z":"8b8e23ad.69ebc","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb231","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"Change playbulb??","service":"registered","x":970,"y":400,"wires":[]},{"id":"80536100.f13d4","type":"function","z":"8b8e23ad.69ebc","name":"SetColorRed","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":550,"y":340,"wires":[["46410346.4c7f94","a5be9d26.b53088"]]},{"id":"46410346.4c7f94","type":"debug","z":"8b8e23ad.69ebc","name":"","active":true,"console":"false","complete":"false","x":930,"y":340,"wires":[]},{"id":"428a7531.95ec8c","type":"function","z":"8b8e23ad.69ebc","name":"SetColorGreen","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":560,"y":400,"wires":[["46410346.4c7f94","94ffd98.7a016a8"]]},{"id":"1f2b8594.15e902","type":"switch","z":"8b8e23ad.69ebc","name":"","property":"payload.status","propertyType":"msg","rules":[{"t":"eq","v":"broken","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":300,"y":380,"wires":[["80536100.f13d4","ba1ee93c.6760b8"],["428a7531.95ec8c"]]},{"id":"42200113.ec64e8","type":"function","z":"8b8e23ad.69ebc","name":"","func":"isset =  global.get(\"ir1set\")\nif(msg.payload.value == 1 )\nif(isset)\n{\nnode.warn(\"Already set\")    \n\n}else{\n\n\n\n    global.set(\"ir1time\",msg.payload.ts)\n    global.set(\"ir1set\",true)\n    node.warn(\" setting time\")    \n\n}\n\n\nreturn msg;","outputs":1,"noerr":0,"x":300,"y":440,"wires":[[]]},{"id":"dbadf235.18d4c","type":"ibmiot in","z":"8b8e23ad.69ebc","authentication":"boundService","apiKey":"6e106082.5c7b98","inputType":"evt","deviceId":"playbulb00","applicationId":"","deviceType":"+","eventType":"IR2","commandType":"","format":"json","name":"IR2","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":true,"qos":0,"x":120,"y":540,"wires":[["217d4b15.1ac704","67833d70.4134d4"]]},{"id":"217d4b15.1ac704","type":"switch","z":"8b8e23ad.69ebc","name":"","property":"payload.status","propertyType":"msg","rules":[{"t":"eq","v":"broken","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":300,"y":540,"wires":[[],[]]},{"id":"67833d70.4134d4","type":"function","z":"8b8e23ad.69ebc","name":"","func":"isset =  global.get(\"ir1set\")\nif(msg.payload.value == 1 )\nif(isset)\n{\n//node.warn(\"IR1 set\")  \nif(msg.payload.value == 1 )\n{\n  //  node.warn(\"IR2 set\") \n global.set(\"ir2time\",msg.payload.ts)\n global.set(\"ir1set\",false)\n \n starttime = global.get(\"ir1time\")\n endtime = global.get(\"ir2time\")\n  mytime=endtime-starttime;\n node.warn(\"diff time = \"+mytime)\n  \n   \n // Speed calc\n //distnce\n  // \tms = (175 / (mytime/1000))\ndistcm = 10 \n\tms = ((distcm/100) / (mytime/1000))\n  \tkph = (ms * 3.6)\n  \n  \tnode.warn(\"SPEED in km/h = \"+kph.toFixed(4)) \n}\tnode.warn(\"SPEED in ms = \"+ms.toFixed(4)) \n\n}else{\n    node.warn(\"IR1 not set\") \n}\n\n\nreturn msg;","outputs":1,"noerr":0,"x":300,"y":600,"wires":[[]]},{"id":"db5cdc1a.63b52","type":"ibmiot out","z":"917b94f0.16e6a8","authentication":"boundService","apiKey":"6e106082.5c7b98","outputType":"cmd","deviceId":"playbulb23","deviceType":"playbulb","eventCommandType":"draw7SLED","format":"json","data":"payload","qos":0,"name":"playbulb23","service":"registered","x":630,"y":160,"wires":[]},{"id":"988c0f2b.a9d768","type":"function","z":"917b94f0.16e6a8","name":"draw7SLED","func":"var newmsg = {\"cmd\" : \"draw7SLED\",\n\"value\":\"7\"\n}\nmsg.eventOrCommandType = \"draw7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":420,"y":160,"wires":[["db5cdc1a.63b52"]]},{"id":"b0233ce0.e89ca","type":"inject","z":"917b94f0.16e6a8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":200,"y":160,"wires":[["988c0f2b.a9d768"]]},{"id":"aa9d4da1.84441","type":"function","z":"917b94f0.16e6a8","name":"set7SLED","func":"var newmsg = {\"cmd\" : \"set7SLED\",\n// Number One 1 with a Dot\n// Infos https://en.wikipedia.org/wiki/Seven-segment_display\n\"A\":0,\n\"B\":1,\n\"C\":1,\n\"D\":0,\n\"E\":0,\n\"F\":0,\n\"G\":0,\n\"DP\":1\n}\nmsg.eventOrCommandType = \"set7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":410,"y":240,"wires":[["db5cdc1a.63b52"]]},{"id":"6bf46ffc.f5f8e","type":"inject","z":"917b94f0.16e6a8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":200,"y":240,"wires":[["aa9d4da1.84441"]]},{"id":"503653da.2e2b04","type":"ibmiot out","z":"917b94f0.16e6a8","authentication":"boundService","apiKey":"6e106082.5c7b98","outputType":"cmd","deviceId":"playbulb30","deviceType":"playbulb","eventCommandType":"set7SLED","format":"json","data":"payload","qos":0,"name":"playbulb23","service":"registered","x":630,"y":320,"wires":[]},{"id":"368d788c.198a48","type":"function","z":"917b94f0.16e6a8","name":"init7SLED","func":"//default PINs 17,4, 23, 24, 25, 27, 22, 18\nvar newmsg = {\"cmd\" : \"init7SLED\",\n\"pinA\":17,\n\"pinB\":4,\n\"pinC\":23,\n\"pinD\":24,\n\"pinE\":12, //25\n\"pinF\":27,\n\"pinG\":22,\n\"pinDP\":18\n}\nmsg.eventOrCommandType = \"init7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":410,"y":320,"wires":[["503653da.2e2b04"]]},{"id":"b85452c.2a1f9b","type":"inject","z":"917b94f0.16e6a8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":200,"y":320,"wires":[["368d788c.198a48"]]},{"id":"19d1816f.9604ef","type":"function","z":"917b94f0.16e6a8","name":"draw7SLED","func":"var newmsg = {\"cmd\" : \"draw7SLED\",\n\"value\":\"0\"\n}\nmsg.eventOrCommandType = \"draw7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":410,"y":100,"wires":[["db5cdc1a.63b52"]]},{"id":"bdc509.7a8f52f8","type":"inject","z":"917b94f0.16e6a8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":190,"y":100,"wires":[["19d1816f.9604ef"]]},{"id":"7abd03e9.a98704","type":"function","z":"917b94f0.16e6a8","name":"draw7SLED","func":"var newmsg = {\"cmd\" : \"draw7SLED\",\n\"value\":\"4\"\n}\nmsg.eventOrCommandType = \"draw7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":390,"y":40,"wires":[["db5cdc1a.63b52"]]},{"id":"28a1f12c.ed569e","type":"inject","z":"917b94f0.16e6a8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":170,"y":40,"wires":[["7abd03e9.a98704"]]},{"id":"f3dfd7cc.fd2e2","type":"function","z":"8b8e23ad.69ebc","name":"draw7SLED-Count","func":"var newmsg = {\"cmd\" : \"draw7SLED\",\n\"value\":msg.value\n}\nmsg.eventOrCommandType = \"draw7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":570,"y":300,"wires":[["a2a3d430.c1293","a5be9d26.b53088"]]},{"id":"ba1ee93c.6760b8","type":"function","z":"8b8e23ad.69ebc","name":"Counter","func":"myc =  global.get(\"myc\")\nnode.warn(\"myc = \"+myc)\nif( isNaN(myc))\n    myc=0;\n\nmyc++;\nif(myc >9)\nmyc=0;\nglobal.set(\"myc\",myc)\nmsg.value=myc;\nreturn msg;","outputs":1,"noerr":0,"x":380,"y":300,"wires":[["f3dfd7cc.fd2e2","a2a3d430.c1293"]]},{"id":"a4a19c02.1f6e08","type":"inject","z":"8b8e23ad.69ebc","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":120,"y":300,"wires":[["ba1ee93c.6760b8"]]},{"id":"a2a3d430.c1293","type":"debug","z":"8b8e23ad.69ebc","name":"Counter","active":true,"console":"false","complete":"true","x":920,"y":300,"wires":[]},{"id":"94ffd98.7a016a8","type":"delay","z":"8b8e23ad.69ebc","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":780,"y":400,"wires":[["a5be9d26.b53088"]]},{"id":"677bb73e.02d57","type":"ibmiot in","z":"1843e116.02acff","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb??","applicationId":"","deviceType":"+","eventType":"ping","commandType":"","format":"json","name":"IR Events From Candle - adjust name","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":"","qos":0,"x":190,"y":160,"wires":[["900e8753.935488"]]},{"id":"900e8753.935488","type":"debug","z":"1843e116.02acff","name":"Pings","active":false,"console":false,"complete":"payload","x":430,"y":160,"wires":[]},{"id":"cbb09b16.ea5508","type":"ibmiot in","z":"1843e116.02acff","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb30","applicationId":"","deviceType":"+","eventType":"IR1","commandType":"","format":"json","name":"IR Events From Candle - adjust name","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":"","qos":0,"x":190,"y":100,"wires":[["62cf8981.01bd48"]]},{"id":"62cf8981.01bd48","type":"debug","z":"1843e116.02acff","name":"Breaker","active":true,"console":false,"complete":"payload","x":440,"y":100,"wires":[]},{"id":"14f12b8e.64e61c","type":"ibmiot in","z":"1843e116.02acff","authentication":"boundService","apiKey":"f9740945.03c29","inputType":"evt","deviceId":"playbulb30","applicationId":"","deviceType":"+","eventType":"IR1","commandType":"","format":"json","name":"IR1 form  From Candle - adjust name ??","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":true,"qos":0,"x":190,"y":360,"wires":[["b1560271.096f7"]]},{"id":"b8f016a4.214ad8","type":"debug","z":"1843e116.02acff","name":"","active":false,"console":"false","complete":"false","x":1010,"y":360,"wires":[]},{"id":"c6f1634c.740238","type":"function","z":"1843e116.02acff","name":"SetColorGreen","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":600,"y":360,"wires":[["92efe724.1f3f8"]]},{"id":"b1560271.096f7","type":"switch","z":"1843e116.02acff","name":"","property":"payload.status","propertyType":"msg","rules":[{"t":"eq","v":"broken","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":410,"y":360,"wires":[["13827d5c.f07bdb","609f029c.faf554"],["c6f1634c.740238"]]},{"id":"c7767fe8.2facf","type":"comment","z":"1843e116.02acff","name":"Make Sure to Adjust you candle number !!!!","info":"instructor: mvk@ca.ibm.com","x":270,"y":40,"wires":[]},{"id":"afa546b8.02c2d","type":"function","z":"1843e116.02acff","name":"Counter","func":"myc =  global.get(\"myc\")\n\nif( isNaN(myc) ||typeof myc === undefined)\n\n    myc=0;\n\nmyc++;\nif(myc >9)\nmyc=0;\nglobal.set(\"myc\",myc)\nmsg.value=myc;\nreturn msg;","outputs":1,"noerr":0,"x":320,"y":620,"wires":[["67af9f8d.9d3f18","6821ffce.6c921"]]},{"id":"83099877.c28e58","type":"function","z":"1843e116.02acff","name":"SET LCD TO #2","func":"\n// You can send a command to the candle which address each panel \n// below would display #2\nvar newmsg = {\"cmd\" : \"set7SLED\",\n\"A\":1,\n\"B\":1,\n\"C\":0,\n\"D\":1       ,\n\"E\":1,\n\"F\":0,\n\"G\":1,\n\"DP\":0\n}\nmsg.eventOrCommandType = \"set7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":720,"y":640,"wires":[[]]},{"id":"786306c2.89c19","type":"inject","z":"1843e116.02acff","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":120,"y":620,"wires":[["afa546b8.02c2d"]]},{"id":"92efe724.1f3f8","type":"delay","z":"1843e116.02acff","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":790,"y":360,"wires":[["b8f016a4.214ad8","f0fad9e9.841018"]]},{"id":"609f029c.faf554","type":"function","z":"1843e116.02acff","name":"Set TO RED ????","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255,\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":610,"y":300,"wires":[[]]},{"id":"62ba1fb2.c27b4","type":"comment","z":"1843e116.02acff","name":"Extra with LCD display","info":"","x":140,"y":540,"wires":[]},{"id":"f0fad9e9.841018","type":"ibmiot out","z":"1843e116.02acff","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb30","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"Send to my Candle - adjust name ??","service":"registered","x":1010,"y":280,"wires":[]},{"id":"13827d5c.f07bdb","type":"function","z":"1843e116.02acff","name":"Total","func":"allcounter =  global.get(\"allcounter\")\n//node.warn(\"allcounter = \"+allcounter)\nif( isNaN(allcounter) ||typeof allcounter === undefined)\n    allcounter=0;\n\nallcounter++;\nif(allcounter >10)\nallcounter=0;\nglobal.set(\"allcounter\",allcounter)\nmsg.payload=allcounter;\nreturn msg;","outputs":1,"noerr":0,"x":410,"y":240,"wires":[["1c8d9b82.2cbe94"]]},{"id":"1c8d9b82.2cbe94","type":"ui_gauge","z":"1843e116.02acff","name":"","group":"3dd93ba5.582784","order":0,"width":0,"height":0,"gtype":"gage","title":"Gauge","label":"units","format":"{{value}}","min":0,"max":10,"colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":570,"y":240,"wires":[]},{"id":"f7477723.765b3","type":"comment","z":"1843e116.02acff","name":"UseInterface /ui","info":"","x":620,"y":200,"wires":[]},{"id":"67af9f8d.9d3f18","type":"switch","z":"1843e116.02acff","name":"","property":"value","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"str"},{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"str"},{"t":"eq","v":"6","vt":"str"},{"t":"else"}],"checkall":"true","outputs":5,"x":510,"y":620,"wires":[["48b89e05.aeee28"],[],["83099877.c28e58"],["a82c27cb.abc1"],[]]},{"id":"48b89e05.aeee28","type":"function","z":"1843e116.02acff","name":"SET LCD TO #0","func":"\n// You can send a command to the candle which address each panel \n// below would display #2\nvar newmsg = {\"cmd\" : \"set7SLED\",\n\"A\":1,\n\"B\":1,\n\"C\":1,\n\"D\":1,\n\"E\":1,\n\"F\":1,\n\"G\":0,\n\"DP\":1\n}\nmsg.eventOrCommandType = \"set7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":720,"y":600,"wires":[["f0fad9e9.841018"]]},{"id":"6821ffce.6c921","type":"debug","z":"1843e116.02acff","name":"Counter","active":true,"console":false,"complete":"value","x":500,"y":560,"wires":[]},{"id":"89fd2d93.58e238","type":"comment","z":"917b94f0.16e6a8","name":"7 Segemnt LED","info":"https://en.wikipedia.org/wiki/Seven-segment_display\n/1    A  B  C   D   E   F   G  DP\nGpio,17, 4, 23, 24, 25, 27, 22, 18);\n\nAAAA = GPIO17\nF  B=DPIO04\nF  B\nGGGG =\nE  C\nE  C\nDDDD =24\nDP =18","x":650,"y":260,"wires":[]},{"id":"b79d3811.f03e48","type":"inject","z":"9549a969.6b4c68","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":200,"y":340,"wires":[[]]},{"id":"a82c27cb.abc1","type":"function","z":"1843e116.02acff","name":"SET LCD TO #6","func":"\n// You can send a command to the candle which address each panel \n// below would display #2\nvar newmsg = {\"cmd\" : \"set7SLED\",\n\"A\":0,\n\"B\":0,\n\"C\":1,\n\"D\":1       ,\n\"E\":1,\n\"F\":1,\n\"G\":1,\n\"DP\":0\n}\nmsg.eventOrCommandType = \"set7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":720,"y":680,"wires":[["f0fad9e9.841018"]]},{"id":"a64548e7.72544","type":"ibmiot in","z":"c5708596.6622b8","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb24","applicationId":"","deviceType":"+","eventType":"IR1","commandType":"","format":"json","name":"IR Events From PI - adjust name","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":"","qos":0,"x":210,"y":140,"wires":[["692d02d4.1b6324"]]},{"id":"ab9797c8.ed69d8","type":"function","z":"c5708596.6622b8","name":"SET LCD TO #1","func":"\n// You can send a command to the candle which address each panel \n// below would display #2\nvar newmsg = {\"cmd\" : \"set7SLED\",\n\"A\":0,\n\"B\":0,\n\"C\":0,\n\"D\":0,  \n\"E\":1,\n\"F\":1,\n\"G\":0,\n\"DP\":0,\n\"N\":1\n}\nmsg.eventOrCommandType = \"set7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":900,"y":360,"wires":[["9272aa10.648a18"]]},{"id":"b61c466c.225df","type":"ibmiot in","z":"c5708596.6622b8","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb24","applicationId":"","deviceType":"+","eventType":"+","commandType":"","format":"json","name":"IR Events From PI - adjust name","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":"","qos":0,"x":210,"y":200,"wires":[["2831d216.9a97a6"]]},{"id":"2831d216.9a97a6","type":"debug","z":"c5708596.6622b8","name":"Pings","active":false,"console":false,"complete":"payload","x":470,"y":200,"wires":[]},{"id":"28091cc3.407b1c","type":"debug","z":"c5708596.6622b8","name":"Touch","active":true,"console":false,"complete":"payload","x":670,"y":120,"wires":[]},{"id":"11a698d3.f161df","type":"function","z":"c5708596.6622b8","name":"SetColorGreen","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":740,"y":760,"wires":[["a358b84e.3bbf68"]]},{"id":"8b5a757c.bff158","type":"comment","z":"c5708596.6622b8","name":"Make Sure to Adjust you candle number !!!!","info":"instructor: mvk@ca.ibm.com","x":220,"y":80,"wires":[]},{"id":"ff719ec8.07cea8","type":"function","z":"c5708596.6622b8","name":"GetSetCounter","func":"myc =  global.get(\"myc\")\n\nif( isNaN(myc) ||typeof myc === undefined)\n\n    myc=0;\n\nmyc++;\nif(myc >9)\nmyc=0;\nglobal.set(\"myc\",myc)\nmsg.value=myc;\nmsg.payload = myc;\nreturn msg;","outputs":1,"noerr":0,"x":340,"y":440,"wires":[["b0a96bbc.c81bb","3e40be0c.e86502","a2902786.3626c","4942009d.a0b26"]]},{"id":"b6b1b7e8.5527b","type":"inject","z":"c5708596.6622b8","name":"Counter","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":130,"y":440,"wires":[["ff719ec8.07cea8"]]},{"id":"64680b0d.d3811c","type":"comment","z":"c5708596.6622b8","name":"Extra with LCD display","info":"","x":160,"y":360,"wires":[]},{"id":"b0a96bbc.c81bb","type":"switch","z":"c5708596.6622b8","name":"","property":"value","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"},{"t":"eq","v":"3","vt":"num"},{"t":"eq","v":"4","vt":"num"},{"t":"eq","v":"5","vt":"num"},{"t":"eq","v":"6","vt":"num"},{"t":"eq","v":"7","vt":"num"},{"t":"eq","v":"8","vt":"num"},{"t":"eq","v":"9","vt":"num"}],"checkall":"true","outputs":10,"x":550,"y":460,"wires":[["c8be9915.aaa208"],["ab9797c8.ed69d8"],["4e6e4648.db7ea"],["d9ca8a9d.d116a8"],["dc48cf8.bd0e33"],["abf5a910.486fd8"],["5cdaf76a.7d369"],["9d546088.4c7f7"],["5cf525ac.1561e4"],["d09532f9.c4ac68"]]},{"id":"c8be9915.aaa208","type":"function","z":"c5708596.6622b8","name":"SET LCD TO #0","func":"\n// You can send a command to the candle which address each panel \n// below would display #2\nvar newmsg = {\"cmd\" : \"set7SLED\",\n\"A\":1,\n\"B\":1,\n\"C\":1,\n\"D\":1,\n\"E\":1,\n\"F\":1,\n\"G\":0,\n\"DP\":1,\n\"N\":0\n}\nmsg.eventOrCommandType = \"set7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":900,"y":320,"wires":[["9272aa10.648a18"]]},{"id":"3e40be0c.e86502","type":"debug","z":"c5708596.6622b8","name":"Counter","active":true,"console":false,"complete":"value","x":320,"y":520,"wires":[]},{"id":"5cdaf76a.7d369","type":"function","z":"c5708596.6622b8","name":"SET LCD TO #6","func":"\n// You can send a command to the candle which address each panel \n// below would display #2\nvar newmsg = {\"cmd\" : \"set7SLED\",\n\"A\":0,\n\"B\":0,\n\"C\":1,\n\"D\":1       ,\n\"E\":1,\n\"F\":1,\n\"G\":1,\n\"DP\":0\n}\nmsg.eventOrCommandType = \"set7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":900,"y":560,"wires":[["9272aa10.648a18"]]},{"id":"237030b3.ae272","type":"comment","z":"c5708596.6622b8","name":"7 Segemnt LED","info":"https://en.wikipedia.org/wiki/Seven-segment_display\n/1    A  B  C   D   E   F   G  DP\nGpio,17, 4, 23, 24, 25, 27, 22, 18);\n\nAAAA = GPIO17\nF  B=GPIO04\nF  B\nGGGG =\nE  C\nE  C\nDDDD =24\nDP =18","x":900,"y":280,"wires":[]},{"id":"5cf525ac.1561e4","type":"function","z":"c5708596.6622b8","name":"SET LCD TO #8","func":"\n// You can send a command to the candle which address each panel \n// below would display #2\nvar newmsg = {\"cmd\" : \"set7SLED\",\n\"A\":1,\n\"B\":1,\n\"C\":1,\n\"D\":1       ,\n\"E\":1,\n\"F\":1,\n\"G\":1,\n\"DP\":0\n}\nmsg.eventOrCommandType = \"set7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":900,"y":640,"wires":[["9272aa10.648a18"]]},{"id":"9272aa10.648a18","type":"ibmiot out","z":"c5708596.6622b8","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb14","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"Send to my PI - adjust name ??","service":"registered","x":1270,"y":460,"wires":[]},{"id":"a2902786.3626c","type":"ui_gauge","z":"c5708596.6622b8","name":"","group":"d978be97.f2089","order":0,"width":0,"height":0,"gtype":"gage","title":"Gauge","label":"units","format":"{{value}}","min":0,"max":10,"colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":510,"y":320,"wires":[]},{"id":"8714158.4935268","type":"comment","z":"c5708596.6622b8","name":"UseInterface /ui","info":"","x":540,"y":280,"wires":[]},{"id":"a358b84e.3bbf68","type":"ibmiot out","z":"c5708596.6622b8","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb14","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"Send to my Candle - adjust name ??","service":"registered","x":1050,"y":780,"wires":[]},{"id":"4942009d.a0b26","type":"switch","z":"c5708596.6622b8","name":"","property":"value","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"str"},{"t":"eq","v":"5","vt":"str"},{"t":"else"}],"checkall":"true","outputs":3,"x":530,"y":800,"wires":[["11a698d3.f161df"],["d800bd43.55eab"],[]]},{"id":"8ecdcedc.486b78","type":"function","z":"c5708596.6622b8","name":"Rotate LCD ","func":"\n// You can send a command to the candle which address each panel \n// below would display #2\nvar newmsg = {\"cmd\" : \"rotate7SLED\"\n}\nmsg.eventOrCommandType = \"rotate7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":750,"y":900,"wires":[["a358b84e.3bbf68"]]},{"id":"f58b2434.ba11d","type":"inject","z":"c5708596.6622b8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":520,"y":900,"wires":[["8ecdcedc.486b78"]]},{"id":"d800bd43.55eab","type":"function","z":"c5708596.6622b8","name":"SetColorRED","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":750,"y":820,"wires":[["a358b84e.3bbf68"]]},{"id":"87f888b7.6f3fc8","type":"inject","z":"c5708596.6622b8","name":"Test #1","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":870,"y":180,"wires":[["ab9797c8.ed69d8"]]},{"id":"4e6e4648.db7ea","type":"function","z":"c5708596.6622b8","name":"SET LCD TO #2","func":"\n// You can send a command to the candle which address each panel \n// below would display #2\nvar newmsg = {\"cmd\" : \"set7SLED\",\n\"A\":1,\n\"B\":1,\n\"C\":0,\n\"D\":1       ,\n\"E\":1,\n\"F\":0,\n\"G\":1,\n\"DP\":0,\n\"N\":2\n}\nmsg.eventOrCommandType = \"set7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":900,"y":400,"wires":[["9272aa10.648a18"]]},{"id":"dc48cf8.bd0e33","type":"function","z":"c5708596.6622b8","name":"SET LCD TO #4","func":"\n// You can send a command to the candle which address each panel \n// below would display #2\nvar newmsg = {\"cmd\" : \"set7SLED\",\n\"A\":0,\n\"B\":1,\n\"C\":1,\n\"D\":0,  \n\"E\":0,\n\"F\":1,\n\"G\":1,\n\"DP\":0\n}\nmsg.eventOrCommandType = \"set7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":900,"y":480,"wires":[["9272aa10.648a18"]]},{"id":"d9ca8a9d.d116a8","type":"function","z":"c5708596.6622b8","name":"SET LCD TO #3","func":"\n// You can send a command to the candle which address each panel \n// below would display #2\nvar newmsg = {\"cmd\" : \"set7SLED\",\n\"A\":1,\n\"B\":1,\n\"C\":1,\n\"D\":1,\n\"E\":0,\n\"F\":0,\n\"G\":1,\n\"DP\":0\n}\nmsg.eventOrCommandType = \"set7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":900,"y":440,"wires":[["9272aa10.648a18"]]},{"id":"45ea2ebe.778ba","type":"inject","z":"c5708596.6622b8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":520,"y":860,"wires":[["d800bd43.55eab"]]},{"id":"7f1822e0.abf7a4","type":"function","z":"c5708596.6622b8","name":"time","func":"var d = new Date();\nvar n = d.toLocaleTimeString();\nvar n = d.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit',second:'2-digit', hour12: false}); \n\nmsg.payload = {}\nmsg.payload.time =n;\nmsg.payload.hours = n.substr(0,2)\nmsg.payload.minutes = n.substr(3,2)\nmsg.payload.seconds = n.substr(6,2)\n\nmsg.payload.hourone = n.substr(0,1)\nmsg.payload.hourtwo = n.substr(1,1)\nmsg.payload.minuteone = n.substr(3,1)\nmsg.payload.minutetwo = n.substr(4,1)\n\nmsg.payload.secondone = n.substr(6,1)\nmsg.payload.secondtwo = n.substr(7,1)\nmsg.payload = msg.payload.secondtwo \nreturn msg;","outputs":1,"noerr":0,"x":470,"y":1020,"wires":[["4bb40910.eaea9","97e8bd77.ff5ef","f19fcf20.16bcf"]]},{"id":"da42fecc.bcef1","type":"inject","z":"c5708596.6622b8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":220,"y":1020,"wires":[["7f1822e0.abf7a4"]]},{"id":"4bb40910.eaea9","type":"debug","z":"c5708596.6622b8","name":"","active":false,"console":"false","complete":"false","x":670,"y":980,"wires":[]},{"id":"97e8bd77.ff5ef","type":"ui_text","z":"c5708596.6622b8","group":"d978be97.f2089","order":0,"width":0,"height":0,"name":"","label":"Time","format":"{{msg.payload.time}}","layout":"row-spread","x":650,"y":1020,"wires":[]},{"id":"d2a3a921.64a4b","type":"ui_text_input","z":"c5708596.6622b8","name":"","label":"Number 0-9","group":"d978be97.f2089","order":0,"width":0,"height":0,"passthru":true,"mode":"text","delay":"0","topic":"","x":150,"y":600,"wires":[["368de890.0504f","f19fcf20.16bcf"]]},{"id":"368de890.0504f","type":"debug","z":"c5708596.6622b8","name":"UI-Input","active":true,"console":false,"complete":"payload","x":320,"y":660,"wires":[]},{"id":"f19fcf20.16bcf","type":"function","z":"c5708596.6622b8","name":"SetCounter","func":"myc = parseInt(msg.payload )\nglobal.set(\"myc\",myc)\nmsg.value=myc;\nmsg.payload=myc;\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":600,"wires":[["b0a96bbc.c81bb","a2902786.3626c"]]},{"id":"114b9fa5.3c5c98","type":"ui_button","z":"c5708596.6622b8","name":"","group":"d978be97.f2089","order":0,"width":0,"height":0,"passthru":false,"label":"RotateLED","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":510,"y":940,"wires":[["8ecdcedc.486b78"]]},{"id":"ac21e225.50ee6","type":"ui_button","z":"c5708596.6622b8","name":"","group":"d978be97.f2089","order":0,"width":0,"height":0,"passthru":false,"label":"NextNumber","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":130,"y":500,"wires":[["ff719ec8.07cea8"]]},{"id":"692d02d4.1b6324","type":"switch","z":"c5708596.6622b8","name":"","property":"payload.value","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"else"}],"checkall":"true","outputs":2,"x":470,"y":140,"wires":[["28091cc3.407b1c"],[]]},{"id":"d09532f9.c4ac68","type":"function","z":"c5708596.6622b8","name":"SET LCD TO #9","func":"\n// You can send a command to the candle which address each panel \n// below would display #2\nvar newmsg = {\"cmd\" : \"set7SLED\",\n\"A\":1,\n\"B\":1,\n\"C\":1,\n\"D\":0,\n\"E\":0,\n\"F\":1,\n\"G\":1,\n\"DP\":0,\n\"N\":9\n}\nmsg.eventOrCommandType = \"set7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":900,"y":680,"wires":[["9272aa10.648a18"]]},{"id":"cae526d9.298388","type":"function","z":"c5708596.6622b8","name":"SET LCD TO enpty","func":"\n// You can send a command to the candle which address each panel \n// below would display #2\nvar newmsg = {\"cmd\" : \"set7SLED\",\n\"A\":0,\n\"B\":0,\n\"C\":0,\n\"D\":0,\n\"E\":0,\n\"F\":0,\n\"G\":0,\n\"DP\":0,\n\"N\":0\n}\nmsg.eventOrCommandType = \"set7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":910,"y":720,"wires":[["9272aa10.648a18"]]},{"id":"4aa678f3.2ec568","type":"inject","z":"c5708596.6622b8","name":"Test #1","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":630,"y":700,"wires":[["cae526d9.298388"]]},{"id":"abf5a910.486fd8","type":"function","z":"c5708596.6622b8","name":"SET LCD TO #5","func":"\n// You can send a command to the candle which address each panel \n// below would display #2\nvar newmsg = {\"cmd\" : \"set7SLED\",\n\"A\":1,\n\"B\":0,\n\"C\":1,\n\"D\":1,  \n\"E\":0,\n\"F\":1,\n\"G\":1,\n\"DP\":1\n}\nmsg.eventOrCommandType = \"set7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":900,"y":520,"wires":[["9272aa10.648a18"]]},{"id":"9d546088.4c7f7","type":"function","z":"c5708596.6622b8","name":"SET LCD TO #7","func":"\n// You can send a command to the candle which address each panel \n// below would display #2\nvar newmsg = {\"cmd\" : \"set7SLED\",\n\"A\":1,\n\"B\":1,\n\"C\":1,\n\"D\":0,  \n\"E\":0,\n\"F\":0,\n\"G\":0,\n\"DP\":0\n}\nmsg.eventOrCommandType = \"set7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":900,"y":600,"wires":[["9272aa10.648a18"]]},{"id":"24d3ed5b.eec97a","type":"ibmiot in","z":"9ed094d3.78c7f","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb40","applicationId":"","deviceType":"+","eventType":"IR1","commandType":"","format":"json","name":"IR Events From PI - adjust name","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":"","qos":0,"x":230,"y":60,"wires":[["5d48b345.d0e19c"]]},{"id":"d9f8a7cc.55767","type":"ibmiot in","z":"9ed094d3.78c7f","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb40","applicationId":"","deviceType":"+","eventType":"+","commandType":"","format":"json","name":"IR Events From PI - adjust name","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":"","qos":0,"x":230,"y":120,"wires":[["674bf992.8bbf"]]},{"id":"674bf992.8bbf","type":"debug","z":"9ed094d3.78c7f","name":"Pings","active":false,"console":false,"complete":"payload","x":490,"y":120,"wires":[]},{"id":"7a829730.48e0d","type":"debug","z":"9ed094d3.78c7f","name":"Touch","active":true,"console":false,"complete":"payload","x":730,"y":60,"wires":[]},{"id":"5d48b345.d0e19c","type":"switch","z":"9ed094d3.78c7f","name":"","property":"payload.value","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"else"}],"checkall":"true","outputs":2,"x":490,"y":60,"wires":[["7a829730.48e0d"],[]]},{"id":"7c3d4e91.add668","type":"ibmiot in","z":"9ed094d3.78c7f","authentication":"boundService","apiKey":"6e106082.5c7b98","inputType":"evt","deviceId":"playbulb40","applicationId":"","deviceType":"+","eventType":"IR1","commandType":"","format":"json","name":"IR1","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":true,"qos":0,"x":150,"y":280,"wires":[["c91c1872.0f2e98"]]},{"id":"c91c1872.0f2e98","type":"switch","z":"9ed094d3.78c7f","name":"","property":"payload.status","propertyType":"msg","rules":[{"t":"eq","v":"broken","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":330,"y":280,"wires":[["adf6eb1e.85e5b","726a2cc6.786db4","9d36f942.128fc"],[]]},{"id":"726a2cc6.786db4","type":"function","z":"9ed094d3.78c7f","name":"Set IR1","func":"isset =  global.get(\"ir1set\")\nif(msg.payload.value == 1 )\nif(isset)\n{\nnode.warn(\"Already set\")    \n\n}else{\n\n\n\n    global.set(\"ir1time\",msg.payload.ts)\n    global.set(\"ir1set\",true)\n    node.warn(\" setting time\")    \n\n}\n\n\nreturn msg;","outputs":1,"noerr":0,"x":520,"y":300,"wires":[[]]},{"id":"60acd199.a3508","type":"ibmiot in","z":"9ed094d3.78c7f","authentication":"boundService","apiKey":"6e106082.5c7b98","inputType":"evt","deviceId":"playbulb40","applicationId":"","deviceType":"+","eventType":"IR2","commandType":"","format":"json","name":"IR2","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":true,"qos":0,"x":150,"y":440,"wires":[["25aa2e4c.4d58c2"]]},{"id":"25aa2e4c.4d58c2","type":"switch","z":"9ed094d3.78c7f","name":"","property":"payload.status","propertyType":"msg","rules":[{"t":"eq","v":"broken","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":350,"y":440,"wires":[["339f55f8.380922","b21239b4.c2281","4883adee.b101cc"],[]]},{"id":"b21239b4.c2281","type":"function","z":"9ed094d3.78c7f","name":"Set IR2 - Calulate SPEED - Adjust","func":"isset =  global.get(\"ir1set\")\nkph=0\nkmh=0\nif(msg.payload.value == 1 )\nif(isset)\n{\n  //  node.warn(\"IR2 set\") \n global.set(\"ir2time\",msg.payload.ts)\n global.set(\"ir1set\",false)\n \n starttime = global.get(\"ir1time\")\n endtime = global.get(\"ir2time\")\n  mytime=endtime-starttime;\n node.warn(\"Time diff in millisec = \"+mytime)\n  \n   \n // Speed calc\n //distnce\nvar ms = 0\n  \nvar distcm = 38 //DEFINE Ditance \nnode.warn(\"Distance in CM = \"+distcm)\n\tms = ((distcm/100) / (mytime/1000))\n  \tkph = (ms * 3.6)  \n  \t\n  \tkmh = (distcm/(mytime/1000))  * 0.036\n\n   \tnode.warn(\"SPEED in kmh = \"+kmh.toFixed(4)) \n // \tnode.warn(\"SPEED in kph = \"+kph.toFixed(4)) \n\tnode.warn(\"SPEED in ms = \"+ms.toFixed(4))\n\n\n}else{\n    node.warn(\"IR1 not set\") \n}\nmsg.payload.speedms = ms //ms.toFixed(4)\nmsg.payload.speedkmh = kph.toFixed(4)\nmsg.payload.speedkmh2 = kmh.toFixed(4)\nmsg.payload.distcm = distcm;\nmsg.payload.distm = (distcm/100);\nmsg.payload.timemm = mytime\nreturn msg;","outputs":1,"noerr":0,"x":260,"y":500,"wires":[["538b1708.5a1908","3464e78d.2efbc","2838724f.2037e6","b15b7dca.6a82d","29048f44.ce84e","31affcb8.b0c2ac","141faab6.9c727d"]]},{"id":"adf6eb1e.85e5b","type":"debug","z":"9ed094d3.78c7f","name":"IR1-Broken","active":true,"console":false,"complete":"payload","x":530,"y":260,"wires":[]},{"id":"339f55f8.380922","type":"debug","z":"9ed094d3.78c7f","name":"IR2-Broken","active":true,"console":false,"complete":"payload","x":530,"y":420,"wires":[]},{"id":"538b1708.5a1908","type":"debug","z":"9ed094d3.78c7f","name":"Speed","active":true,"console":false,"complete":"true","x":510,"y":500,"wires":[]},{"id":"cdce3646.fb4718","type":"ui_chart","z":"9ed094d3.78c7f","name":"","group":"10ed93c7.89d70c","order":1,"width":0,"height":0,"label":"Speed History","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"-2","ymax":"5","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"60","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":2,"x":540,"y":880,"wires":[[],[]]},{"id":"3464e78d.2efbc","type":"ui_text","z":"9ed094d3.78c7f","group":"685c0b62.9dfd04","order":1,"width":0,"height":0,"name":"","label":"SpeedKmH","format":"{{msg.payload.speedkmh}}","layout":"row-spread","x":530,"y":600,"wires":[]},{"id":"2838724f.2037e6","type":"ui_text","z":"9ed094d3.78c7f","group":"685c0b62.9dfd04","order":2,"width":0,"height":0,"name":"","label":"Time","format":"{{msg.payload.timemm}}","layout":"row-spread","x":510,"y":720,"wires":[]},{"id":"2ffe5a9d.fd480e","type":"ibmiot out","z":"9ed094d3.78c7f","authentication":"boundService","apiKey":"4c6c3038.24319","outputType":"evt","deviceId":"playbulb00","deviceType":"playbulb","eventCommandType":"dashboard","format":"json","data":"playload","qos":0,"name":"toMarkusDashBoard","service":"registered","x":780,"y":460,"wires":[]},{"id":"b15b7dca.6a82d","type":"function","z":"9ed094d3.78c7f","name":"","func":"msg.payload.event = \"dashboard\"\nmsg.payload.deviceId =  msg.deviceId\ndelete msg.eventType\ndelete msg.topic\ndelete msg.deviceId\nreturn msg;","outputs":1,"noerr":0,"x":510,"y":460,"wires":[["2ffe5a9d.fd480e"]]},{"id":"a1c8b549.1054f","type":"ibmiot in","z":"9ed094d3.78c7f","authentication":"boundService","apiKey":"6e106082.5c7b98","inputType":"evt","deviceId":"playbulb00","applicationId":"","deviceType":"+","eventType":"IR2","commandType":"","format":"json","name":"Dashboard","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":true,"qos":0,"x":180,"y":960,"wires":[["7393aa9.7113654"]]},{"id":"7393aa9.7113654","type":"debug","z":"9ed094d3.78c7f","name":"IR2-Broken","active":true,"console":false,"complete":"payload","x":410,"y":960,"wires":[]},{"id":"29048f44.ce84e","type":"ui_text","z":"9ed094d3.78c7f","group":"10ed93c7.89d70c","order":4,"width":0,"height":0,"name":"","label":"TS","format":"{{msg.payload.ts}}","layout":"row-spread","x":510,"y":760,"wires":[]},{"id":"31affcb8.b0c2ac","type":"function","z":"9ed094d3.78c7f","name":"Mapping","func":"msg.payload = msg.payload.speedkmh\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":560,"wires":[["9a4c8b9e.a616d","70bfbea3.29df48","388b3248.369e06","cdce3646.fb4718"]]},{"id":"9a4c8b9e.a616d","type":"ui_gauge","z":"9ed094d3.78c7f","name":"","group":"685c0b62.9dfd04","order":3,"width":0,"height":0,"gtype":"gage","title":"Speed Km/H","label":"units","format":"{{value}}","min":0,"max":"5","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":530,"y":560,"wires":[]},{"id":"141faab6.9c727d","type":"ui_text","z":"9ed094d3.78c7f","group":"685c0b62.9dfd04","order":4,"width":0,"height":0,"name":"","label":"Speedms","format":"{{msg.payload.speedms}}","layout":"row-spread","x":520,"y":640,"wires":[]},{"id":"70bfbea3.29df48","type":"ui_text","z":"9ed094d3.78c7f","group":"10ed93c7.89d70c","order":2,"width":0,"height":0,"name":"","label":"Distance","format":"{{msg.payload.distcm}}","layout":"row-spread","x":520,"y":680,"wires":[]},{"id":"388b3248.369e06","type":"ui_text","z":"9ed094d3.78c7f","group":"10ed93c7.89d70c","order":3,"width":0,"height":0,"name":"","label":"Device","format":"{{msg.deviceId}}","layout":"row-spread","x":510,"y":820,"wires":[]},{"id":"e5249bb1.9bdfc8","type":"ibmiot in","z":"35de9dbd.00d22a","authentication":"boundService","apiKey":"6e106082.5c7b98","inputType":"evt","deviceId":"playbulb00","applicationId":"","deviceType":"+","eventType":"dashboard","commandType":"","format":"json","name":"Dashboard","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":true,"qos":0,"x":140,"y":100,"wires":[["2eff2767.389","6a7e349b.ce0384"]]},{"id":"2eff2767.389","type":"debug","z":"35de9dbd.00d22a","name":"Dashboard","active":true,"console":false,"complete":"payload","x":370,"y":100,"wires":[]},{"id":"a2ef6927.372378","type":"ui_gauge","z":"35de9dbd.00d22a","name":"","group":"1134ac4c.7d089c","order":0,"width":0,"height":0,"gtype":"gage","title":"SpeedKmH","label":"units","format":"{{value}}","min":0,"max":"5","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":570,"y":240,"wires":[]},{"id":"60859650.701dc","type":"ui_text","z":"35de9dbd.00d22a","group":"1134ac4c.7d089c","order":0,"width":0,"height":0,"name":"","label":"Group23","format":"{{msg.payload.deviceId}}","layout":"row-spread","x":390,"y":180,"wires":[]},{"id":"6a7e349b.ce0384","type":"switch","z":"35de9dbd.00d22a","name":"Group","property":"payload.deviceId","propertyType":"msg","rules":[{"t":"eq","v":"playbulb23","vt":"str"},{"t":"eq","v":"","vt":"str"}],"checkall":"true","outputs":2,"x":180,"y":200,"wires":[["60859650.701dc","542d953b.57a964","7bcd91e2.11b1c"],[]]},{"id":"96b1738f.9ae28","type":"ui_gauge","z":"35de9dbd.00d22a","name":"","group":"98e50627.d5922","order":0,"width":0,"height":0,"gtype":"gage","title":"SpeedKmH","label":"units","format":"{{value}}","min":0,"max":"5","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":570,"y":380,"wires":[]},{"id":"a01f08a1.a4ec4","type":"ui_text","z":"35de9dbd.00d22a","group":"98e50627.d5922","order":0,"width":0,"height":0,"name":"","label":"Group24","format":"{{msg.payload.deviceId}}","layout":"row-spread","x":380,"y":340,"wires":[]},{"id":"542d953b.57a964","type":"function","z":"35de9dbd.00d22a","name":"Mapping","func":"msg.payload = msg.payload.speedkmh\nreturn msg;","outputs":1,"noerr":0,"x":380,"y":240,"wires":[["a2ef6927.372378"]]},{"id":"3944033f.3d77f4","type":"function","z":"35de9dbd.00d22a","name":"Mapping","func":"msg.payload = msg.payload.speedkmh\nreturn msg;","outputs":1,"noerr":0,"x":380,"y":380,"wires":[["96b1738f.9ae28"]]},{"id":"7bcd91e2.11b1c","type":"ui_text","z":"35de9dbd.00d22a","group":"1134ac4c.7d089c","order":0,"width":0,"height":0,"name":"","label":"TS","format":"{{msg.payload.ts}}","layout":"row-spread","x":370,"y":280,"wires":[]},{"id":"f9fd6c75.b9b3f","type":"ui_text","z":"35de9dbd.00d22a","group":"98e50627.d5922","order":0,"width":0,"height":0,"name":"","label":"TS","format":"{{msg.payload.ts}}","layout":"row-spread","x":370,"y":420,"wires":[]},{"id":"bfc7a51e.3b96f8","type":"inject","z":"9ed094d3.78c7f","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":180,"y":1038,"wires":[["841fbe0e.9246c8"]]},{"id":"841fbe0e.9246c8","type":"function","z":"9ed094d3.78c7f","name":"setCandleMode=Jump=02","func":"var newmsg = {\"cmd\" : \"setcolor\",\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":2,\n\"speed1\":9,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":400,"y":1040,"wires":[["8a93d332.3e383"]]},{"id":"4883adee.b101cc","type":"function","z":"9ed094d3.78c7f","name":"SetColorGreen","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":540,"y":380,"wires":[["b2e9cae3.0ee4a8"]]},{"id":"9d36f942.128fc","type":"function","z":"9ed094d3.78c7f","name":"SetColorRed","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":530,"y":220,"wires":[["b2e9cae3.0ee4a8","768f84cb.686244"]]},{"id":"c976b6c.f575948","type":"inject","z":"9ed094d3.78c7f","name":"Test","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":170,"y":220,"wires":[["9d36f942.128fc"]]},{"id":"1a84427d.a95f66","type":"ibmiot out","z":"9ed094d3.78c7f","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb40","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"toPiCandle","service":"registered","x":930,"y":380,"wires":[]},{"id":"8a93d332.3e383","type":"ibmiot out","z":"9ed094d3.78c7f","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb40","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"toPiCandle","service":"registered","x":650,"y":1040,"wires":[]},{"id":"7659450c.2aeb04","type":"function","z":"9ed094d3.78c7f","name":"TS","func":"msg.payload ={}\nmsg.payload.value  = 1 \nmsg.payload.status = \"broken\"\nmsg.payload.ts = Date.now();\nreturn msg;","outputs":1,"noerr":0,"x":230,"y":360,"wires":[["c91c1872.0f2e98"]]},{"id":"eca9867f.e5646","type":"inject","z":"9ed094d3.78c7f","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":100,"y":360,"wires":[["7659450c.2aeb04"]]},{"id":"23df5319.f4b8a4","type":"function","z":"9ed094d3.78c7f","name":"TS","func":"msg.payload ={}\nmsg.payload.value  = 1 \nmsg.payload.status = \"broken\"\nmsg.payload.ts = Date.now();\nreturn msg;","outputs":1,"noerr":0,"x":230,"y":400,"wires":[["25aa2e4c.4d58c2"]]},{"id":"8cc8f918.003ec8","type":"inject","z":"9ed094d3.78c7f","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":100,"y":400,"wires":[["23df5319.f4b8a4"]]},{"id":"772d6e67.046e98","type":"comment","z":"9ed094d3.78c7f","name":"This is the UI (Grey)","info":"","x":760,"y":560,"wires":[]},{"id":"f67b1940.5f7f38","type":"comment","z":"9ed094d3.78c7f","name":"Adjust Calculation ","info":"","x":150,"y":560,"wires":[]},{"id":"b2e9cae3.0ee4a8","type":"delay","z":"9ed094d3.78c7f","name":"","pauseType":"delay","timeout":"100","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":730,"y":380,"wires":[["1a84427d.a95f66"]]},{"id":"768f84cb.686244","type":"debug","z":"9ed094d3.78c7f","name":"Pings","active":true,"console":false,"complete":"payload","x":730,"y":220,"wires":[]},{"id":"4e1f1d0f.5815c4","type":"inject","z":"9ed094d3.78c7f","name":"Send Data","topic":"","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"x":180,"y":1120,"wires":[["9dd012cd.11e07"]]},{"id":"9dd012cd.11e07","type":"function","z":"9ed094d3.78c7f","name":"ArmBACK","func":"\n\n// Counter to select from array.\nvar counter1 = context.get('counter1')||0;\ncounter1 = counter1+1;\nif(counter1 > 999) counter1 = 0;\ncontext.set('counter1',counter1);\n\n// Create MQTT message in JSON\nmsg = {\n  payload: \n    {\n      d:{\n          \"action\" : \"armBACK\",  \n          \"motorSpin\": 500, // Range is 500 to 20000\n          \"counter\" : counter1\n\n      }\n    }\n  \n};\nmsg.eventOrCommandType = \"armBACK\";\nreturn msg;\n","outputs":1,"noerr":0,"x":374,"y":1122,"wires":[["8a93d332.3e383"]]},{"id":"c989ae73.88364","type":"function","z":"9ed094d3.78c7f","name":"ArmForward","func":"\n\n// Counter to select from array.\nvar counter1 = context.get('counter1')||0;\ncounter1 = counter1+1;\nif(counter1 > 999) counter1 = 0;\ncontext.set('counter1',counter1);\n\n// Create MQTT message in JSON\nmsg = {\n  payload: \n    {\n      d:{\n          \"action\" : \"armFORWARD\",  \n          \"motorSpin\": 2000, // Range is 500 to 20000\n\n          \"counter\" : counter1\n\n      }\n    }\n  \n};\nmsg.eventOrCommandType = \"armFORWARD\";\nreturn msg;\n","outputs":1,"noerr":0,"x":364.77777099609375,"y":1167.2222290039062,"wires":[["8a93d332.3e383"]]},{"id":"d38f7608.e6e54","type":"inject","z":"9ed094d3.78c7f","name":"Send Data","topic":"","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"x":171.77777099609375,"y":1167.2222290039062,"wires":[["c989ae73.88364"]]},{"id":"47d9c2a8.bf01d4","type":"function","z":"9ed094d3.78c7f","name":"ArmWAVE","func":"\n// Counter to select from array.\nvar counter1 = context.get('counter1')||0;\ncounter1 = counter1+1;\nif(counter1 > 999) counter1 = 0;\ncontext.set('counter1',counter1);\n\n// Create MQTT message in JSON\nmsg = {\n  payload: \n    {\n      d:{\n          \"action\" : \"armWAVE\",  \n          \"counter\" : counter1\n      }\n    }\n  \n};\nmsg.eventOrCommandType = \"armWAVE\";\nreturn msg;\n","outputs":1,"noerr":0,"x":359,"y":1259.3333129882812,"wires":[[]]},{"id":"61eeec2f.3bfacc","type":"inject","z":"9ed094d3.78c7f","name":"Send Data","topic":"","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"x":172,"y":1259.3333129882812,"wires":[["47d9c2a8.bf01d4"]]},{"id":"5f3001d.d1ebb","type":"function","z":"9ed094d3.78c7f","name":"ArmMove500","func":"\n// Counter to select from array.\nvar counter1 = context.get('counter1')||0;\ncounter1 = counter1+1;\nif(counter1 > 999) counter1 = 0;\ncontext.set('counter1',counter1);\n\n// Create MQTT message in JSON\nvar msg = {\n  payload:  //JSON.stringify(\n    {\n      d:{\n        \"action\" : \"armMOVE\", \n        \"motorSpin\": 850, // Range is 500 to 2000\n        \"counter\" : counter1\n      }\n    }\n\n};\nmsg.eventOrCommandType = \"armMOVE\";\nreturn msg;\n","outputs":1,"noerr":0,"x":355,"y":1352,"wires":[["8a93d332.3e383"]]},{"id":"8b8ffe70.274de","type":"inject","z":"9ed094d3.78c7f","name":"Send Data","topic":"","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"x":163,"y":1351,"wires":[["5f3001d.d1ebb"]]},{"id":"73ef411b.fa844","type":"function","z":"9ed094d3.78c7f","name":"ArmMove2000","func":"\n// Counter to select from array.\nvar counter1 = context.get('counter1')||0;\ncounter1 = counter1+1;\nif(counter1 > 999) counter1 = 0;\ncontext.set('counter1',counter1);\n\n// Create MQTT message in JSON\nvar msg = {\n  payload:  //JSON.stringify(\n    {\n      d:{\n        \"action\" : \"armMOVE\", \n        \"motorSpin\": 2000, // Range is 500 to 2000\n          \"counter\" : counter1\n      }\n    }\n\n};\nmsg.eventOrCommandType = \"armMOVE\";\nreturn msg;\n","outputs":1,"noerr":0,"x":355.2222595214844,"y":1387.5555725097656,"wires":[["8a93d332.3e383"]]},{"id":"b05b6b71.bec78","type":"inject","z":"9ed094d3.78c7f","name":"Send Data","topic":"","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"x":160.77780151367188,"y":1383.1111145019531,"wires":[["73ef411b.fa844"]]},{"id":"c9f65134.fe2228","type":"function","z":"9ed094d3.78c7f","name":"ArmUP","func":"\n\n// Counter to select from array.\nvar counter1 = context.get('counter1')||0;\ncounter1 = counter1+1;\nif(counter1 > 999) counter1 = 0;\ncontext.set('counter1',counter1);\n\n// Create MQTT message in JSON\nmsg = {\n  payload: \n    {\n      d:{\n          \"action\" : \"armUP\",  \n          \"motorSpin\": 1500, // Range is 500 to 20000\n\n          \"counter\" : counter1\n\n      }\n    }\n  \n};\nmsg.eventOrCommandType = \"armUP\";\nreturn msg;\n","outputs":1,"noerr":0,"x":346.3333740234375,"y":1207.5555419921875,"wires":[["8a93d332.3e383"]]},{"id":"807bf2e0.4629","type":"inject","z":"9ed094d3.78c7f","name":"Send Data","topic":"","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"x":163.3333740234375,"y":1207.5555419921875,"wires":[["c9f65134.fe2228"]]},{"id":"a2002f56.ae4c2","type":"ibmiot in","z":"45875fc0.f9d9d8","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb01","applicationId":"","deviceType":"+","eventType":"IR1","commandType":"","format":"json","name":"IR Events From PI - adjust name","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":"","qos":0,"x":4190,"y":4040,"wires":[["86fa64d2.b6b52"]]},{"id":"fab183f8.6fb86","type":"ibmiot in","z":"45875fc0.f9d9d8","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb01","applicationId":"","deviceType":"+","eventType":"+","commandType":"","format":"json","name":"IR Events From PI - adjust name","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":"","qos":0,"x":4190,"y":4100,"wires":[["bd85cd15.6a757"]]},{"id":"bd85cd15.6a757","type":"debug","z":"45875fc0.f9d9d8","name":"Pings","active":true,"console":false,"complete":"payload","x":4450,"y":4100,"wires":[]},{"id":"ce55cd21.bc3e9","type":"debug","z":"45875fc0.f9d9d8","name":"Touch","active":true,"console":false,"complete":"payload","x":4650,"y":4040,"wires":[]},{"id":"86fa64d2.b6b52","type":"switch","z":"45875fc0.f9d9d8","name":"","property":"payload.value","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"else"}],"checkall":"true","outputs":2,"x":4450,"y":4040,"wires":[["ce55cd21.bc3e9"],[]]},{"id":"42a1d0d3.ee87a","type":"ibmiot in","z":"45875fc0.f9d9d8","authentication":"boundService","apiKey":"c124f11f.5449a8","inputType":"evt","deviceId":"playbulb01","applicationId":"","deviceType":"+","eventType":"IR1","commandType":"","format":"json","name":"IR1","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":true,"qos":0,"x":4110,"y":4220,"wires":[["274812d0.bd72d6"]]},{"id":"274812d0.bd72d6","type":"switch","z":"45875fc0.f9d9d8","name":"","property":"payload.status","propertyType":"msg","rules":[{"t":"eq","v":"broken","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":4290,"y":4220,"wires":[["7b772dc7.52066c","4a6e8afd.18ebdc","b2b29fa4.6d065"],[]]},{"id":"4a6e8afd.18ebdc","type":"function","z":"45875fc0.f9d9d8","name":"Set IR1","func":"isset =  global.get(\"ir1set\")\nif(msg.payload.value == 1 )\nif(isset)\n{\nnode.warn(\"Already set\")    \n\n}else{\n\n\n\n    global.set(\"ir1time\",msg.payload.ts)\n    global.set(\"ir1set\",true)\n    node.warn(\" setting time\")    \n\n}\n\n\nreturn msg;","outputs":1,"noerr":0,"x":4360,"y":4280,"wires":[[]]},{"id":"89d6a9fd.b7607","type":"ibmiot in","z":"45875fc0.f9d9d8","authentication":"boundService","apiKey":"c124f11f.5449a8","inputType":"evt","deviceId":"playbulb01","applicationId":"","deviceType":"+","eventType":"IR2","commandType":"","format":"json","name":"IR2","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":true,"qos":0,"x":4110,"y":4380,"wires":[["c4198bfc.b285"]]},{"id":"c4198bfc.b285","type":"switch","z":"45875fc0.f9d9d8","name":"","property":"payload.status","propertyType":"msg","rules":[{"t":"eq","v":"broken","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":4310,"y":4380,"wires":[["1ca3c707.16d011","3974c9a8.4718c6","cc237180.867e28"],[]]},{"id":"3974c9a8.4718c6","type":"function","z":"45875fc0.f9d9d8","name":"Set IR2 - Calulate SPEED - Adjust","func":"isset =  global.get(\"ir1set\")\nkph=0\nkmh=0\nif(msg.payload.value == 1 )\nif(isset)\n{\n  //  node.warn(\"IR2 set\") \n global.set(\"ir2time\",msg.payload.ts)\n global.set(\"ir1set\",false)\n \n starttime = global.get(\"ir1time\")\n endtime = global.get(\"ir2time\")\n  mytime=endtime-starttime;\n node.warn(\"Time diff in millisec = \"+mytime)\n  \n   \n // Speed calculator\n //distance\nvar ms = 0\n  \nvar distcm = 15  //DEFINE Distance 2\nnode.warn(\"Distance in CM = \"+distcm)\n\tms = ((distcm/100) / (mytime/1000))\n  \tkph = (ms * 3.6)  \n  \t\n  \tkmh = (distcm/(mytime/1000))  * 0.036\n\n   \tnode.warn(\"SPEED in kmh = \"+kmh.toFixed(4)) \n // \tnode.warn(\"SPEED in kph = \"+kph.toFixed(4)) \n\tnode.warn(\"SPEED in ms = \"+ms.toFixed(4))\n\n\n}else{\n    node.warn(\"IR1 not set\") \n}\nmsg.payload.speedms = ms //ms.toFixed(4)\nmsg.payload.speedkmh = kph.toFixed(4)\nmsg.payload.speedkmh2 = kmh.toFixed(4)\nmsg.payload.distcm = distcm;\nmsg.payload.distm = (distcm/100);\nmsg.payload.timemm = mytime\nreturn msg;","outputs":1,"noerr":0,"x":4220,"y":4440,"wires":[["c6eb8431.028de","871613e4.0208c","4390e8bd.fcf2a8","e9ea7f58.1944a8","599b7005.56d33","f6501ce8.d1e2d8","2dcac833.44803"]]},{"id":"7b772dc7.52066c","type":"debug","z":"45875fc0.f9d9d8","name":"IR1-Broken","active":true,"console":false,"complete":"payload","x":4490,"y":4200,"wires":[]},{"id":"1ca3c707.16d011","type":"debug","z":"45875fc0.f9d9d8","name":"IR2-Broken","active":true,"console":false,"complete":"payload","x":4490,"y":4360,"wires":[]},{"id":"c6eb8431.028de","type":"debug","z":"45875fc0.f9d9d8","name":"Speed","active":true,"console":false,"complete":"true","x":4470,"y":4440,"wires":[]},{"id":"3672d63e.952b7a","type":"ui_chart","z":"45875fc0.f9d9d8","name":"","group":"d693cf3.3482fb","order":1,"width":0,"height":0,"label":"Speed History","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"-2","ymax":"5","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"60","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":2,"x":4500,"y":4820,"wires":[[],[]]},{"id":"871613e4.0208c","type":"ui_text","z":"45875fc0.f9d9d8","group":"da747b62.eb4ea8","order":1,"width":0,"height":0,"name":"","label":"SpeedKmH","format":"{{msg.payload.speedkmh}}","layout":"row-spread","x":4490,"y":4540,"wires":[]},{"id":"4390e8bd.fcf2a8","type":"ui_text","z":"45875fc0.f9d9d8","group":"da747b62.eb4ea8","order":2,"width":0,"height":0,"name":"","label":"Time","format":"{{msg.payload.timemm}}","layout":"row-spread","x":4470,"y":4660,"wires":[]},{"id":"4c64a682.88b94","type":"ibmiot out","z":"45875fc0.f9d9d8","authentication":"boundService","apiKey":"435b5a39.a47004","outputType":"evt","deviceId":"playbulb00","deviceType":"playbulb","eventCommandType":"dashboard","format":"json","data":"playload","qos":0,"name":"toMarkusDashBoard","service":"registered","x":4720,"y":4400,"wires":[]},{"id":"e9ea7f58.1944a8","type":"function","z":"45875fc0.f9d9d8","name":"","func":"msg.payload.event = \"dashboard\"\nmsg.payload.deviceId =  msg.deviceId\ndelete msg.eventType\ndelete msg.topic\ndelete msg.deviceId\nreturn msg;","outputs":1,"noerr":0,"x":4470,"y":4400,"wires":[["4c64a682.88b94"]]},{"id":"599b7005.56d33","type":"ui_text","z":"45875fc0.f9d9d8","group":"d693cf3.3482fb","order":4,"width":0,"height":0,"name":"","label":"TS","format":"{{msg.payload.ts}}","layout":"row-spread","x":4470,"y":4700,"wires":[]},{"id":"f6501ce8.d1e2d8","type":"function","z":"45875fc0.f9d9d8","name":"Mapping","func":"msg.payload = msg.payload.speedkmh\nreturn msg;","outputs":1,"noerr":0,"x":4320,"y":4500,"wires":[["9e77126f.e11ef8","b7142687.562da","83313c47.04068","3672d63e.952b7a"]]},{"id":"9e77126f.e11ef8","type":"ui_gauge","z":"45875fc0.f9d9d8","name":"","group":"da747b62.eb4ea8","order":3,"width":0,"height":0,"gtype":"gage","title":"Speed Km/H","label":"units","format":"{{value}}","min":0,"max":"5","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":4490,"y":4500,"wires":[]},{"id":"2dcac833.44803","type":"ui_text","z":"45875fc0.f9d9d8","group":"da747b62.eb4ea8","order":4,"width":0,"height":0,"name":"","label":"Speedms","format":"{{msg.payload.speedms}}","layout":"row-spread","x":4480,"y":4580,"wires":[]},{"id":"b7142687.562da","type":"ui_text","z":"45875fc0.f9d9d8","group":"d693cf3.3482fb","order":2,"width":0,"height":0,"name":"","label":"Distance","format":"{{msg.payload.distcm}}","layout":"row-spread","x":4480,"y":4620,"wires":[]},{"id":"83313c47.04068","type":"ui_text","z":"45875fc0.f9d9d8","group":"d693cf3.3482fb","order":3,"width":0,"height":0,"name":"","label":"Device","format":"{{msg.deviceId}}","layout":"row-spread","x":4470,"y":4760,"wires":[]},{"id":"81af609b.675f5","type":"inject","z":"45875fc0.f9d9d8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":4140,"y":4978,"wires":[["da5c6183.4f90a8"]]},{"id":"da5c6183.4f90a8","type":"function","z":"45875fc0.f9d9d8","name":"setCandleMode=Jump=02","func":"var newmsg = {\"cmd\" : \"setcolor\",\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":2,\n\"speed1\":9,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":4360,"y":4980,"wires":[[]]},{"id":"cc237180.867e28","type":"function","z":"45875fc0.f9d9d8","name":"SetColorGreen","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":4500,"y":4320,"wires":[["d070c7e5.969d9"]]},{"id":"b2b29fa4.6d065","type":"function","z":"45875fc0.f9d9d8","name":"SetColorRed","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":4490,"y":4240,"wires":[["d070c7e5.969d9"]]},{"id":"a7763e50.5fff6","type":"inject","z":"45875fc0.f9d9d8","name":"Test","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":4270,"y":4180,"wires":[["b2b29fa4.6d065"]]},{"id":"d070c7e5.969d9","type":"ibmiot out","z":"45875fc0.f9d9d8","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb01","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"toPiCandle","service":"registered","x":4690,"y":4240,"wires":[]},{"id":"e269a756.6c9fa8","type":"ibmiot in","z":"45875fc0.f9d9d8","authentication":"apiKey","apiKey":"b88ccd4c.e1477","inputType":"evt","deviceId":"SPEAKER","applicationId":"","deviceType":"+","eventType":"+","commandType":"","format":"json","name":"IBM IoT","service":"registered","allDevices":true,"allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":"","qos":0,"x":90,"y":240,"wires":[["e0024116.f8d888","d88c1f22.c5a48","42b82b3f.2e01b4"]]},{"id":"e0024116.f8d888","type":"debug","z":"45875fc0.f9d9d8","name":"","active":false,"console":"false","complete":"false","x":300,"y":240,"wires":[]},{"id":"15f0fca2.9d9043","type":"comment","z":"45875fc0.f9d9d8","name":"API Key","info":"a-pv9rgd-napcg86llh","x":250,"y":120,"wires":[]},{"id":"c14b6901.e35e48","type":"comment","z":"45875fc0.f9d9d8","name":"Authentication Token","info":"_oA1ty!bx&Xt&E-lkl","x":310,"y":160,"wires":[]},{"id":"d88c1f22.c5a48","type":"change","z":"45875fc0.f9d9d8","name":"payload to angle","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.d.oa","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":410,"y":460,"wires":[["950cde9a.7e93","4cddabdd.0ecf1c","8fcf754.a423508","dcead1c4.141d38"]]},{"id":"950cde9a.7e93","type":"debug","z":"45875fc0.f9d9d8","name":"","active":false,"console":false,"complete":"false","x":560,"y":400,"wires":[]},{"id":"4cddabdd.0ecf1c","type":"ui_gauge","z":"45875fc0.f9d9d8","name":"","group":"5920217a.6f9eb8","order":0,"width":0,"height":0,"gtype":"compass","title":"Compass","label":"degrees","format":"{{value | number:1}}","min":0,"max":"360","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":760,"y":460,"wires":[]},{"id":"8fcf754.a423508","type":"switch","z":"45875fc0.f9d9d8","name":"Direction","property":"payload","propertyType":"msg","rules":[{"t":"btwn","v":"0","vt":"num","v2":"45","v2t":"num"},{"t":"btwn","v":"315","vt":"num","v2":"360","v2t":"num"},{"t":"btwn","v":"45","vt":"num","v2":"135","v2t":"num"},{"t":"btwn","v":"135","vt":"num","v2":"225","v2t":"num"},{"t":"btwn","v":"225","vt":"num","v2":"315","v2t":"num"}],"checkall":"true","outputs":5,"x":420,"y":560,"wires":[["b77bcf67.027448"],["b77bcf67.027448"],["5355191d.844cb"],["f9a368d3.139e28"],["dd693494.014ad8"]]},{"id":"b77bcf67.027448","type":"template","z":"45875fc0.f9d9d8","name":"North","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"North","output":"str","x":610,"y":520,"wires":[["d28d829a.3aa01"]]},{"id":"5355191d.844cb","type":"template","z":"45875fc0.f9d9d8","name":"East","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"East","output":"str","x":610,"y":560,"wires":[["d28d829a.3aa01"]]},{"id":"dd693494.014ad8","type":"template","z":"45875fc0.f9d9d8","name":"West","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"West","output":"str","x":610,"y":640,"wires":[["d28d829a.3aa01"]]},{"id":"f9a368d3.139e28","type":"template","z":"45875fc0.f9d9d8","name":"South","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"South","output":"str","x":610,"y":600,"wires":[["d28d829a.3aa01"]]},{"id":"d28d829a.3aa01","type":"ui_text","z":"45875fc0.f9d9d8","group":"5920217a.6f9eb8","order":0,"width":0,"height":0,"name":"","label":"Direction","format":"{{msg.payload}}","layout":"row-spread","x":770,"y":580,"wires":[]},{"id":"41475dbc.d441bc","type":"comment","z":"45875fc0.f9d9d8","name":"User interface to display a compass based on reading from the BlueCoin","info":"","x":350,"y":340,"wires":[]},{"id":"9fc7566e.c9cf8","type":"ui_gauge","z":"45875fc0.f9d9d8","name":"","group":"5920217a.6f9eb8","order":0,"width":0,"height":0,"gtype":"gage","title":"userVaue","label":"units","format":"{{value}}","min":0,"max":"100","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":600,"y":180,"wires":[]},{"id":"42b82b3f.2e01b4","type":"function","z":"45875fc0.f9d9d8","name":"","func":"msg.payload = msg.payload.d.userValue\nreturn msg;","outputs":1,"noerr":0,"x":300,"y":200,"wires":[["9fc7566e.c9cf8"]]},{"id":"dcead1c4.141d38","type":"ui_chart","z":"45875fc0.f9d9d8","name":"","group":"5920217a.6f9eb8","order":0,"width":0,"height":0,"label":"Angel","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":2,"x":750,"y":400,"wires":[[],[]]},{"id":"f8ab092.0db09f8","type":"ibmiot out","z":"45875fc0.f9d9d8","authentication":"apiKey","apiKey":"8aa622b4.5833a8","outputType":"cmd","deviceId":"Markus","deviceType":"iotphone","eventCommandType":"BLINK","format":"json","data":"message.event","qos":"","name":"iotphone","service":"registered","x":820,"y":780,"wires":[]},{"id":"4b6ca7d9.5ef3e","type":"function","z":"45875fc0.f9d9d8","name":"SendComand","func":"\nvar now = ( new Date() ).getTime();\nvar col =  \"#\"+Math.random().toString(16).slice(-6);\nvar newMsg = {\"d\":{\n    \"myName\":\"BLINK\",\n    \"Action\" : 33,\n    \"Color\" : col,\n    \"Special\"  : \"Breath\",\n    \"userValue\": (Math.random() * (100 - 5 + 1) | 0) + 5,\n    \"deviceid\":  \"Markus\",\n    \"msgsent\": 1,\n    \"devices\":  1,\n    \"ts\" : now\n    }};\n//msg.payload.d.myName = \"MarkusViaNodeRed\";\n//msg.payload.d.Color = col;\n\n//msg.payload = JSON.stringify(newMsg);\n\n\nmsg.payload = newMsg\nreturn  msg;","outputs":1,"noerr":0,"x":600,"y":780,"wires":[["f8ab092.0db09f8","3179025f.e139c6"]]},{"id":"7112ca1b.04fd14","type":"inject","z":"45875fc0.f9d9d8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":220,"y":780,"wires":[["4b6ca7d9.5ef3e"]]},{"id":"3179025f.e139c6","type":"debug","z":"45875fc0.f9d9d8","name":"","active":true,"console":"false","complete":"true","x":810,"y":740,"wires":[]},{"id":"75e20503.4ab404","type":"ibmiot out","z":"8b8e23ad.69ebc","authentication":"boundService","apiKey":"6e106082.5c7b98","outputType":"cmd","deviceId":"playbulb23","deviceType":"playbulb","eventCommandType":"setLED1off","format":"json","data":"payload","qos":0,"name":"playbulb23","service":"registered","x":950,"y":540,"wires":[]},{"id":"e4c3ef13.d59da","type":"function","z":"8b8e23ad.69ebc","name":"LEDOnViaGPIO7","func":"var newmsg = {\"cmd\" : \"setGPIOon\",\n\"level\":1,\n\"gpio\":7,\n\"setGPIOon\":7,\n}\nmsg.eventOrCommandType = \"setGPIOon\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":760,"y":540,"wires":[["75e20503.4ab404","6eef11c6.99793"]]},{"id":"ee19393d.38ac4","type":"inject","z":"8b8e23ad.69ebc","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":520,"y":540,"wires":[["e4c3ef13.d59da"]]},{"id":"6eef11c6.99793","type":"debug","z":"8b8e23ad.69ebc","name":"","active":true,"console":"false","complete":"false","x":860,"y":620,"wires":[]},{"id":"6d43f9ae.5ff52","type":"function","z":"8b8e23ad.69ebc","name":"LEDOffViaGPIO7","func":"var newmsg = {\"cmd\" : \"setGPIO\",\n\"level\":0,\n\"gpio\":7,\n\"setGPIO\":7,\n}\nmsg.eventOrCommandType = \"setGPIO\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":750,"y":480,"wires":[["75e20503.4ab404"]]},{"id":"1e683f6d.2055d9","type":"inject","z":"8b8e23ad.69ebc","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":510,"y":480,"wires":[["6d43f9ae.5ff52"]]},{"id":"b4164595.32327","type":"ibmiot out","z":"8b8e23ad.69ebc","authentication":"boundService","apiKey":"6e106082.5c7b98","outputType":"cmd","deviceId":"playbulb23","deviceType":"playbulb","eventCommandType":"setLED1off","format":"json","data":"payload","qos":0,"name":"playbulb23","service":"registered","x":970,"y":760,"wires":[]},{"id":"46785a92.46dba4","type":"function","z":"8b8e23ad.69ebc","name":"LEDOnViaGPIO8","func":"var newmsg = {\"cmd\" : \"setGPIO\",\n\"level\":1,\n\"gpio\":8,\n\"setGPIOon\":7,\n}\nmsg.eventOrCommandType = \"setGPIO\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":780,"y":760,"wires":[["b4164595.32327","4ff63ca4.263c14"]]},{"id":"4f1d2964.c5a58","type":"inject","z":"8b8e23ad.69ebc","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":540,"y":760,"wires":[["46785a92.46dba4"]]},{"id":"4ff63ca4.263c14","type":"debug","z":"8b8e23ad.69ebc","name":"","active":true,"console":"false","complete":"false","x":880,"y":840,"wires":[]},{"id":"b3a77983.2cb1d","type":"function","z":"8b8e23ad.69ebc","name":"LEDOffViaGPIO8","func":"var newmsg = {\"cmd\" : \"setGPIO\",\n\"level\":0,\n\"gpio\":8,\n\"setGPIO\":8\n}\nmsg.eventOrCommandType = \"setGPIO\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":770,"y":700,"wires":[["b4164595.32327"]]},{"id":"f3d690b2.1b735","type":"inject","z":"8b8e23ad.69ebc","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":530,"y":700,"wires":[["b3a77983.2cb1d"]]},{"id":"c2732eb9.719be8","type":"ibmiot out","z":"8b8e23ad.69ebc","authentication":"boundService","apiKey":"6e106082.5c7b98","outputType":"cmd","deviceId":"playbulb23","deviceType":"playbulb","eventCommandType":"setLED1off","format":"json","data":"payload","qos":0,"name":"playbulb23","service":"registered","x":930,"y":960,"wires":[]},{"id":"7302b07a.fca39","type":"function","z":"8b8e23ad.69ebc","name":"LEDOnViaGPIO8","func":"var newmsg = {\"cmd\" : \"setGPIO\",\n\"level\":1,\n\"gpio\":25,\n\"setGPIO\":25\n}\nmsg.eventOrCommandType = \"setGPIO\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":740,"y":960,"wires":[["c2732eb9.719be8","953958df.5c1eb8"]]},{"id":"4b830de1.c5e3c4","type":"inject","z":"8b8e23ad.69ebc","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":500,"y":960,"wires":[["7302b07a.fca39"]]},{"id":"953958df.5c1eb8","type":"debug","z":"8b8e23ad.69ebc","name":"","active":true,"console":"false","complete":"false","x":840,"y":1040,"wires":[]},{"id":"38112746.69f608","type":"function","z":"8b8e23ad.69ebc","name":"LEDOffViaGPIO25","func":"var newmsg = {\"cmd\" : \"setGPIO\",\n\"level\":0,\n\"gpio\":25,\n\"setGPIO\":25\n}\nmsg.eventOrCommandType = \"setGPIO\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":730,"y":900,"wires":[["c2732eb9.719be8"]]},{"id":"fa65b98.a6ba3c8","type":"inject","z":"8b8e23ad.69ebc","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":490,"y":900,"wires":[["38112746.69f608"]]},{"id":"49e2e134.194af8","type":"ibmiot in","z":"8b8e23ad.69ebc","authentication":"boundService","apiKey":"6e106082.5c7b98","inputType":"evt","deviceId":"playbulb23","applicationId":"","deviceType":"+","eventType":"BUTTON","commandType":"","format":"json","name":"Change playbulb??","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":true,"qos":0,"x":190,"y":1160,"wires":[["92dac8ed.25d9f"]]},{"id":"92dac8ed.25d9f","type":"debug","z":"8b8e23ad.69ebc","name":"","active":true,"console":"false","complete":"false","x":430,"y":1160,"wires":[]},{"id":"9cb0d78b.d4e828","type":"ibmiot out","z":"1cc1a934.f301e7","authentication":"boundService","apiKey":"6e106082.5c7b98","outputType":"cmd","deviceId":"playbulb23","deviceType":"playbulb","eventCommandType":"setLED1off","format":"json","data":"payload","qos":0,"name":"playbulb23","service":"registered","x":1060,"y":240,"wires":[]},{"id":"8e91640c.a722e","type":"function","z":"1cc1a934.f301e7","name":"LEDOnViaGPIO7","func":"var newmsg = {\"cmd\" : \"setGPIOon\",\n\"level\":1,\n\"gpio\":7,\n\"setGPIOon\":7,\n}\nmsg.eventOrCommandType = \"setGPIOon\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":870,"y":240,"wires":[["9cb0d78b.d4e828","9e8813af.c6a8a"]]},{"id":"3093f208.0c5fbe","type":"inject","z":"1cc1a934.f301e7","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":630,"y":240,"wires":[["8e91640c.a722e"]]},{"id":"9e8813af.c6a8a","type":"debug","z":"1cc1a934.f301e7","name":"","active":true,"console":"false","complete":"false","x":970,"y":320,"wires":[]},{"id":"70d59ba1.4a8754","type":"function","z":"1cc1a934.f301e7","name":"LEDOffViaGPIO7","func":"var newmsg = {\"cmd\" : \"setGPIO\",\n\"level\":0,\n\"gpio\":7,\n\"setGPIO\":7,\n}\nmsg.eventOrCommandType = \"setGPIO\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":860,"y":180,"wires":[["9cb0d78b.d4e828"]]},{"id":"1d0950d0.d410c7","type":"inject","z":"1cc1a934.f301e7","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":620,"y":180,"wires":[["70d59ba1.4a8754"]]},{"id":"dc3fd14e.2242b","type":"ibmiot out","z":"1cc1a934.f301e7","authentication":"boundService","apiKey":"6e106082.5c7b98","outputType":"cmd","deviceId":"playbulb23","deviceType":"playbulb","eventCommandType":"setLED1off","format":"json","data":"payload","qos":0,"name":"playbulb23","service":"registered","x":1080,"y":460,"wires":[]},{"id":"63f9bed.ca1b2c","type":"function","z":"1cc1a934.f301e7","name":"LEDOnViaGPIO8","func":"var newmsg = {\"cmd\" : \"setGPIO\",\n\"level\":1,\n\"gpio\":8,\n\"setGPIOon\":7,\n}\nmsg.eventOrCommandType = \"setGPIO\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":890,"y":460,"wires":[["dc3fd14e.2242b","c5e59153.2a6e68"]]},{"id":"d4785bb8.b68bf","type":"inject","z":"1cc1a934.f301e7","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":650,"y":460,"wires":[["63f9bed.ca1b2c"]]},{"id":"c5e59153.2a6e68","type":"debug","z":"1cc1a934.f301e7","name":"","active":true,"console":"false","complete":"false","x":990,"y":540,"wires":[]},{"id":"b065caf.f474538","type":"function","z":"1cc1a934.f301e7","name":"LEDOffViaGPIO8","func":"var newmsg = {\"cmd\" : \"setGPIO\",\n\"level\":0,\n\"gpio\":8,\n\"setGPIO\":8\n}\nmsg.eventOrCommandType = \"setGPIO\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":880,"y":400,"wires":[["dc3fd14e.2242b"]]},{"id":"9e8e7bb6.3de69","type":"inject","z":"1cc1a934.f301e7","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":640,"y":400,"wires":[["b065caf.f474538"]]},{"id":"fbce674d.aec15","type":"ibmiot out","z":"1cc1a934.f301e7","authentication":"boundService","apiKey":"6e106082.5c7b98","outputType":"cmd","deviceId":"playbulb23","deviceType":"playbulb","eventCommandType":"setLED1off","format":"json","data":"payload","qos":0,"name":"playbulb23","service":"registered","x":1070,"y":600,"wires":[]},{"id":"79890901.e5dbf","type":"function","z":"1cc1a934.f301e7","name":"LEDOnViaGPIO12","func":"var newmsg = {\"cmd\" : \"setGPIO\",\n\"level\":1,\n\"gpio\":12,\n\"setGPIO\":12\n}\nmsg.eventOrCommandType = \"setGPIO\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":850,"y":660,"wires":[["fbce674d.aec15","cd5ca43f.ec5808"]]},{"id":"c6d3fb8f.5c839","type":"inject","z":"1cc1a934.f301e7","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":610,"y":660,"wires":[["79890901.e5dbf"]]},{"id":"cd5ca43f.ec5808","type":"debug","z":"1cc1a934.f301e7","name":"gpio25","active":true,"console":"false","complete":"payload","x":1050,"y":660,"wires":[]},{"id":"bca6c8bf.c0c52","type":"function","z":"1cc1a934.f301e7","name":"LEDOffViaGPIO12","func":"var newmsg = {\"cmd\" : \"setGPIO\",\n\"level\":0,\n\"gpio\":12,\n\"setGPIO\":12\n}\nmsg.eventOrCommandType = \"setGPIO\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":840,"y":600,"wires":[["fbce674d.aec15"]]},{"id":"52080b14.2064a4","type":"inject","z":"1cc1a934.f301e7","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":600,"y":600,"wires":[["bca6c8bf.c0c52"]]},{"id":"34b3b2d5.c9bd86","type":"ibmiot in","z":"1cc1a934.f301e7","authentication":"boundService","apiKey":"6e106082.5c7b98","inputType":"evt","deviceId":"playbulb23","applicationId":"","deviceType":"+","eventType":"BUTTON","commandType":"","format":"json","name":"Change playbulb??","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":true,"qos":0,"x":150,"y":420,"wires":[["f26c5328.9d50c8"]]},{"id":"5b2a012c.f60ff8","type":"debug","z":"1cc1a934.f301e7","name":"","active":false,"console":"false","complete":"payload","x":390,"y":420,"wires":[]},{"id":"ba0fea91.ed49b8","type":"ibmiot in","z":"1cc1a934.f301e7","authentication":"boundService","apiKey":"6e106082.5c7b98","inputType":"evt","deviceId":"playbulb23","applicationId":"","deviceType":"+","eventType":"ping","commandType":"","format":"json","name":"Change playbulb??","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":true,"qos":0,"x":150,"y":100,"wires":[["154267c2.1b218","4dd053bc.dc36cc"]]},{"id":"154267c2.1b218","type":"function","z":"1cc1a934.f301e7","name":"SaveLastPing","func":"global.set(\"lastping\",msg)\nreturn msg;","outputs":1,"noerr":0,"x":400,"y":100,"wires":[[]]},{"id":"4dd053bc.dc36cc","type":"debug","z":"1cc1a934.f301e7","name":"","active":false,"console":"false","complete":"false","x":130,"y":160,"wires":[]},{"id":"95150227.c897d","type":"inject","z":"1cc1a934.f301e7","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":140,"y":800,"wires":[["8b39a7d5.a9c208"]]},{"id":"8b39a7d5.a9c208","type":"function","z":"1cc1a934.f301e7","name":"getLastPing","func":"var newmsg = global.get(\"lastping\")\nreturn newmsg;","outputs":1,"noerr":0,"x":150,"y":860,"wires":[["de119f2a.9dc14"]]},{"id":"de119f2a.9dc14","type":"debug","z":"1cc1a934.f301e7","name":"","active":true,"console":"false","complete":"false","x":150,"y":920,"wires":[]},{"id":"6fdcc841.0d49b","type":"function","z":"1cc1a934.f301e7","name":"SwitchOn Next light","func":"var lastping = global.get(\"lastping\")\nvar newmsg = {\"cmd\" : \"setGPIO\",\n\"level\":1,\n\"gpio\":7,\n\"setGPIO\":0,\n}\nmsg.eventOrCommandType = \"setGPIO\"\nnode.warn(lastping.payload.gpio7)\n\nif(lastping.payload.gpio7 == 1)\n{\n    newmsg.level=0\n    newmsg.gpio=7\n    msg.payload=newmsg ;\n    lastping.payload.gpio7=0\n    node.send(msg)\n    \n    newmsg.level=1\n    newmsg.gpio=8\n    lastping.payload.gpio8=1\n      lastping.payload.led=8\n    msg.payload=newmsg ;\n    node.send(msg)\n    \n    \n}else if(lastping.payload.gpio8 == 1)\n{\n    newmsg.level=0\n    newmsg.gpio=8\n    msg.payload=newmsg ;\n    lastping.payload.gpio8=0\n    node.send(msg)\n\n       \n    newmsg.level=1\n    newmsg.gpio=12\n    msg.payload=newmsg ;\n    lastping.payload.gpio12=1\n      lastping.payload.led=12\n    node.send(msg)\n}else if(lastping.payload.gpio12 == 1)\n{\n    newmsg.level=0\n    newmsg.gpio=12\n    msg.payload=newmsg ;\n    lastping.payload.gpio12=0\n    node.send(msg)\n    \n    newmsg.level=1\n    newmsg.gpio=7\n    msg.payload=newmsg ;\n        lastping.payload.gpio7=1\n          lastping.payload.led=7\n    node.send(msg)\n}else{\n    \n    node.warn(\"LED switch -something not right all off switch on one\")\n    newmsg.level=1\n    newmsg.gpio=7\n    msg.payload=newmsg ;\n    lastping.payload.gpio7=1\n    lastping.payload.led=7\n    \n    node.send(msg)\n    \n    \n}\n\nglobal.set(\"lastping\",lastping)\n\n//return lastping;","outputs":"1","noerr":0,"x":340,"y":500,"wires":[["583d609f.48eb8","fe58727a.b9ddb8","e44849b6.57e268"]]},{"id":"583d609f.48eb8","type":"debug","z":"1cc1a934.f301e7","name":"","active":true,"console":"false","complete":"payload","x":270,"y":620,"wires":[]},{"id":"f26c5328.9d50c8","type":"switch","z":"1cc1a934.f301e7","name":"","property":"payload.value","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"else"}],"checkall":"true","outputs":2,"x":120,"y":500,"wires":[["6fdcc841.0d49b","5b2a012c.f60ff8"],[]]},{"id":"fe58727a.b9ddb8","type":"ibmiot out","z":"1cc1a934.f301e7","authentication":"boundService","apiKey":"6e106082.5c7b98","outputType":"cmd","deviceId":"playbulb23","deviceType":"playbulb","eventCommandType":"setLED1off","format":"json","data":"payload","qos":0,"name":"playbulb23","service":"registered","x":590,"y":500,"wires":[]},{"id":"1f2bcefc.bcb0e1","type":"ibmiot out","z":"1cc1a934.f301e7","authentication":"boundService","apiKey":"6e106082.5c7b98","outputType":"cmd","deviceId":"playbulb23","deviceType":"playbulb","eventCommandType":"draw7SLED","format":"json","data":"payload","qos":0,"name":"playbulb23","service":"registered","x":1090,"y":1040,"wires":[]},{"id":"80c35ada.e56cc8","type":"function","z":"1cc1a934.f301e7","name":"draw7SLED","func":"var newmsg = {\"cmd\" : \"draw7SLED\",\n\"value\":\"M\"\n}\nmsg.eventOrCommandType = \"draw7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":880,"y":1040,"wires":[["1f2bcefc.bcb0e1"]]},{"id":"e0dc730f.a76198","type":"inject","z":"1cc1a934.f301e7","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":660,"y":1040,"wires":[["80c35ada.e56cc8"]]},{"id":"f0be3b9d.47d31","type":"function","z":"1cc1a934.f301e7","name":"set7SLED","func":"var newmsg = {\"cmd\" : \"set7SLED\",\n// Number One 1 with a Dot\n// Infos https://en.wikipedia.org/wiki/Seven-segment_display\n\"A\":0,\n\"B\":1,\n\"C\":1,\n\"D\":0,\n\"E\":0,\n\"F\":0,\n\"G\":0,\n\"DP\":1\n}\nmsg.eventOrCommandType = \"set7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":870,"y":1120,"wires":[["1f2bcefc.bcb0e1"]]},{"id":"a8d2d80a.1cfe98","type":"inject","z":"1cc1a934.f301e7","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":660,"y":1120,"wires":[["f0be3b9d.47d31"]]},{"id":"c9e902fc.90b13","type":"function","z":"1cc1a934.f301e7","name":"draw7SLED","func":"var newmsg = {\"cmd\" : \"draw7SLED\",\n\"value\":\"0\"\n}\nmsg.eventOrCommandType = \"draw7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":870,"y":980,"wires":[["1f2bcefc.bcb0e1"]]},{"id":"19cba57e.d9461b","type":"inject","z":"1cc1a934.f301e7","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":650,"y":980,"wires":[["c9e902fc.90b13"]]},{"id":"ca27162d.925998","type":"function","z":"1cc1a934.f301e7","name":"draw7SLED","func":"var newmsg = {\"cmd\" : \"draw7SLED\",\n\"value\":\"4\"\n}\nif(msg.payload.gpio == 12)\nnewmsg.value = 3\n\nif(msg.payload.gpio == 7)\nnewmsg.value = 1\n\nif(msg.payload.gpio == 8)\nnewmsg.value = 2\n\n//newmsg.value = msg.payload.gpio\nmsg.eventOrCommandType = \"draw7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":850,"y":920,"wires":[["1f2bcefc.bcb0e1"]]},{"id":"71461540.76750c","type":"inject","z":"1cc1a934.f301e7","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":630,"y":920,"wires":[["ca27162d.925998"]]},{"id":"ad1565dd.2a13d","type":"comment","z":"1cc1a934.f301e7","name":"7 Segemnt LED","info":"https://en.wikipedia.org/wiki/Seven-segment_display\n/1    A  B  C   D   E   F   G  DP\nGpio,17, 4, 23, 24, 25, 27, 22, 18);\n\nAAAA = GPIO17\nF  B=DPIO04\nF  B\nGGGG =\nE  C\nE  C\nDDDD =24\nDP =18","x":1110,"y":1140,"wires":[]},{"id":"e44849b6.57e268","type":"switch","z":"1cc1a934.f301e7","name":"","property":"payload.level","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"else"}],"checkall":"true","outputs":2,"x":510,"y":820,"wires":[["ec46b62f.6e5df"],[]]},{"id":"ec46b62f.6e5df","type":"function","z":"1cc1a934.f301e7","name":"set7SLED","func":"var newmsgS = {\"cmd\" : \"set7SLED\",\n// Number One 1 with a Dot\n// Infos https://en.wikipedia.org/wiki/Seven-segment_display\n\"A\":1,\n\"B\":0,\n\"C\":1,\n\"D\":1,\n\"E\":0,\n\"F\":1,\n\"G\":1,\n\"DP\":1\n}\n\nvar newmsgM = {\"cmd\" : \"set7SLED\",\n// Number One 1 with a Dot\n// Infos https://en.wikipedia.org/wiki/Seven-segment_display\n\"A\":1,\n\"B\":1,\n\"C\":1,\n\"D\":0,\n\"E\":1,\n\"F\":1,\n\"G\":0,\n\"DP\":0\n}\n\nvar newmsgL = {\"cmd\" : \"set7SLED\",\n// Number One 1 with a Dot\n// Infos https://en.wikipedia.org/wiki/Seven-segment_display\n\"A\":0,\n\"B\":0,\n\"C\":0,\n\"D\":1,\n\"E\":1,\n\"F\":1,\n\"G\":0,\n\"DP\":1\n}\n\nif(msg.payload.gpio == 12)\nnewmsg =newmsgL\n\nif(msg.payload.gpio == 7)\nnewmsg =newmsgS\n\nif(msg.payload.gpio == 8)\nnewmsg =newmsgM\n\n\nmsg.eventOrCommandType = \"set7SLED\"\nmsg.payload=newmsg ;\nreturn msg;\n","outputs":1,"noerr":0,"x":860,"y":820,"wires":[["1f2bcefc.bcb0e1"]]},{"id":"51d49953.6271a","type":"ibmiot in","z":"7b535247.aa729c","authentication":"boundService","apiKey":"147a8037.1dd968","inputType":"evt","deviceId":"playbulb14","applicationId":"","deviceType":"+","eventType":"+","commandType":"","format":"json","name":"Adjust Device ID","service":"registered","allDevices":true,"allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":true,"qos":0,"x":180,"y":140,"wires":[["377440d5.23e878","986ecc90.87a02"]]},{"id":"377440d5.23e878","type":"debug","z":"7b535247.aa729c","name":"Incoming","active":false,"console":"false","complete":"true","x":580,"y":140,"wires":[]},{"id":"adfa7cee.f1e37","type":"function","z":"7b535247.aa729c","name":"Picture","func":"var data = msg.payload.data\nvar g=\"\"\nif ( msg.payload.pkgs == 1 )\n      global.set(\"img\",g)\nelse\n  g = global.get(\"img\")\n\n\ng=g+data\nglobal.set(\"img\",g)\nmsg.data = g\nreturn msg;","outputs":1,"noerr":0,"x":400,"y":200,"wires":[["2108ecfd.bcd2fc"]]},{"id":"2108ecfd.bcd2fc","type":"debug","z":"7b535247.aa729c","name":"DB-Picture","active":true,"console":"false","complete":"payload","x":590,"y":200,"wires":[]},{"id":"bbde5f44.9a974","type":"function","z":"7b535247.aa729c","name":"","func":"g =    global.get(\"img\")\nmsg.payload = g\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":360,"wires":[["4db794ba.7a24d4"]]},{"id":"299bd51f.ec16e2","type":"ui_template","z":"7b535247.aa729c","group":"5379369c.3517d8","name":"","order":1,"width":"12","height":"8","format":"<img ng-src= {{msg.payload}}\n width='290' \n height='220' \n id='img'\n alt='Getting Image'\n>\n{{msg.mvk}}","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":580,"y":420,"wires":[[]]},{"id":"4db794ba.7a24d4","type":"function","z":"7b535247.aa729c","name":"","func":"//var buff = new Buffer(msg.payload ,'base64');\nmsg.payload = \"data:image/jpeg;base64,\" + msg.payload;\n//msg.payload = \"data:image/jpeg;base64,\" + buff\n\n//msg.payload = buff\nmsg.mvk=Date.now()\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":420,"wires":[["299bd51f.ec16e2","b4ba4d08.0edad"]]},{"id":"b4ba4d08.0edad","type":"debug","z":"7b535247.aa729c","name":"Check","active":true,"console":"false","complete":"payload","x":570,"y":460,"wires":[]},{"id":"f38d5262.7a7fa8","type":"ibmiot out","z":"7b535247.aa729c","authentication":"boundService","apiKey":"147a8037.1dd968","outputType":"cmd","deviceId":"playbulb14","deviceType":"playbulb","eventCommandType":"startpicture","format":"json","data":"msg.payload","qos":0,"name":"toPI - Adjust ID","service":"registered","x":1320,"y":120,"wires":[]},{"id":"c2dbf5d8.7f63d8","type":"inject","z":"7b535247.aa729c","name":"Test","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":910,"y":120,"wires":[["a4c57c86.0cd6d"]]},{"id":"a4c57c86.0cd6d","type":"function","z":"7b535247.aa729c","name":"takepicture","func":"var newmsg = {\"cmd\" : \"takepicture\",\n\"width\": 640,\n\"height\": 480,\n\"timeout\": 1,\n\"vflip\" : false,\n\"hflip\" : false\n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":1110,"y":120,"wires":[["f38d5262.7a7fa8","443dc589.19d9ec"]]},{"id":"bc8ae3c1.06534","type":"comment","z":"7b535247.aa729c","name":"Incoming Message form the PI ##","info":"","x":240,"y":80,"wires":[]},{"id":"55c535c0.7e11c4","type":"comment","z":"7b535247.aa729c","name":"Send Messages to the PI ##","info":"","x":940,"y":60,"wires":[]},{"id":"78e84966.38154","type":"visual-recognition-v3","z":"7b535247.aa729c","name":"Watson ClassiFy Image","image-feature":"classifyImage","lang":"en","x":770,"y":980,"wires":[["a904cf3d.0becd","d2290854.ee99e"]]},{"id":"443dc589.19d9ec","type":"debug","z":"7b535247.aa729c","name":"SendCommand","active":false,"console":"false","complete":"payload","x":1320,"y":180,"wires":[]},{"id":"986ecc90.87a02","type":"switch","z":"7b535247.aa729c","name":"filter events","property":"eventType","propertyType":"msg","rules":[{"t":"eq","v":"picture","vt":"str"},{"t":"eq","v":"ping","vt":"str"},{"t":"eq","v":"tookpicture","vt":"str"},{"t":"else"}],"checkall":"true","outputs":4,"x":190,"y":220,"wires":[["adfa7cee.f1e37","dd209270.897638"],["908d5bc1.7a069"],[],["2144ede8.778242"]]},{"id":"908d5bc1.7a069","type":"function","z":"7b535247.aa729c","name":"Ping","func":"var data = msg.payload.data\nvar g=\"\"\nif ( msg.payload.pkgs == 1 )\n      global.set(\"img\",g)\nelse\n  g = global.get(\"img\")\n\n\ng=g+data\nglobal.set(\"img\",g)\nmsg.data = g\nreturn msg;","outputs":1,"noerr":0,"x":390,"y":240,"wires":[["d364b6ec.8c2ce"]]},{"id":"d364b6ec.8c2ce","type":"debug","z":"7b535247.aa729c","name":"Pings","active":false,"console":"false","complete":"payload","x":570,"y":240,"wires":[]},{"id":"2144ede8.778242","type":"debug","z":"7b535247.aa729c","name":"Other","active":false,"console":"false","complete":"payload","x":170,"y":280,"wires":[]},{"id":"1842c5d1.b8253a","type":"ui_button","z":"7b535247.aa729c","name":"","group":"5379369c.3517d8","order":2,"width":0,"height":0,"passthru":false,"label":"Take Picture","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":910,"y":180,"wires":[["a4c57c86.0cd6d"]]},{"id":"54bde077.ba3be8","type":"comment","z":"7b535247.aa729c","name":"Display Image on UI (UserInterface)","info":"","x":660,"y":340,"wires":[]},{"id":"131274fd.042e93","type":"function","z":"7b535247.aa729c","name":"Build Buffer","func":"\nvar buf = Buffer.from( global.get(\"img\"), 'base64');\nAPIKEY = \"595fad279b021da52cc48c0b1a996ad5e9281929\"\nparameters = {\n\tclassifier_ids: [\"LegoAccidentMvK02_1462123022\"],\n    threshold: 0.01\n}\n//msg.params = parameters\nmsg.payload = buf\n//node.status({fill:\"green\",shape:\"dot\",text: parameters.classifier_ids});\n//global.set(\"face\",global.get(\"img\"))\n//global.set(\"obj\",global.get(\"img\"))\n//global.set(\"text\",global.get(\"img\"))\nreturn msg;\n","outputs":1,"noerr":0,"x":510,"y":980,"wires":[["78e84966.38154"]]},{"id":"6b1b61a9.9744e8","type":"inject","z":"7b535247.aa729c","name":"Test","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":270,"y":980,"wires":[["131274fd.042e93"]]},{"id":"d976e460.af42d","type":"debug","z":"7b535247.aa729c","name":"People","active":true,"console":"false","complete":"true","x":960,"y":640,"wires":[]},{"id":"c6e9e5fb.ed7cb","type":"function","z":"7b535247.aa729c","name":"Process Results","func":"if ((typeof msg.result == 'undefined') || (typeof msg.result.images[0].classifiers == 'undefined'))\n{\n\nmsg.template=\"<style>\";\nmsg.template=msg.template+\"table { width: 240px; margin-top: 5px; }\";\nmsg.template=msg.template+\"tr:nth-child(even){background-color: #f2f2f2;}\";\nmsg.template=msg.template+\"th, td { padding: 8px; text-align: left; border-bottom: 1px solid #ddd; width: 10%;}\";\nmsg.template=msg.template+\"</style>\";\n\nmsg.template=msg.template+\"<h4>Nothing Found to Classify</h4>\"\n\nreturn msg;\n\n\n}\n\n// Text Extraction\nif (typeof msg.result.images[0].text != 'undefined') {\n    var image_text = msg.result.images[0].text;\n    msg.payload = image_text;\n    msg.template = image_text;\n    if( image_text.length >0 ) {\n       msg.template= \"Watson found the words: \"+image_text;\n    }\n    return msg;\n}\n\nvar bestcolor = -1;\nvar colorscore = 0;\nvar c_id = 0;\nvar say = \"\";\nvar item;\n\nfor ( c_id=0; c_id < (msg.result.images[0].classifiers.length); c_id++ ){\n    // find the best color, if any\n    for( i =0; i<(msg.result.images[0].classifiers[c_id].classes.length); i++ ){\n      var object = msg.result.images[0].classifiers[c_id].classes[i].class;\n      if ( object.includes(\"color\") ) {\n        if( msg.result.images[0].classifiers[c_id].classes[i].score > colorscore){\n            bestcolor = i;\n            colorscore = msg.result.images[0].classifiers[c_id].classes[i].score;\n        }\n      }\n    }\n \n    var bestItem = 0;\n    var itemScore = 0;\n    for( i =0; i<(msg.result.images[0].classifiers[c_id].classes.length); i++ ){\n      var object = msg.result.images[0].classifiers[c_id].classes[i].class;\n      if ( !object.includes(\"color\") ) {\n        if( msg.result.images[0].classifiers[c_id].classes[i].score > itemScore){\n//            bestItem = i;\n            bestItem = 0;\n            itemScore =  msg.result.images[0].classifiers[c_id].classes[i].score;\n        }\n      }\n    }\n \n     if( bestcolor != \"-1\") {\n        // found a color\n        item = msg.result.images[0].classifiers[c_id].classes[bestcolor].class + \" \" + msg.result.images[0].classifiers[c_id].classes[bestItem].class;\n        bestcolor = -1;\n    } else {\n       item = msg.result.images[0].classifiers[c_id].classes[bestItem].class;\n    }\n//    say = say + \" Watson's \" + msg.result.images[0].classifiers[c_id].name + \" classifier thinks this picture contains a \" + item +\".\";\n    say = say + \" Watson thinks this picture contains a \" + item +\".\";\n}\nmsg.payload =  say;\n\nvar picInfo = msg.result.images[0].classifiers[0].classes;\nvar arrayLength = picInfo.length;\n\nmsg.template=\"<style>\";\nmsg.template=msg.template+\"table { width: 240px; margin-top: 5px; }\";\nmsg.template=msg.template+\"tr:nth-child(even){background-color: #f2f2f2;}\";\nmsg.template=msg.template+\"th, td { padding: 8px; text-align: left; border-bottom: 1px solid #ddd; width: 10%;}\";\nmsg.template=msg.template+\"</style>\";\n\nmsg.template=msg.template+\"<h4>\"+say+\"</h4><table span=100%><tr><th>Class</th><th>Confidence</th></tr>\";\nfor (var i = 0; i < arrayLength; i++) {\n  msg.template = msg.template + \"<tr><td>\" + picInfo[i].class + \"</td><td>\" + picInfo[i].score + \"</td></tr>\";\n}\nmsg.template = msg.template + \"</table>\";\n\nreturn msg;","outputs":1,"noerr":0,"x":760,"y":1080,"wires":[["1c433c03.b3cebc","540c644e.e5fe04"]]},{"id":"1c433c03.b3cebc","type":"ui_template","z":"7b535247.aa729c","group":"dae58bef.fb8508","name":"Results Table","order":1,"width":"13","height":"10","format":"<div ng-bind-html=\"msg.template\"></div>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":1210,"y":1080,"wires":[[]]},{"id":"540c644e.e5fe04","type":"debug","z":"7b535247.aa729c","name":"Debug","active":false,"console":"false","complete":"true","x":910,"y":1160,"wires":[]},{"id":"37e52d01.9eac6a","type":"visual-recognition-v3","z":"7b535247.aa729c","name":"Detect  People","image-feature":"detectFaces","lang":"en","x":740,"y":700,"wires":[["d976e460.af42d","7a1b1d08.83fa54","e71acc83.afe04"]]},{"id":"3db48d0f.867d62","type":"ui_button","z":"7b535247.aa729c","name":"","group":"5379369c.3517d8","order":2,"width":0,"height":0,"passthru":false,"label":"Classify Object","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":500,"y":1060,"wires":[["131274fd.042e93"]]},{"id":"8718dda5.b1c98","type":"function","z":"7b535247.aa729c","name":"Process Results","func":"if (typeof msg.result.images[0].faces == 'undefined') \nmsg.template=\"<h4>No People Found to Classify</h4>\"\nelse\nmsg.template  = msg.payload;\n\nreturn msg;","outputs":1,"noerr":0,"x":1220,"y":700,"wires":[["1c433c03.b3cebc"]]},{"id":"cf44ff43.4d9c78","type":"ui_button","z":"7b535247.aa729c","name":"","group":"5379369c.3517d8","order":2,"width":0,"height":0,"passthru":false,"label":"Detect People","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":520,"y":640,"wires":[["124e738c.d12754"]]},{"id":"124e738c.d12754","type":"function","z":"7b535247.aa729c","name":"Build Buffer","func":"\nvar buf = Buffer.from( global.get(\"img\"), 'base64');\nAPIKEY = \"595fad279b021da52cc48c0b1a996ad5e9281929\"\nparameters = {\n\tclassifier_ids: [\"LegoAccidentMvK02_1462123022\"],\n    threshold: 0.01\n}\n//msg.params = parameters\nmsg.payload = buf\n//node.status({fill:\"green\",shape:\"dot\",text: parameters.classifier_ids});\n\nreturn msg;\n","outputs":1,"noerr":0,"x":510,"y":700,"wires":[["37e52d01.9eac6a"]]},{"id":"a904cf3d.0becd","type":"template","z":"7b535247.aa729c","name":"Format Results","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"{{#result.images}}\n    <img src=\"{{source_url}}\"/><br />\n    {{#classifiers}}\n        <h2>{{name}}</h2>\n        <table border=\"1\">\n            <tr>\n                <td>Class</td>\n                <td>Score</td>\n                <td>Type Hierarchy</td>\n            </tr>    \n            {{#classes}}\n                <tr>\n                    <td>{{class}}</td>\n                    <td>{{score}}</td>\n                    <td>{{type_hierarchy}}</td>\n                </tr>\n            {{/classes}}\n        </table>\n    {{/classifiers}}\n{{/result.images}}\n","x":1000,"y":980,"wires":[["92025da8.ddd858"]]},{"id":"5dec9314.c03574","type":"comment","z":"7b535247.aa729c","name":"Classify Object and Faces","info":"","x":270,"y":560,"wires":[]},{"id":"d2290854.ee99e","type":"debug","z":"7b535247.aa729c","name":"Objects","active":true,"console":"false","complete":"true","x":960,"y":1020,"wires":[]},{"id":"92025da8.ddd858","type":"function","z":"7b535247.aa729c","name":"Process Results","func":"\nmsg.template  = msg.payload;\n\nvar bestcolor = -1;\nvar colorscore = 0;\nvar c_id = 0;\nvar say = \"\";\nvar item;\n\nfor ( c_id=0; c_id < (msg.result.images[0].classifiers.length); c_id++ ){\n    // find the best color, if any\n    for( i =0; i<(msg.result.images[0].classifiers[c_id].classes.length); i++ ){\n      var object = msg.result.images[0].classifiers[c_id].classes[i].class;\n      if ( object.includes(\"color\") ) {\n        if( msg.result.images[0].classifiers[c_id].classes[i].score > colorscore){\n            bestcolor = i;\n            colorscore = msg.result.images[0].classifiers[c_id].classes[i].score;\n        }\n      }\n    }\n \n    var bestItem = 0;\n    var itemScore = 0;\n    for( i =0; i<(msg.result.images[0].classifiers[c_id].classes.length); i++ ){\n      var object = msg.result.images[0].classifiers[c_id].classes[i].class;\n      if ( !object.includes(\"color\") ) {\n        if( msg.result.images[0].classifiers[c_id].classes[i].score > itemScore){\n//            bestItem = i;\n            bestItem = 0;\n            itemScore =  msg.result.images[0].classifiers[c_id].classes[i].score;\n        }\n      }\n    }\n \n     if( bestcolor != \"-1\") {\n        // found a color\n        item = msg.result.images[0].classifiers[c_id].classes[bestcolor].class + \" \" + msg.result.images[0].classifiers[c_id].classes[bestItem].class;\n        bestcolor = -1;\n    } else {\n       item = msg.result.images[0].classifiers[c_id].classes[bestItem].class;\n    }\n    say = say + \" System thinks this picture contains a \" + item +\".\";\n}\n\n\n\nmsg.template=\"<br><h2>\"+say+\"</h2>\"+msg.template\nreturn msg;","outputs":1,"noerr":0,"x":1220,"y":980,"wires":[["1c433c03.b3cebc"]]},{"id":"fb5dceae.bb4958","type":"inject","z":"7b535247.aa729c","name":"test","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":250,"y":700,"wires":[["124e738c.d12754"]]},{"id":"7a1b1d08.83fa54","type":"function","z":"7b535247.aa729c","name":"Age","func":"msg.payload = msg.result.images[0].faces[0].age.min\nreturn msg;","outputs":1,"noerr":0,"x":950,"y":560,"wires":[["17f69121.1df987","5efa45e2.aeb79c"]]},{"id":"17f69121.1df987","type":"debug","z":"7b535247.aa729c","name":"Min  Age","active":true,"console":"false","complete":"payload","x":940,"y":500,"wires":[]},{"id":"29cd5fe0.d585b","type":"function","z":"7b535247.aa729c","name":"SetColorRed","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":1290,"y":560,"wires":[["7e9b7f74.3c2798"]]},{"id":"7e9b7f74.3c2798","type":"ibmiot out","z":"7b535247.aa729c","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb14","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"toPiCandle","service":"registered","x":1470,"y":560,"wires":[]},{"id":"65c49bfe.075504","type":"function","z":"7b535247.aa729c","name":"SetColorGreen","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":1300,"y":600,"wires":[["7e9b7f74.3c2798"]]},{"id":"5efa45e2.aeb79c","type":"switch","z":"7b535247.aa729c","name":"Age < 25","property":"payload","propertyType":"msg","rules":[{"t":"gt","v":"28","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":1120,"y":560,"wires":[["29cd5fe0.d585b"],["65c49bfe.075504"]]},{"id":"3b23c946.a63c76","type":"ui_button","z":"7b535247.aa729c","name":"","group":"5379369c.3517d8","order":2,"width":0,"height":0,"passthru":false,"label":"Refresh","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":180,"y":360,"wires":[["bbde5f44.9a974"]]},{"id":"6b66856b.8d1fec","type":"comment","z":"7b535247.aa729c","name":"API Key","info":"595fad279b021da52cc48c0b1a996ad5e9281929","x":690,"y":640,"wires":[]},{"id":"a32ab94c.bcdea8","type":"debug","z":"7b535247.aa729c","name":"Text","active":true,"console":"false","complete":"true","x":930,"y":780,"wires":[]},{"id":"ee828625.2c4a9","type":"visual-recognition-v3","z":"7b535247.aa729c","name":"Detect Text","image-feature":"recognizeText","lang":"en","x":710,"y":840,"wires":[["a32ab94c.bcdea8","d4db933b.17538"]]},{"id":"83562e5a.32d1c8","type":"ui_button","z":"7b535247.aa729c","name":"","group":"5379369c.3517d8","order":2,"width":0,"height":0,"passthru":false,"label":"Detect Text","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":490,"y":780,"wires":[["784a2731.5ba598"]]},{"id":"784a2731.5ba598","type":"function","z":"7b535247.aa729c","name":"Build Buffer","func":"\nvar buf = Buffer.from( global.get(\"img\"), 'base64');\nAPIKEY = \"595fad279b021da52cc48c0b1a996ad5e9281929\"\nparameters = {\n\tclassifier_ids: [\"LegoAccidentMvK02_1462123022\"],\n    threshold: 0.01\n}\n//msg.params = parameters\nmsg.payload = buf\n//node.status({fill:\"green\",shape:\"dot\",text: parameters.classifier_ids});\nvar buf = Buffer.from( global.get(\"text\"), 'base64');\n\nreturn msg;\n","outputs":1,"noerr":0,"x":490,"y":840,"wires":[["ee828625.2c4a9"]]},{"id":"e513aa07.236b9","type":"inject","z":"7b535247.aa729c","name":"test","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":230,"y":840,"wires":[["784a2731.5ba598"]]},{"id":"e71acc83.afe04","type":"template","z":"7b535247.aa729c","name":"Format Results","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<style>\n.boxes {\n\tmargin: 0rem;\n\theight: 0rem;\n\twidth: 0rem;\n}\n\n.box-location {\n\tposition: absolute;\n\twidth: 50px;\n\theight: 50px;\n\tborder: 3px solid rgba(255, 255, 255, 0.54);\n\tborder-color: #f3f3f3;\n\ttop: 0rem;\n\tdisplay: block;\n\tmargin-top: 0rem;\n\tleft: calc(50% - 7rem);\n}\n</style>\n\n{{#result.images}}\n<img src=\"{{source_url}}\"/>\n{{#faces}}\n    <div class=\"box-location\" style=\"height: {{face_location.height}}px; left: {{face_location.left}}px; top: {{face_location.top}}px; width: {{face_location.width}}px;\"></div>\n{{/faces}}\n\n<table border=\"1\">\n        <tr>\n            <td>Gender</td>\n            <td>Age Range</td>\n            <td>Location</td>\n        </tr>    \n    {{#faces}}\n        <tr>\n            <td>{{gender.gender}} ({{gender.score}})</td>\n            <td>{{age.min}}-{{age.max}} ({{age.score}})</td>\n            <td>{{face_location.left}},{{face_location.top}} {{face_location.width}}X{{face_location.height}}</td>\n        </tr>\n    {{/faces}}\n</table>\n{{/result.images}}","x":1000,"y":700,"wires":[["8718dda5.b1c98"]]},{"id":"fc92f20e.61f0e8","type":"function","z":"7b535247.aa729c","name":"Process Results","func":"if (typeof msg.result.images[0].text == 'undefined'\n || msg.result.images[0].text == \"\") \nmsg.template=\"<h4>No Text Found to Classify</h4>\"\nelse\nmsg.template  = msg.payload;\n\nreturn msg;","outputs":1,"noerr":0,"x":1220,"y":840,"wires":[["1c433c03.b3cebc","cbd8d89f.f3351","55eca7e.283e2d8"]]},{"id":"d4db933b.17538","type":"template","z":"7b535247.aa729c","name":"Format Results","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"\n\n{{#result.images}}\n    <h4>Text = {{text}}</h4>\n<table border=\"1\">\n        <tr>\n            <td>words</td>\n <td>score</td>\n        </tr>   \n        \n    {{#words}}\n        <tr>\n            <td>{{word}}</td>\n              <td>{{score}}</td>\n        </tr>\n    {{/words}}\n</table>\n{{/result.images}}","x":1000,"y":840,"wires":[["fc92f20e.61f0e8"]]},{"id":"dd209270.897638","type":"delay","z":"7b535247.aa729c","name":"","pauseType":"rate","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":400,"y":300,"wires":[["bbde5f44.9a974"]]},{"id":"a7aa221e.a822a","type":"function","z":"7b535247.aa729c","name":"SetColorBlue","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":1730,"y":800,"wires":[["7f45eb56.03d3bc"]]},{"id":"7f45eb56.03d3bc","type":"ibmiot out","z":"7b535247.aa729c","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb14","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"toPiCandle","service":"registered","x":1930,"y":820,"wires":[]},{"id":"cbd8d89f.f3351","type":"switch","z":"7b535247.aa729c","name":"Color?","property":"result.images[0].text","propertyType":"msg","rules":[{"t":"cont","v":"blue","vt":"str"},{"t":"cont","v":"green","vt":"str"},{"t":"cont","v":"red","vt":"str"},{"t":"else"}],"checkall":"true","outputs":4,"x":1450,"y":820,"wires":[["a7aa221e.a822a"],[],[],[]]},{"id":"55eca7e.283e2d8","type":"debug","z":"7b535247.aa729c","name":"Text","active":true,"console":"false","complete":"true","x":1450,"y":760,"wires":[]},{"id":"e66cf075.ef824","type":"comment","z":"7b535247.aa729c","name":"README 1st","info":"Hello .... make sure you adjust the DeviceID in the blue nodes","x":170,"y":20,"wires":[]},{"id":"a11f66e7.7af3b8","type":"comment","z":"7b535247.aa729c","name":"URL for UI is http://snp??.mybluemix.net/ui","info":"","x":670,"y":380,"wires":[]},{"id":"f85061ad.828688","type":"inject","z":"7b535247.aa729c","name":"test","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":150,"y":460,"wires":[["f37081a9.e51c3"]]},{"id":"f37081a9.e51c3","type":"function","z":"7b535247.aa729c","name":"text","func":"g =    global.get(\"text\")\nmsg.payload = g\nreturn msg;","outputs":1,"noerr":0,"x":310,"y":460,"wires":[["4db794ba.7a24d4"]]},{"id":"c2e4957c.1f55c8","type":"comment","z":"7b535247.aa729c","name":"API Key","info":"595fad279b021da52cc48c0b1a996ad5e9281929","x":710,"y":940,"wires":[]},{"id":"f90c6dfd.2eafc","type":"comment","z":"7b535247.aa729c","name":"API Key","info":"595fad279b021da52cc48c0b1a996ad5e9281929","x":690,"y":780,"wires":[]},{"id":"88c85850.a7f32","type":"function","z":"cce2ce51.a5c9b","name":"setCandleMode=Jump=02","func":"var newmsg = {\"cmd\" : \"setcolor\",\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":2,\n\"speed1\":9,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":400,"y":640,"wires":[["718f2076.193e9"]]},{"id":"1f83ac74.981d3c","type":"inject","z":"cce2ce51.a5c9b","name":"SetBlue","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":130,"y":640,"wires":[["88c85850.a7f32"]]},{"id":"ed27982.37e8768","type":"ibmiot in","z":"22b120e9.55fad","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb01","applicationId":"","deviceType":"+","eventType":"IR1","commandType":"","format":"json","name":"IR Events From PI - adjust name","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":"","qos":0,"x":4250,"y":4040,"wires":[["ada0c941.7db848"]]},{"id":"58151542.b7965c","type":"ibmiot in","z":"22b120e9.55fad","authentication":"boundService","apiKey":"","inputType":"evt","deviceId":"playbulb01","applicationId":"","deviceType":"+","eventType":"+","commandType":"","format":"json","name":"IR Events From PI - adjust name","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":true,"allCommands":"","allFormats":"","qos":0,"x":4250,"y":4100,"wires":[["4c5c8feb.3a62b"]]},{"id":"4c5c8feb.3a62b","type":"debug","z":"22b120e9.55fad","name":"Pings","active":true,"console":false,"complete":"payload","x":4510,"y":4100,"wires":[]},{"id":"4169ecaa.ff8e74","type":"debug","z":"22b120e9.55fad","name":"Touch","active":true,"console":false,"complete":"payload","x":4710,"y":4040,"wires":[]},{"id":"ada0c941.7db848","type":"switch","z":"22b120e9.55fad","name":"","property":"payload.value","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"else"}],"checkall":"true","outputs":2,"x":4510,"y":4040,"wires":[["4169ecaa.ff8e74"],[]]},{"id":"60cf7318.ab71fc","type":"ibmiot in","z":"22b120e9.55fad","authentication":"boundService","apiKey":"cadcbaf8.9e7c18","inputType":"evt","deviceId":"playbulb01","applicationId":"","deviceType":"+","eventType":"IR1","commandType":"","format":"json","name":"IR1","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":true,"qos":0,"x":4170,"y":4220,"wires":[["4314431d.b42b8c"]]},{"id":"4314431d.b42b8c","type":"switch","z":"22b120e9.55fad","name":"","property":"payload.status","propertyType":"msg","rules":[{"t":"eq","v":"broken","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":4350,"y":4220,"wires":[["fd4beee9.1d82","7044a8a7.cece08","4b5646f.d26e3b8"],[]]},{"id":"7044a8a7.cece08","type":"function","z":"22b120e9.55fad","name":"Set IR1","func":"isset =  global.get(\"ir1set\")\nif(msg.payload.value == 1 )\nif(isset)\n{\nnode.warn(\"Already set\")    \n\n}else{\n\n\n\n    global.set(\"ir1time\",msg.payload.ts)\n    global.set(\"ir1set\",true)\n    node.warn(\" setting time\")    \n\n}\n\n\nreturn msg;","outputs":1,"noerr":0,"x":4420,"y":4280,"wires":[[]]},{"id":"10bd3248.cac35e","type":"ibmiot in","z":"22b120e9.55fad","authentication":"boundService","apiKey":"cadcbaf8.9e7c18","inputType":"evt","deviceId":"playbulb01","applicationId":"","deviceType":"+","eventType":"IR2","commandType":"","format":"json","name":"IR2","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allEvents":false,"allCommands":"","allFormats":true,"qos":0,"x":4170,"y":4380,"wires":[["802c23c2.2ae69"]]},{"id":"802c23c2.2ae69","type":"switch","z":"22b120e9.55fad","name":"","property":"payload.status","propertyType":"msg","rules":[{"t":"eq","v":"broken","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":4370,"y":4380,"wires":[["53cdbb4f.85b434","9eaef33.ed82c1","d48ca11b.2a845"],[]]},{"id":"9eaef33.ed82c1","type":"function","z":"22b120e9.55fad","name":"Set IR2 - Calulate SPEED - Adjust","func":"isset =  global.get(\"ir1set\")\nkph=0\nkmh=0\nif(msg.payload.value == 1 )\nif(isset)\n{\n  //  node.warn(\"IR2 set\") \n global.set(\"ir2time\",msg.payload.ts)\n global.set(\"ir1set\",false)\n \n starttime = global.get(\"ir1time\")\n endtime = global.get(\"ir2time\")\n  mytime=endtime-starttime;\n node.warn(\"Time diff in millisec = \"+mytime)\n  \n   \n // Speed calculator\n //distance\nvar ms = 0\n  \nvar distcm = 15  //DEFINE Distance 2\nnode.warn(\"Distance in CM = \"+distcm)\n\tms = ((distcm/100) / (mytime/1000))\n  \tkph = (ms * 3.6)  \n  \t\n  \tkmh = (distcm/(mytime/1000))  * 0.036\n\n   \tnode.warn(\"SPEED in kmh = \"+kmh.toFixed(4)) \n // \tnode.warn(\"SPEED in kph = \"+kph.toFixed(4)) \n\tnode.warn(\"SPEED in ms = \"+ms.toFixed(4))\n\n\n}else{\n    node.warn(\"IR1 not set\") \n}\nmsg.payload.speedms = ms //ms.toFixed(4)\nmsg.payload.speedkmh = kph.toFixed(4)\nmsg.payload.speedkmh2 = kmh.toFixed(4)\nmsg.payload.distcm = distcm;\nmsg.payload.distm = (distcm/100);\nmsg.payload.timemm = mytime\nreturn msg;","outputs":1,"noerr":0,"x":4280,"y":4440,"wires":[["6489ef94.bb50d","2d79b581.0bde3a","c0839ac8.6d7148","56f04ee0.b0caa","2c48b33a.65367c","a0efd7b5.0d3e98","11fe2180.565baf"]]},{"id":"fd4beee9.1d82","type":"debug","z":"22b120e9.55fad","name":"IR1-Broken","active":true,"console":false,"complete":"payload","x":4550,"y":4200,"wires":[]},{"id":"53cdbb4f.85b434","type":"debug","z":"22b120e9.55fad","name":"IR2-Broken","active":true,"console":false,"complete":"payload","x":4550,"y":4360,"wires":[]},{"id":"6489ef94.bb50d","type":"debug","z":"22b120e9.55fad","name":"Speed","active":true,"console":false,"complete":"true","x":4530,"y":4440,"wires":[]},{"id":"89ec877d.c7a3a8","type":"ui_chart","z":"22b120e9.55fad","name":"","group":"a6165bf1.813048","order":1,"width":0,"height":0,"label":"Speed History","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"-2","ymax":"5","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"60","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":2,"x":4560,"y":4820,"wires":[[],[]]},{"id":"2d79b581.0bde3a","type":"ui_text","z":"22b120e9.55fad","group":"5909026c.2ea14c","order":1,"width":0,"height":0,"name":"","label":"SpeedKmH","format":"{{msg.payload.speedkmh}}","layout":"row-spread","x":4550,"y":4540,"wires":[]},{"id":"c0839ac8.6d7148","type":"ui_text","z":"22b120e9.55fad","group":"5909026c.2ea14c","order":2,"width":0,"height":0,"name":"","label":"Time","format":"{{msg.payload.timemm}}","layout":"row-spread","x":4530,"y":4660,"wires":[]},{"id":"e6701a17.2e1708","type":"ibmiot out","z":"22b120e9.55fad","authentication":"boundService","apiKey":"880db0ee.9d202","outputType":"evt","deviceId":"playbulb00","deviceType":"playbulb","eventCommandType":"dashboard","format":"json","data":"playload","qos":0,"name":"toMarkusDashBoard","service":"registered","x":4780,"y":4400,"wires":[]},{"id":"56f04ee0.b0caa","type":"function","z":"22b120e9.55fad","name":"","func":"msg.payload.event = \"dashboard\"\nmsg.payload.deviceId =  msg.deviceId\ndelete msg.eventType\ndelete msg.topic\ndelete msg.deviceId\nreturn msg;","outputs":1,"noerr":0,"x":4530,"y":4400,"wires":[["e6701a17.2e1708"]]},{"id":"2c48b33a.65367c","type":"ui_text","z":"22b120e9.55fad","group":"a6165bf1.813048","order":4,"width":0,"height":0,"name":"","label":"TS","format":"{{msg.payload.ts}}","layout":"row-spread","x":4530,"y":4700,"wires":[]},{"id":"a0efd7b5.0d3e98","type":"function","z":"22b120e9.55fad","name":"Mapping","func":"msg.payload = msg.payload.speedkmh\nreturn msg;","outputs":1,"noerr":0,"x":4380,"y":4500,"wires":[["ea58d04.f6ba53","345e5056.d788b","e48a0b82.7046d8","89ec877d.c7a3a8"]]},{"id":"ea58d04.f6ba53","type":"ui_gauge","z":"22b120e9.55fad","name":"","group":"5909026c.2ea14c","order":3,"width":0,"height":0,"gtype":"gage","title":"Speed Km/H","label":"units","format":"{{value}}","min":0,"max":"5","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":4550,"y":4500,"wires":[]},{"id":"11fe2180.565baf","type":"ui_text","z":"22b120e9.55fad","group":"5909026c.2ea14c","order":4,"width":0,"height":0,"name":"","label":"Speedms","format":"{{msg.payload.speedms}}","layout":"row-spread","x":4540,"y":4580,"wires":[]},{"id":"345e5056.d788b","type":"ui_text","z":"22b120e9.55fad","group":"a6165bf1.813048","order":2,"width":0,"height":0,"name":"","label":"Distance","format":"{{msg.payload.distcm}}","layout":"row-spread","x":4540,"y":4620,"wires":[]},{"id":"e48a0b82.7046d8","type":"ui_text","z":"22b120e9.55fad","group":"a6165bf1.813048","order":3,"width":0,"height":0,"name":"","label":"Device","format":"{{msg.deviceId}}","layout":"row-spread","x":4530,"y":4760,"wires":[]},{"id":"bea148dd.2c5568","type":"inject","z":"22b120e9.55fad","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":4200,"y":4978,"wires":[["e7524d7b.0af3e"]]},{"id":"e7524d7b.0af3e","type":"function","z":"22b120e9.55fad","name":"setCandleMode=Jump=02","func":"var newmsg = {\"cmd\" : \"setcolor\",\n// modes: 01 = Fade, 02 = Jump RBG (rainbow), 03 = Fade RGB (rainbow), 04 = Candle Effect\n\n\"mode\":2,\n\"speed1\":9,\n\"speed2\":0,\n\"rr\" : 0,\n\"gg\" : 0,\n\"bb\" : 255\n    \n}\nmsg.eventOrCommandType = \"setCandleMode\";\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":4420,"y":4980,"wires":[[]]},{"id":"d48ca11b.2a845","type":"function","z":"22b120e9.55fad","name":"SetColorGreen","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 0,\n\"gg\" : 255,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":4560,"y":4320,"wires":[["1c6d21a9.fd5a4e"]]},{"id":"4b5646f.d26e3b8","type":"function","z":"22b120e9.55fad","name":"SetColorRed","func":"var newmsg = {\"cmd\" : \"setcolor\",\n\"mode\":\"\",\n\"speed\":\"\",\n\"rr\" : 255,\n\"gg\" : 0,\n\"bb\" : 0\n    \n}\nmsg.payload=newmsg ;\nreturn msg;","outputs":1,"noerr":0,"x":4550,"y":4240,"wires":[["1c6d21a9.fd5a4e"]]},{"id":"cc54c239.0e89e","type":"inject","z":"22b120e9.55fad","name":"Test","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":4330,"y":4180,"wires":[["4b5646f.d26e3b8"]]},{"id":"1c6d21a9.fd5a4e","type":"ibmiot out","z":"22b120e9.55fad","authentication":"boundService","apiKey":"","outputType":"cmd","deviceId":"playbulb01","deviceType":"playbulb","eventCommandType":"setColor","format":"json","data":"msg.payload","qos":0,"name":"toPiCandle","service":"registered","x":4750,"y":4240,"wires":[]},{"id":"3ae0c1d6.77b3ee","type":"ibmiot in","z":"22b120e9.55fad","authentication":"boundService","apiKey":"95266688.b052e8","inputType":"evt","logicalInterface":"","ruleId":"","deviceId":"playbulb30","applicationId":"","deviceType":"+","eventType":"+","commandType":"","format":"json","name":"Lora","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allLogicalInterfaces":false,"allEvents":true,"allCommands":"","allFormats":true,"qos":0,"x":90,"y":280,"wires":[["cd5b0fd7.e09eb","2eece43e.16196c"]]},{"id":"cd5b0fd7.e09eb","type":"debug","z":"22b120e9.55fad","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":150,"y":220,"wires":[]},{"id":"3097d98f.2840e6","type":"ui_gauge","z":"22b120e9.55fad","name":"","group":"e6170bf6.938f38","order":0,"width":0,"height":0,"gtype":"gage","title":"Current MsgID","label":"MessageID","format":"{{value}}","min":0,"max":"1000","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":600,"y":280,"wires":[]},{"id":"cbcefe3.d3d1b","type":"function","z":"22b120e9.55fad","name":"","func":"msg.topic=msg.payload.id\nmsg.payload=msg.payload.msgid\n\nreturn msg;","outputs":1,"noerr":0,"x":410,"y":280,"wires":[["3097d98f.2840e6","26b94035.fe175","d1aa29aa.167f88"]]},{"id":"26b94035.fe175","type":"ui_chart","z":"22b120e9.55fad","name":"","group":"e6170bf6.938f38","order":1,"width":0,"height":0,"label":"MessageID","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"-0","ymax":"400","removeOlder":"1","removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#04ff04","#00fff3","#000000","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":590,"y":320,"wires":[[]]},{"id":"5ec18aea.299ed4","type":"ui_chart","z":"22b120e9.55fad","name":"","group":"872bede8.ae467","order":1,"width":0,"height":0,"label":"Temperature in C","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"Temperature DHT11","dot":false,"ymin":"-20","ymax":"30","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#04ff04","#00fff3","#000000","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":610,"y":420,"wires":[[]]},{"id":"7caae20a.277f0c","type":"function","z":"22b120e9.55fad","name":"Get Temperature","func":"msg.payload=msg.payload.t\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":420,"wires":[["5ec18aea.299ed4","8b298ddb.41e1f"]]},{"id":"d510f3ef.22035","type":"function","z":"22b120e9.55fad","name":"PassThru","func":"\nreturn msg;","outputs":1,"noerr":0,"x":160,"y":420,"wires":[["7caae20a.277f0c","9b384665.68ce88","1db3b84a.ef7818"]]},{"id":"9b384665.68ce88","type":"function","z":"22b120e9.55fad","name":"Get Humidity","func":"msg.payload=msg.payload.h\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":520,"wires":[["fd777d66.c2683","47833c64.746c64"]]},{"id":"fd777d66.c2683","type":"ui_chart","z":"22b120e9.55fad","name":"","group":"872bede8.ae467","order":1,"width":0,"height":0,"label":"Humidity","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"Humidity DHT11","dot":false,"ymin":"0","ymax":"100","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#04ff04","#00fff3","#000000","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":580,"y":520,"wires":[[]]},{"id":"8b298ddb.41e1f","type":"ui_gauge","z":"22b120e9.55fad","name":"","group":"d92be970.5553b8","order":2,"width":0,"height":0,"gtype":"gage","title":"Temperatur","label":"units","format":"{{value}}","min":"-30","max":"40","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":590,"y":460,"wires":[]},{"id":"47833c64.746c64","type":"ui_gauge","z":"22b120e9.55fad","name":"","group":"d92be970.5553b8","order":2,"width":0,"height":0,"gtype":"gage","title":"Humidity","label":"units","format":"{{value}}","min":0,"max":"100","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":580,"y":560,"wires":[]},{"id":"4231fd1d.f423c4","type":"ui_chart","z":"22b120e9.55fad","name":"","group":"a5d67bf8.06ca38","order":1,"width":0,"height":0,"label":"Outdoor Temperature in C","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"Outdoor Temperature in C","dot":false,"ymin":"-20","ymax":"30","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#04ff04","#00fff3","#000000","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":650,"y":640,"wires":[[]]},{"id":"7a84ccfe.f199c4","type":"function","z":"22b120e9.55fad","name":"Get O Temperature","func":"msg.payload=msg.payload.ot.toFixed(2)\nreturn msg;","outputs":1,"noerr":0,"x":390,"y":640,"wires":[["4231fd1d.f423c4","8fa72ce1.9e991"]]},{"id":"1db3b84a.ef7818","type":"function","z":"22b120e9.55fad","name":"PassThru","func":"\nreturn msg;","outputs":1,"noerr":0,"x":180,"y":640,"wires":[["7a84ccfe.f199c4","303f20ae.e08fe"]]},{"id":"303f20ae.e08fe","type":"function","z":"22b120e9.55fad","name":"Get Moisture","func":"msg.payload=msg.payload.w\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":740,"wires":[["cf0f53c5.38ac8","bfe953fe.c23"]]},{"id":"cf0f53c5.38ac8","type":"ui_chart","z":"22b120e9.55fad","name":"","group":"872bede8.ae467","order":1,"width":0,"height":0,"label":"Soil Moisture 1=None","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"Humidity DHT11","dot":false,"ymin":"-0.5","ymax":"1.5","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#04ff04","#00fff3","#000000","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":640,"y":740,"wires":[[]]},{"id":"8fa72ce1.9e991","type":"ui_gauge","z":"22b120e9.55fad","name":"","group":"a5d67bf8.06ca38","order":2,"width":0,"height":0,"gtype":"gage","title":"Outdoor Temperatur","label":"units","format":"{{value}}","min":"-30","max":"40","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":640,"y":680,"wires":[]},{"id":"bfe953fe.c23","type":"ui_gauge","z":"22b120e9.55fad","name":"Moisture","group":"d92be970.5553b8","order":2,"width":0,"height":0,"gtype":"gage","title":"Moisture 1=Dry","label":"units","format":"{{value}}","min":"-1","max":"1","colors":["#00b500","#999a33","#ca3838"],"seg1":"OK","seg2":"Needed","x":600,"y":780,"wires":[]},{"id":"2eece43e.16196c","type":"switch","z":"22b120e9.55fad","name":"","property":"deviceId","propertyType":"msg","rules":[{"t":"eq","v":"playbulb30","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":230,"y":280,"wires":[["cbcefe3.d3d1b","d510f3ef.22035","8b3c07e9.19ad88"]]},{"id":"d1aa29aa.167f88","type":"debug","z":"22b120e9.55fad","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":570,"y":240,"wires":[]},{"id":"b0e61d5a.5a8e7","type":"ui_gauge","z":"22b120e9.55fad","name":"","group":"e6170bf6.938f38","order":0,"width":0,"height":0,"gtype":"gage","title":"DeviceID","label":"ID","format":"{{msg.payload.id}}","min":0,"max":"20","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":580,"y":360,"wires":[]},{"id":"8b3c07e9.19ad88","type":"function","z":"22b120e9.55fad","name":"PassThru","func":"\nreturn msg;","outputs":1,"noerr":0,"x":420,"y":360,"wires":[["b0e61d5a.5a8e7"]]},{"id":"b6be7bff.e55fa8","type":"inject","z":"22b120e9.55fad","name":"pi test data payload","topic":"test message","payload":"{\"value\":\"hello\",\"type\":\"dev\",\"msgid\":0,\"data\":{\"rxpk\":[{\"data\":\"QIoaASYAYAABTqf1tMolR+Q=\",\"time\":\"2019-10-16T02:43:52.558399Z\",\"chan\":0,\"tmst\":110465012,\"stat\":1,\"modu\":\"LORA\",\"lsnr\":1,\"rssi\":-113,\"rfch\":0,\"codr\":\"4/5\",\"freq\":903.9,\"datr\":\"SF7BW125\",\"size\":17}]}}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":150,"y":880,"wires":[["e5c37f71.af217","d7692d87.bc0fd"]]},{"id":"e5c37f71.af217","type":"debug","z":"22b120e9.55fad","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":330,"y":880,"wires":[]},{"id":"d7692d87.bc0fd","type":"function","z":"22b120e9.55fad","name":"decode","func":"// TinyLoRa - Raspberry Pi CPU Load Decoder\n\n\n\nfunction Decoder(bytes, port) {\n  var decoded = {};\n\n  // Decode bytes to int\n  var CPU_Load = (bytes[0] << 8) | bytes[1];\n  var oTemperature = (bytes[2] << 8) | bytes[1];\n  // Decode int to float\n  decoded.CPU_Load = CPU_Load / 100;\n  decoded.oTemperature = oTemperature / 100;\n  return decoded;\n}\n\nvar myBuffer = [];\nvar str = msg.payload.data.rxpk[0].data\nstr =\"00320932\"\nvar buffer = new Buffer(str, 'utf16le');\n\nfor (var i = 0; i < buffer.length; i++) {\n    myBuffer.push(buffer[i]);\n}\n//fromHexString(\"00320932\")\n//51496f61415359415941414254716631744d6f6c52\n//00320932\nmsg.payload=Decoder(fromHexString(\"00320932\"), 0) \nreturn msg;","outputs":1,"noerr":0,"x":320,"y":920,"wires":[["de105edd.547e8"]]},{"id":"de105edd.547e8","type":"debug","z":"22b120e9.55fad","name":"result","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":470,"y":920,"wires":[]},{"id":"303b5d86.aae9e2","type":"lora-packet-converter","z":"22b120e9.55fad","name":"","nsw":"27E87B6710ACC5FB9098F19AE77DC62B","asw":"B887FD00569BE0746E8020746EFC9BA8","x":580,"y":1360,"wires":[["630a72b0.3ec59c","bf17364f.0a3078"]]},{"id":"630a72b0.3ec59c","type":"debug","z":"22b120e9.55fad","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":690,"y":1420,"wires":[]},{"id":"c8047097.aea38","type":"function","z":"22b120e9.55fad","name":"","func":"devid=\"01234567890\"\nmsg.oldpayload=msg.payload\n//       //QIoaASYAYAABTqf1tMolR+Q=      \n//in hex 51496f61415359415941414254716631744d6f6c52\n//msg.payload.data.rxpk[0].data=Buffer.from(\"QIoaASYAYAABTqf1tMolR+Q=\")\nmvk={\"rxpk\":[{\"data\":\"QIoaASYAYAABTqf1tMolR+Q=\",\"time\":\"2019-10-16T02:43:52.558399Z\",\"chan\":0,\"tmst\":110465012,\"stat\":1,\"modu\":\"LORA\",\"lsnr\":1,\"rssi\":-113,\"rfch\":0,\"codr\":\"4/5\",\"freq\":903.9,\"datr\":\"SF7BW125\",\"size\":17}]}\nmsg={}\nmsg.payload=new Buffer(\"12345678901 \"+JSON.stringify(mvk))\n\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":1360,"wires":[["303b5d86.aae9e2"]]},{"id":"5846c51b.7f1f84","type":"inject","z":"22b120e9.55fad","name":"pi test data payload","topic":"test message","payload":"{\"value\":\"hello\",\"type\":\"dev\",\"msgid\":0,\"data\":{\"rxpk\":[{\"data\":\"51496f61415359415941414254716631744d6f6c52\",\"time\":\"2019-10-16T02:43:52.558399Z\",\"chan\":0,\"tmst\":110465012,\"stat\":1,\"modu\":\"LORA\",\"lsnr\":1,\"rssi\":-113,\"rfch\":0,\"codr\":\"4/5\",\"freq\":903.9,\"datr\":\"SF7BW125\",\"size\":17}]}}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":150,"y":1360,"wires":[["c8047097.aea38"]]},{"id":"a2f81cf6.7303c","type":"function","z":"22b120e9.55fad","name":"","func":"mvk=\"0123456789\"+JSON.stringify(msg.payload.data)\nvar bufferDevice = new Buffer(mvk.slice( 0, 11)).toString('hex');\nnode.warn(bufferDevice)\nvar bufferDevice = new Buffer(mvk.slice( 0, 11))\nnode.warn(bufferDevice)\nvar data = new Buffer(mvk.slice( 10, mvk.length)).toString('utf8');\nnode.warn(data)\n//   var bufferPayload = Buffer.from(splice(msg.payload, 0, 12)).toString('utf8');\nvar json = JSON.parse(data);\n\nmsg.payload=json\n\nreturn msg;","outputs":1,"noerr":0,"x":250,"y":1480,"wires":[["887821a0.15026"]]},{"id":"654371ba.e37608","type":"inject","z":"22b120e9.55fad","name":"pi test data payload","topic":"test message","payload":"{\"value\":\"hello\",\"type\":\"dev\",\"msgid\":0,\"data\":{\"rxpk\":[{\"data\":\"QIoaASYAYAABTqf1tMolR+Q=\",\"time\":\"2019-10-16T02:43:52.558399Z\",\"chan\":0,\"tmst\":110465012,\"stat\":1,\"modu\":\"LORA\",\"lsnr\":1,\"rssi\":-113,\"rfch\":0,\"codr\":\"4/5\",\"freq\":903.9,\"datr\":\"SF7BW125\",\"size\":17}]}}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":150,"y":1440,"wires":[["a2f81cf6.7303c"]]},{"id":"887821a0.15026","type":"debug","z":"22b120e9.55fad","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":530,"y":1480,"wires":[]},{"id":"bf17364f.0a3078","type":"function","z":"22b120e9.55fad","name":"data to hex","func":"devid=\"01234567890\"\n\nfunction buf2hex(buffer) { // buffer is an ArrayBuffer\n  return Array.prototype.map.call(new Uint8Array(buffer), x => ('00' + x.toString(16)).slice(-2)).join('');\n}\n\nfunction test(buffer){\n    var hex, i;\n\n    var result = \"\";\n    for (i=0; i<this.length; i++) {\n        hex = buffer.charCodeAt(i).toString(16);\n        result += (\"000\"+hex).slice(-4);\n    }\n\n    return result\n}\nma = new ArrayBuffer(4)\nnode.warn(msg.payload.rxpk[0].data.length);\n//node.warn(buf2hex(msg.payload.rxpk[0].data));\n//node.warn(parseInt(msg.payload.rxpk[0].data,2));\n//node.warn(msg.payload.rxpk[0].data.toString('hex'));/\n//node.warn(msg.payload.rxpk[0].data.toString().toString('hex'));\n//node.warn(msg.payload.rxpk[0].data.toString(2));// 'utf8' i\n//node.warn(msg.payload.rxpk[0].data.toString('binary'));\n//node.warn(msg.payload.rxpk[0].data & 0x01)\n//node.warn(String.fromCharCode(msg.payload.rxpk[0].data))\n\nbytes=msg.payload.rxpk[0].data\nnode.warn(Buffer.from(bytes, 'utf-8')) ///yeah\n//node.warn(Buffer.from(bytes, 'hex'))\nnewbytes=Buffer.from(bytes, 'utf-8')\n\n var CPU_Load = (newbytes[0] << 8) | newbytes[1];\n var oTemperature = (newbytes[2] << 8) | newbytes[1];\n   \n   \n msg.payload.CPU_Load = CPU_Load / 100;\n msg.payload.oTemperature = oTemperature / 100;\n  \nreturn msg;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"x":850,"y":1360,"wires":[["630a72b0.3ec59c"]]},{"id":"6bd449e0.1a7a38","type":"catch","z":"22b120e9.55fad","name":"","scope":["7a84ccfe.f199c4"],"uncaught":false,"x":810,"y":860,"wires":[["74c336e4.4da108"]]},{"id":"74c336e4.4da108","type":"debug","z":"22b120e9.55fad","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":840,"y":920,"wires":[]},{"id":"38ac183c.4b6398","type":"lora-packet-converter","z":"2dec3743.9f7fd8","name":"Network 2 App Key","nsw":"27E87B6710ACC5FB9098F19AE77DC62B","asw":"B887FD00569BE0746E8020746EFC9BA8","x":170,"y":240,"wires":[["bd74e702.470948","741088ec.e35b68"]]},{"id":"bd74e702.470948","type":"debug","z":"2dec3743.9f7fd8","name":"Decrypted","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":230,"y":300,"wires":[]},{"id":"3adca77e.cd5858","type":"function","z":"2dec3743.9f7fd8","name":"Add DeviceID","func":"devid=\"12345678901 \"\n\n// the lora lora-packet-converter package expect device id (12) as a string before the Lora wan Packet\nmvk=msg.payload.data // from the injection \nnode.warn(mvk)\n//test={\"rxpk\":[{\"data\":\"QIoaASYAYAABTqf1tMolR+Q=\",\"time\":\"2019-10-16T02:43:52.558399Z\",\"chan\":0,\"tmst\":110465012,\"stat\":1,\"modu\":\"LORA\",\"lsnr\":1,\"rssi\":-113,\"rfch\":0,\"codr\":\"4/5\",\"freq\":903.9,\"datr\":\"SF7BW125\",\"size\":17}]}\n//msg={}\nmsg.payload=new Buffer(\"12345678901 \"+JSON.stringify(mvk))\n\nreturn msg;","outputs":1,"noerr":0,"x":140,"y":160,"wires":[["38ac183c.4b6398","2dce78af.a8a6c8"]]},{"id":"38e79b7f.664a14","type":"inject","z":"2dec3743.9f7fd8","name":"LoraWAN message form pi  with CPU load","topic":"test message","payload":"{\"value\":\"hello\",\"type\":\"dev\",\"msgid\":0,\"data\":{\"rxpk\":[{\"data\":\"QIoaASYAYAABTqf1tMolR+Q=\",\"time\":\"2019-10-16T02:43:52.558399Z\",\"chan\":0,\"tmst\":110465012,\"stat\":1,\"modu\":\"LORA\",\"lsnr\":1,\"rssi\":-113,\"rfch\":0,\"codr\":\"4/5\",\"freq\":903.9,\"datr\":\"SF7BW125\",\"size\":17}]}}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":220,"y":100,"wires":[["3adca77e.cd5858"]]},{"id":"741088ec.e35b68","type":"function","z":"2dec3743.9f7fd8","name":"Sensor data to hex/decode","func":"\nbytes=msg.payload.rxpk[0].data // sensor/LoraWAN data playload\n\nnewbytes=Buffer.from(bytes, 'utf-8')\nnode.warn(newbytes) ///yeah\n\n//decode ...payload\n//https://learn.adafruit.com/using-lorawan-and-the-things-network-with-circuitpython?view=all\n\nCPU_Load = (newbytes[0] << 8) | newbytes[1];\noTemperature = (newbytes[2] << 8) | newbytes[1];\n   \nmsg.payload.CPU_Load = CPU_Load / 100;\nmsg.payload.oTemperature = oTemperature / 100;\n  \nreturn msg;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"x":560,"y":240,"wires":[["b99d50ef.24e7a"]]},{"id":"e286d41.a330828","type":"comment","z":"2dec3743.9f7fd8","name":"Example of Decryptin and decoding LoraWAN message","info":"Note:\nI use the APP & network key form TheThinkNetwork\n\nmy Hardware was a pycom LoPY as Single Channel Gateway\nand a Lora PI Bonnet using python\nhttps://learn.adafruit.com/using-lorawan-and-the-things-network-with-circuitpython?view=all\n\nI want to send the Lora Message directly via mqtt to node-red and process\nthem there with out the need of a loraWAN server\n\n\nhere a good link for testing\nhttps://lorawan-packet-decoder-0ta6puiniaut.runkit.sh\nhere more infos\nhttps://github.com/anthonykirby/lora-packet/blob/master/demo/demo1.js\nmore infos\nhttps://forum.pycom.io/topic/3958/how-decrypt-lora-data/3\nhttps://codebeautify.org/string-hex-converter","x":240,"y":40,"wires":[]},{"id":"b99d50ef.24e7a","type":"debug","z":"2dec3743.9f7fd8","name":"Sensor Data Decoded","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":640,"y":300,"wires":[]},{"id":"2dce78af.a8a6c8","type":"debug","z":"2dec3743.9f7fd8","name":"InComing LoraWAN","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":400,"y":160,"wires":[]},{"id":"3ef6bc97.be2304","type":"ibmiot in","z":"22b120e9.55fad","authentication":"boundService","apiKey":"95266688.b052e8","inputType":"evt","logicalInterface":"","ruleId":"","deviceId":"playbulb30","applicationId":"","deviceType":"+","eventType":"+","commandType":"","format":"json","name":"Lora","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allLogicalInterfaces":false,"allEvents":true,"allCommands":"","allFormats":true,"qos":0,"x":90,"y":1020,"wires":[[]]},{"id":"3b352e97.77de02","type":"lora-packet-converter","z":"22b120e9.55fad","name":"","nsw":"27E87B6710ACC5FB9098F19AE77DC62B","asw":"B887FD00569BE0746E8020746EFC9BA8","x":440,"y":1020,"wires":[[]]},{"id":"f8060b50.7e8708","type":"switch","z":"22b120e9.55fad","name":"","property":"deviceId","propertyType":"msg","rules":[{"t":"eq","v":"playbulb30","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":230,"y":1020,"wires":[[]]},{"id":"85e44716.fa8df8","type":"ibmiot in","z":"2dec3743.9f7fd8","authentication":"boundService","apiKey":"95266688.b052e8","inputType":"evt","logicalInterface":"","ruleId":"","deviceId":"playbulb30","applicationId":"","deviceType":"+","eventType":"+","commandType":"","format":"json","name":"LoraWAN","service":"registered","allDevices":false,"allApplications":"","allDeviceTypes":true,"allLogicalInterfaces":false,"allEvents":true,"allCommands":"","allFormats":true,"qos":0,"x":100,"y":500,"wires":[["c0f9f950.043e38"]]},{"id":"c0f9f950.043e38","type":"switch","z":"2dec3743.9f7fd8","name":"","property":"deviceId","propertyType":"msg","rules":[{"t":"eq","v":"playbulb30","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":230,"y":500,"wires":[["45a0b354.d48a6c","f38c288f.f489a8"]]},{"id":"f1d8cb1e.3d48b8","type":"function","z":"2dec3743.9f7fd8","name":"Add DeviceID","func":"devid=\"12345678901 \"\n\n// the lora lora-packet-converter package expect device id (12) as a string before the Lora wan Packet\nmvk=msg.payload.data // from the injection \n//node.warn(mvk)\n//test={\"rxpk\":[{\"data\":\"QIoaASYAYAABTqf1tMolR+Q=\",\"time\":\"2019-10-16T02:43:52.558399Z\",\"chan\":0,\"tmst\":110465012,\"stat\":1,\"modu\":\"LORA\",\"lsnr\":1,\"rssi\":-113,\"rfch\":0,\"codr\":\"4/5\",\"freq\":903.9,\"datr\":\"SF7BW125\",\"size\":17}]}\n//msg={}\nmsg.payload=new Buffer(\"12345678901 \"+JSON.stringify(mvk))\n\nreturn msg;","outputs":1,"noerr":0,"x":440,"y":560,"wires":[["37c4ddce.3b3712"]]},{"id":"45a0b354.d48a6c","type":"switch","z":"2dec3743.9f7fd8","name":"","property":"deviceId","propertyType":"msg","rules":[{"t":"eq","v":"playbulb30","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":230,"y":560,"wires":[["f1d8cb1e.3d48b8"]]},{"id":"f38c288f.f489a8","type":"debug","z":"2dec3743.9f7fd8","name":"Incoming","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":420,"y":500,"wires":[]},{"id":"37c4ddce.3b3712","type":"lora-packet-converter","z":"2dec3743.9f7fd8","name":"Network 2 App Key","nsw":"27E87B6710ACC5FB9098F19AE77DC62B","asw":"B887FD00569BE0746E8020746EFC9BA8","x":430,"y":620,"wires":[["aba51817.0a9868","5ea23b86.28be44"]]},{"id":"aba51817.0a9868","type":"debug","z":"2dec3743.9f7fd8","name":"Decrypted","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":450,"y":680,"wires":[]},{"id":"5ea23b86.28be44","type":"function","z":"2dec3743.9f7fd8","name":"Sensor data to hex/decode","func":"\nbytes=msg.payload.rxpk[0].data // sensor/LoraWAN data playload\n\nnewbytes=Buffer.from(bytes, 'utf-8')\nnode.warn(newbytes) ///yeah\n\n//decode ...payload\n//https://learn.adafruit.com/using-lorawan-and-the-things-network-with-circuitpython?view=all\n\nCPU_Load = (newbytes[0] << 8) | newbytes[1];\noTemperature = (newbytes[2] << 8) | newbytes[1];\n   \nmsg.payload.CPU_Load = CPU_Load / 100;\nmsg.payload.oTemperature = oTemperature / 100;\n  \nreturn msg;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"x":720,"y":620,"wires":[["69eb313a.6ee54"]]},{"id":"69eb313a.6ee54","type":"debug","z":"2dec3743.9f7fd8","name":"Sensor Data Decoded","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":740,"y":680,"wires":[]}]
